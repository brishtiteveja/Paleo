!function e(t,n,i){function s(o,a){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(r)return r(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){var n=t[o][1][e];return s(n?n:e)},u,u.exports,e,t,n,i)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(e,t,n){"use strict";function i(){if(c.length)throw c.shift()}function s(e){var t;t=a.length?a.pop():new r,t.task=e,o(t)}function r(){this.task=null}var o=e("./raw"),a=[],c=[],l=o.makeRequestCallFromTimer(i);t.exports=s,r.prototype.call=function(){try{this.task.call()}catch(e){s.onerror?s.onerror(e):(c.push(e),l())}finally{this.task=null,a[a.length]=this}}},{"./raw":2}],2:[function(e,t,n){(function(e){"use strict";function n(e){a.length||(o(),c=!0),a[a.length]=e}function i(){for(;l<a.length;){var e=l;if(l+=1,a[e].call(),l>u){for(var t=0,n=a.length-l;t<n;t++)a[t]=a[t+l];a.length-=l,l=0}}a.length=0,l=0,c=!1}function s(e){var t=1,n=new h(e),i=document.createTextNode("");return n.observe(i,{characterData:!0}),function(){t=-t,i.data=t}}function r(e){return function(){function t(){clearTimeout(n),clearInterval(i),e()}var n=setTimeout(t,0),i=setInterval(t,50)}}t.exports=n;var o,a=[],c=!1,l=0,u=1024,d="undefined"!=typeof e?e:self,h=d.MutationObserver||d.WebKitMutationObserver;o="function"==typeof h?s(i):r(i),n.requestFlush=o,n.makeRequestCallFromTimer=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,n){"use strict";function i(e,t,n){var i,s=e instanceof Error?e:new Error(e);if("object"==typeof t?n=t:null!=t&&(s.code=t),n)for(i in n)s[i]=n[i];return s}t.exports=i},{}],4:[function(e,t,n){"use strict";var i=e("./util/constants"),s=e("./mixins/logging"),r={VERSION:i.VERSION,Client:e("./protocol/client"),Scheduler:e("./protocol/scheduler")};s.wrapper=r,t.exports=r},{"./mixins/logging":6,"./protocol/client":10,"./protocol/scheduler":16,"./util/constants":28}],5:[function(e,t,n){(function(n){"use strict";var i=e("../util/promise");t.exports={then:function(e,t){var n=this;return this._promise||(this._promise=new i(function(e,t){n._resolve=e,n._reject=t})),0===arguments.length?this._promise:this._promise.then(e,t)},callback:function(e,t){return this.then(function(n){e.call(t,n)})},errback:function(e,t){return this.then(null,function(n){e.call(t,n)})},timeout:function(e,t){this.then();var i=this;this._timer=n.setTimeout(function(){i._reject(t)},1e3*e)},setDeferredStatus:function(e,t){this._timer&&n.clearTimeout(this._timer),this.then(),"succeeded"===e?this._resolve(t):"failed"===e?this._reject(t):delete this._promise}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util/promise":33}],6:[function(e,t,n){"use strict";var i=e("../util/to_json"),s={LOG_LEVELS:{fatal:4,error:3,warn:2,info:1,debug:0},writeLog:function(e,t){var n=s.logger||(s.wrapper||s).logger;if(n){var r=Array.prototype.slice.apply(e),o="[Faye",a=this.className,c=r.shift().replace(/\?/g,function(){try{return i(r.shift())}catch(e){return"[Object]"}});a&&(o+="."+a),o+="] ","function"==typeof n[t]?n[t](o+c):"function"==typeof n&&n(o+c)}}};for(var r in s.LOG_LEVELS)(function(e){s[e]=function(){this.writeLog(arguments,e)}})(r);t.exports=s},{"../util/to_json":35}],7:[function(e,t,n){"use strict";var i=e("../util/extend"),s=e("../util/event_emitter"),r={countListeners:function(e){return this.listeners(e).length},bind:function(e,t,n){var i=Array.prototype.slice,s=function(){t.apply(n,i.call(arguments))};return this._listeners=this._listeners||[],this._listeners.push([e,t,n,s]),this.on(e,s)},unbind:function(e,t,n){this._listeners=this._listeners||[];for(var i,s=this._listeners.length;s--;)i=this._listeners[s],i[0]===e&&(!t||i[1]===t&&i[2]===n)&&(this._listeners.splice(s,1),this.removeListener(e,i[3]))}};i(r,s.prototype),r.trigger=r.emit,t.exports=r},{"../util/event_emitter":31,"../util/extend":32}],8:[function(e,t,n){(function(e){"use strict";t.exports={addTimeout:function(t,n,i,s){if(this._timeouts=this._timeouts||{},!this._timeouts.hasOwnProperty(t)){var r=this;this._timeouts[t]=e.setTimeout(function(){delete r._timeouts[t],i.call(s)},1e3*n)}},removeTimeout:function(t){this._timeouts=this._timeouts||{};var n=this._timeouts[t];n&&(e.clearTimeout(n),delete this._timeouts[t])},removeAllTimeouts:function(){this._timeouts=this._timeouts||{};for(var e in this._timeouts)this.removeTimeout(e)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,t,n){"use strict";var i=e("../util/class"),s=e("../util/extend"),r=e("../mixins/publisher"),o=e("./grammar"),a=i({initialize:function(e){this.id=this.name=e},push:function(e){this.trigger("message",e)},isUnused:function(){return 0===this.countListeners("message")}});s(a.prototype,r),s(a,{HANDSHAKE:"/meta/handshake",CONNECT:"/meta/connect",SUBSCRIBE:"/meta/subscribe",UNSUBSCRIBE:"/meta/unsubscribe",DISCONNECT:"/meta/disconnect",META:"meta",SERVICE:"service",expand:function(e){var t=this.parse(e),n=["/**",e],i=t.slice();i[i.length-1]="*",n.push(this.unparse(i));for(var s=1,r=t.length;s<r;s++)i=t.slice(0,s),i.push("**"),n.push(this.unparse(i));return n},isValid:function(e){return o.CHANNEL_NAME.test(e)||o.CHANNEL_PATTERN.test(e)},parse:function(e){return this.isValid(e)?e.split("/").slice(1):null},unparse:function(e){return"/"+e.join("/")},isMeta:function(e){var t=this.parse(e);return t?t[0]===this.META:null},isService:function(e){var t=this.parse(e);return t?t[0]===this.SERVICE:null},isSubscribable:function(e){return this.isValid(e)?!this.isMeta(e)&&!this.isService(e):null},Set:i({initialize:function(){this._channels={}},getKeys:function(){var e=[];for(var t in this._channels)e.push(t);return e},remove:function(e){delete this._channels[e]},hasSubscription:function(e){return this._channels.hasOwnProperty(e)},subscribe:function(e,t){for(var n,i=0,s=e.length;i<s;i++){n=e[i];var r=this._channels[n]=this._channels[n]||new a(n);r.bind("message",t)}},unsubscribe:function(e,t){var n=this._channels[e];return!!n&&(n.unbind("message",t),!!n.isUnused()&&(this.remove(e),!0))},distributeMessage:function(e){for(var t=a.expand(e.channel),n=0,i=t.length;n<i;n++){var s=this._channels[t[n]];s&&s.trigger("message",e)}}})}),t.exports=a},{"../mixins/publisher":7,"../util/class":27,"../util/extend":32,"./grammar":14}],10:[function(e,t,n){(function(n){"use strict";var i=e("asap"),s=e("../util/class"),r=(e("../util/promise"),e("../util/uri")),o=e("../util/array"),a=e("../util/browser"),c=e("../util/constants"),l=e("../util/extend"),u=e("../util/validate_options"),d=e("../mixins/deferrable"),h=e("../mixins/logging"),p=e("../mixins/publisher"),f=e("./channel"),m=e("./dispatcher"),g=e("./error"),v=e("./extensible"),w=e("./publication"),_=e("./subscription"),b=s({className:"Client",UNCONNECTED:1,CONNECTING:2,CONNECTED:3,DISCONNECTED:4,HANDSHAKE:"handshake",RETRY:"retry",NONE:"none",CONNECTION_TIMEOUT:60,DEFAULT_ENDPOINT:"/bayeux",INTERVAL:0,initialize:function(e,t){this.info("New client created for ?",e),t=t||{},u(t,["interval","timeout","endpoints","proxy","retry","scheduler","websocketExtensions","tls","ca"]),this._channels=new f.Set,this._dispatcher=m.create(this,e||this.DEFAULT_ENDPOINT,t),this._messageId=0,this._state=this.UNCONNECTED,this._responseCallbacks={},this._advice={reconnect:this.RETRY,interval:1e3*(t.interval||this.INTERVAL),timeout:1e3*(t.timeout||this.CONNECTION_TIMEOUT)},this._dispatcher.timeout=this._advice.timeout/1e3,this._dispatcher.bind("message",this._receiveMessage,this),a.Event&&void 0!==n.onbeforeunload&&a.Event.on(n,"beforeunload",function(){o.indexOf(this._dispatcher._disabled,"autodisconnect")<0&&this.disconnect()},this)},addWebsocketExtension:function(e){return this._dispatcher.addWebsocketExtension(e)},disable:function(e){return this._dispatcher.disable(e)},setHeader:function(e,t){return this._dispatcher.setHeader(e,t)},handshake:function(e,t){if(this._advice.reconnect!==this.NONE&&this._state===this.UNCONNECTED){this._state=this.CONNECTING;var s=this;this.info("Initiating handshake with ?",r.stringify(this._dispatcher.endpoint)),this._dispatcher.selectTransport(c.MANDATORY_CONNECTION_TYPES),this._sendMessage({channel:f.HANDSHAKE,version:c.BAYEUX_VERSION,supportedConnectionTypes:this._dispatcher.getConnectionTypes()},{},function(r){r.successful?(this._state=this.CONNECTED,this._dispatcher.clientId=r.clientId,this._dispatcher.selectTransport(r.supportedConnectionTypes),this.info("Handshake successful: ?",this._dispatcher.clientId),this.subscribe(this._channels.getKeys(),!0),e&&i(function(){e.call(t)})):(this.info("Handshake unsuccessful"),n.setTimeout(function(){s.handshake(e,t)},1e3*this._dispatcher.retry),this._state=this.UNCONNECTED)},this)}},connect:function(e,t){if(this._advice.reconnect!==this.NONE&&this._state!==this.DISCONNECTED){if(this._state===this.UNCONNECTED)return this.handshake(function(){this.connect(e,t)},this);this.callback(e,t),this._state===this.CONNECTED&&(this.info("Calling deferred actions for ?",this._dispatcher.clientId),this.setDeferredStatus("succeeded"),this.setDeferredStatus("unknown"),this._connectRequest||(this._connectRequest=!0,this.info("Initiating connection for ?",this._dispatcher.clientId),this._sendMessage({channel:f.CONNECT,clientId:this._dispatcher.clientId,connectionType:this._dispatcher.connectionType},{},this._cycleConnection,this)))}},disconnect:function(){if(this._state===this.CONNECTED){this._state=this.DISCONNECTED,this.info("Disconnecting ?",this._dispatcher.clientId);var e=new w;return this._sendMessage({channel:f.DISCONNECT,clientId:this._dispatcher.clientId},{},function(t){t.successful?(this._dispatcher.close(),e.setDeferredStatus("succeeded")):e.setDeferredStatus("failed",g.parse(t.error))},this),this.info("Clearing channel listeners for ?",this._dispatcher.clientId),this._channels=new f.Set,e}},subscribe:function(e,t,n){if(e instanceof Array)return o.map(e,function(e){return this.subscribe(e,t,n)},this);var i=new _(this,e,t,n),s=t===!0,r=this._channels.hasSubscription(e);return r&&!s?(this._channels.subscribe([e],i),i.setDeferredStatus("succeeded"),i):(this.connect(function(){this.info("Client ? attempting to subscribe to ?",this._dispatcher.clientId,e),s||this._channels.subscribe([e],i),this._sendMessage({channel:f.SUBSCRIBE,clientId:this._dispatcher.clientId,subscription:e},{},function(t){if(!t.successful)return i.setDeferredStatus("failed",g.parse(t.error)),this._channels.unsubscribe(e,i);var n=[].concat(t.subscription);this.info("Subscription acknowledged for ? to ?",this._dispatcher.clientId,n),i.setDeferredStatus("succeeded")},this)},this),i)},unsubscribe:function(e,t){if(e instanceof Array)return o.map(e,function(e){return this.unsubscribe(e,t)},this);var n=this._channels.unsubscribe(e,t);n&&this.connect(function(){this.info("Client ? attempting to unsubscribe from ?",this._dispatcher.clientId,e),this._sendMessage({channel:f.UNSUBSCRIBE,clientId:this._dispatcher.clientId,subscription:e},{},function(e){if(e.successful){var t=[].concat(e.subscription);this.info("Unsubscription acknowledged for ? from ?",this._dispatcher.clientId,t)}},this)},this)},publish:function(e,t,n){u(n||{},["attempts","deadline"]);var i=new w;return this.connect(function(){this.info("Client ? queueing published message to ?: ?",this._dispatcher.clientId,e,t),this._sendMessage({channel:e,data:t,clientId:this._dispatcher.clientId},n,function(e){e.successful?i.setDeferredStatus("succeeded"):i.setDeferredStatus("failed",g.parse(e.error))},this)},this),i},_sendMessage:function(e,t,n,i){e.id=this._generateMessageId();var s=this._advice.timeout?1.2*this._advice.timeout/1e3:1.2*this._dispatcher.retry;this.pipeThroughExtensions("outgoing",e,null,function(e){e&&(n&&(this._responseCallbacks[e.id]=[n,i]),this._dispatcher.sendMessage(e,s,t||{}))},this)},_generateMessageId:function(){return this._messageId+=1,this._messageId>=Math.pow(2,32)&&(this._messageId=0),this._messageId.toString(36)},_receiveMessage:function(e){var t,n=e.id;void 0!==e.successful&&(t=this._responseCallbacks[n],delete this._responseCallbacks[n]),this.pipeThroughExtensions("incoming",e,null,function(e){e&&(e.advice&&this._handleAdvice(e.advice),this._deliverMessage(e),t&&t[0].call(t[1],e))},this)},_handleAdvice:function(e){l(this._advice,e),this._dispatcher.timeout=this._advice.timeout/1e3,this._advice.reconnect===this.HANDSHAKE&&this._state!==this.DISCONNECTED&&(this._state=this.UNCONNECTED,this._dispatcher.clientId=null,this._cycleConnection())},_deliverMessage:function(e){e.channel&&void 0!==e.data&&(this.info("Client ? calling listeners for ? with ?",this._dispatcher.clientId,e.channel,e.data),this._channels.distributeMessage(e))},_cycleConnection:function(){this._connectRequest&&(this._connectRequest=null,this.info("Closed connection for ?",this._dispatcher.clientId));var e=this;n.setTimeout(function(){e.connect()},this._advice.interval)}});l(b.prototype,d),l(b.prototype,p),l(b.prototype,h),l(b.prototype,v),t.exports=b}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../mixins/deferrable":5,"../mixins/logging":6,"../mixins/publisher":7,"../util/array":25,"../util/browser":26,"../util/class":27,"../util/constants":28,"../util/extend":32,"../util/promise":33,"../util/uri":36,"../util/validate_options":37,"./channel":9,"./dispatcher":11,"./error":12,"./extensible":13,"./publication":15,"./subscription":17,asap:1}],11:[function(e,t,n){(function(n){"use strict";var i=e("../util/class"),s=e("../util/uri"),r=e("../util/cookies"),o=e("../util/extend"),a=e("../mixins/logging"),c=e("../mixins/publisher"),l=e("../transport"),u=e("./scheduler"),d=i({className:"Dispatcher",MAX_REQUEST_SIZE:2048,DEFAULT_RETRY:5,UP:1,DOWN:2,initialize:function(e,t,n){this._client=e,this.endpoint=s.parse(t),this._alternates=n.endpoints||{},this.cookies=r.CookieJar&&new r.CookieJar,this._disabled=[],this._envelopes={},this.headers={},this.retry=n.retry||this.DEFAULT_RETRY,this._scheduler=n.scheduler||u,this._state=0,this.transports={},this.wsExtensions=[],this.proxy=n.proxy||{},"string"==typeof this._proxy&&(this._proxy={origin:this._proxy});var i=n.websocketExtensions;if(i){i=[].concat(i);for(var o=0,a=i.length;o<a;o++)this.addWebsocketExtension(i[o])}this.tls=n.tls||{},this.tls.ca=this.tls.ca||n.ca;for(var c in this._alternates)this._alternates[c]=s.parse(this._alternates[c]);this.maxRequestSize=this.MAX_REQUEST_SIZE},endpointFor:function(e){return this._alternates[e]||this.endpoint},addWebsocketExtension:function(e){this.wsExtensions.push(e)},disable:function(e){this._disabled.push(e)},setHeader:function(e,t){this.headers[e]=t},close:function(){var e=this._transport;delete this._transport,e&&e.close()},getConnectionTypes:function(){return l.getConnectionTypes()},selectTransport:function(e){l.get(this,e,this._disabled,function(e){this.debug("Selected ? transport for ?",e.connectionType,s.stringify(e.endpoint)),e!==this._transport&&(this._transport&&this._transport.close(),this._transport=e,this.connectionType=e.connectionType)},this)},sendMessage:function(e,t,n){n=n||{};var i,s=e.id,r=n.attempts,o=n.deadline&&(new Date).getTime()+1e3*n.deadline,a=this._envelopes[s];a||(i=new this._scheduler(e,{timeout:t,interval:this.retry,attempts:r,deadline:o}),a=this._envelopes[s]={message:e,scheduler:i}),this._sendEnvelope(a)},_sendEnvelope:function(e){if(this._transport&&!e.request&&!e.timer){var t=e.message,i=e.scheduler,s=this;if(!i.isDeliverable())return i.abort(),void delete this._envelopes[t.id];e.timer=n.setTimeout(function(){s.handleError(t)},1e3*i.getTimeout()),i.send(),e.request=this._transport.sendMessage(t)}},handleResponse:function(e){var t=this._envelopes[e.id];void 0!==e.successful&&t&&(t.scheduler.succeed(),delete this._envelopes[e.id],n.clearTimeout(t.timer)),this.trigger("message",e),this._state!==this.UP&&(this._state=this.UP,this._client.trigger("transport:up"))},handleError:function(e,t){var i=this._envelopes[e.id],s=i&&i.request,r=this;if(s){s.then(function(e){e&&e.abort&&e.abort()});var o=i.scheduler;o.fail(),n.clearTimeout(i.timer),i.request=i.timer=null,t?this._sendEnvelope(i):i.timer=n.setTimeout(function(){i.timer=null,r._sendEnvelope(i)},1e3*o.getInterval()),this._state!==this.DOWN&&(this._state=this.DOWN,this._client.trigger("transport:down"))}}});d.create=function(e,t,n){return new d(e,t,n)},o(d.prototype,c),o(d.prototype,a),t.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../mixins/logging":6,"../mixins/publisher":7,"../transport":18,"../util/class":27,"../util/cookies":29,"../util/extend":32,"../util/uri":36,"./scheduler":16}],12:[function(e,t,n){"use strict";var i=e("../util/class"),s=e("./grammar"),r=i({initialize:function(e,t,n){this.code=e,this.params=Array.prototype.slice.call(t),this.message=n},toString:function(){return this.code+":"+this.params.join(",")+":"+this.message}});r.parse=function(e){if(e=e||"",!s.ERROR.test(e))return new r(null,[],e);var t=e.split(":"),n=parseInt(t[0]),i=t[1].split(","),e=t[2];return new r(n,i,e)};var o={versionMismatch:[300,"Version mismatch"],conntypeMismatch:[301,"Connection types not supported"],extMismatch:[302,"Extension mismatch"],badRequest:[400,"Bad request"],clientUnknown:[401,"Unknown client"],parameterMissing:[402,"Missing required parameter"],channelForbidden:[403,"Forbidden channel"],channelUnknown:[404,"Unknown channel"],channelInvalid:[405,"Invalid channel"],extUnknown:[406,"Unknown extension"],publishFailed:[407,"Failed to publish"],serverError:[500,"Internal server error"]};for(var a in o)(function(e){r[e]=function(){return new r(o[e][0],arguments,o[e][1]).toString()}})(a);t.exports=r},{"../util/class":27,"./grammar":14}],13:[function(e,t,n){"use strict";var i=e("../util/extend"),s=e("../mixins/logging"),r={addExtension:function(e){this._extensions=this._extensions||[],this._extensions.push(e),e.added&&e.added(this)},removeExtension:function(e){if(this._extensions)for(var t=this._extensions.length;t--;)this._extensions[t]===e&&(this._extensions.splice(t,1),e.removed&&e.removed(this))},pipeThroughExtensions:function(e,t,n,i,s){if(this.debug("Passing through ? extensions: ?",e,t),!this._extensions)return i.call(s,t);var r=this._extensions.slice(),o=function(t){if(!t)return i.call(s,t);var a=r.shift();if(!a)return i.call(s,t);var c=a[e];return c?void(c.length>=3?a[e](t,n,o):a[e](t,o)):o(t)};o(t)}};i(r,s),t.exports=r},{"../mixins/logging":6,"../util/extend":32}],14:[function(e,t,n){"use strict";t.exports={CHANNEL_NAME:/^\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*$/,CHANNEL_PATTERN:/^(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*\/\*{1,2}$/,ERROR:/^([0-9][0-9][0-9]:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*(,(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)*:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*|[0-9][0-9][0-9]::(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)$/,VERSION:/^([0-9])+(\.(([a-z]|[A-Z])|[0-9])(((([a-z]|[A-Z])|[0-9])|\-|\_))*)*$/}},{}],15:[function(e,t,n){"use strict";var i=e("../util/class"),s=e("../mixins/deferrable");t.exports=i(s)},{"../mixins/deferrable":5,"../util/class":27}],16:[function(e,t,n){"use strict";var i=e("../util/extend"),s=function(e,t){this.message=e,this.options=t,this.attempts=0};i(s.prototype,{getTimeout:function(){return this.options.timeout},getInterval:function(){return this.options.interval},isDeliverable:function(){var e=this.options.attempts,t=this.attempts,n=this.options.deadline,i=(new Date).getTime();return!(void 0!==e&&t>=e)&&!(void 0!==n&&i>n)},send:function(){this.attempts+=1},succeed:function(){},fail:function(){},abort:function(){}}),t.exports=s},{"../util/extend":32}],17:[function(e,t,n){"use strict";var i=e("../util/class"),s=e("../util/extend"),r=e("../mixins/deferrable"),o=i({initialize:function(e,t,n,i){this._client=e,this._channels=t,this._callback=n,this._context=i,this._cancelled=!1},withChannel:function(e,t){return this._withChannel=[e,t],this},apply:function(e,t){var n=t[0];this._callback&&this._callback.call(this._context,n.data),this._withChannel&&this._withChannel[0].call(this._withChannel[1],n.channel,n.data)},cancel:function(){this._cancelled||(this._client.unsubscribe(this._channels,this),this._cancelled=!0)},unsubscribe:function(){this.cancel()}});s(o.prototype,r),t.exports=o},{"../mixins/deferrable":5,"../util/class":27,"../util/extend":32}],18:[function(e,t,n){"use strict";var i=e("./transport");i.register("websocket",e("./web_socket")),i.register("eventsource",e("./event_source")),i.register("long-polling",e("./xhr")),i.register("cross-origin-long-polling",e("./cors")),i.register("callback-polling",e("./jsonp")),t.exports=i},{"./cors":19,"./event_source":20,"./jsonp":21,"./transport":22,"./web_socket":23,"./xhr":24}],19:[function(e,t,n){(function(n){"use strict";var i=e("../util/class"),s=e("../util/set"),r=e("../util/uri"),o=e("../util/extend"),a=e("../util/to_json"),c=e("./transport"),l=o(i(c,{encode:function(e){return"message="+encodeURIComponent(a(e))},request:function(e){var t,i=n.XDomainRequest?XDomainRequest:XMLHttpRequest,s=new i,o=++l._id,a=this._dispatcher.headers,c=this;if(s.open("POST",r.stringify(this.endpoint),!0),s.setRequestHeader){s.setRequestHeader("Pragma","no-cache");for(t in a)a.hasOwnProperty(t)&&s.setRequestHeader(t,a[t])}var u=function(){return!!s&&(l._pending.remove(o),s.onload=s.onerror=s.ontimeout=s.onprogress=null,void(s=null))};return s.onload=function(){var t;try{t=JSON.parse(s.responseText)}catch(e){}u(),t?c._receive(t):c._handleError(e)},s.onerror=s.ontimeout=function(){u(),c._handleError(e)},s.onprogress=function(){},i===n.XDomainRequest&&l._pending.add({id:o,xhr:s}),s.send(this.encode(e)),s}}),{_id:0,_pending:new s,isUsable:function(e,t,i,s){if(r.isSameOrigin(t))return i.call(s,!1);if(n.XDomainRequest)return i.call(s,t.protocol===location.protocol);if(n.XMLHttpRequest){var o=new XMLHttpRequest;return i.call(s,void 0!==o.withCredentials)}return i.call(s,!1)}});t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util/class":27,"../util/extend":32,"../util/set":34,"../util/to_json":35,"../util/uri":36,"./transport":22}],20:[function(e,t,n){(function(n){"use strict";var i=e("../util/class"),s=e("../util/uri"),r=e("../util/copy_object"),o=e("../util/extend"),a=e("../mixins/deferrable"),c=e("./transport"),l=e("./xhr"),u=o(i(c,{initialize:function(e,t){if(c.prototype.initialize.call(this,e,t),!n.EventSource)return this.setDeferredStatus("failed");this._xhr=new l(e,t),t=r(t),t.pathname+="/"+e.clientId;var i=new n.EventSource(s.stringify(t)),o=this;i.onopen=function(){o._everConnected=!0,o.setDeferredStatus("succeeded")},i.onerror=function(){o._everConnected?o._handleError([]):(o.setDeferredStatus("failed"),i.close())},i.onmessage=function(e){var t;try{t=JSON.parse(e.data)}catch(e){}t?o._receive(t):o._handleError([])},this._socket=i},close:function(){this._socket&&(this._socket.onopen=this._socket.onerror=this._socket.onmessage=null,this._socket.close(),delete this._socket)},isUsable:function(e,t){this.callback(function(){e.call(t,!0)}),this.errback(function(){e.call(t,!1)})},encode:function(e){return this._xhr.encode(e)},request:function(e){return this._xhr.request(e)}}),{isUsable:function(e,t,n,i){var s=e.clientId;return s?void l.isUsable(e,t,function(s){return s?void this.create(e,t).isUsable(n,i):n.call(i,!1)},this):n.call(i,!1)},create:function(e,t){var n=e.transports.eventsource=e.transports.eventsource||{},i=e.clientId,o=r(t);return o.pathname+="/"+(i||""),o=s.stringify(o),n[o]=n[o]||new this(e,t),n[o]}});o(u.prototype,a),t.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../mixins/deferrable":5,"../util/class":27,"../util/copy_object":30,"../util/extend":32,"../util/uri":36,"./transport":22,"./xhr":24}],21:[function(e,t,n){(function(n){"use strict";var i=e("../util/class"),s=e("../util/uri"),r=e("../util/copy_object"),o=e("../util/extend"),a=e("../util/to_json"),c=e("./transport"),l=o(i(c,{encode:function(e){var t=r(this.endpoint);return t.query.message=a(e),t.query.jsonp="__jsonp"+l._cbCount+"__",s.stringify(t)},request:function(e){var t=document.getElementsByTagName("head")[0],i=document.createElement("script"),o=l.getCallbackName(),c=r(this.endpoint),u=this;c.query.message=a(e),c.query.jsonp=o;var d=function(){if(!n[o])return!1;n[o]=void 0;try{delete n[o]}catch(e){}i.parentNode.removeChild(i)};return n[o]=function(e){d(),u._receive(e)},i.type="text/javascript",i.src=s.stringify(c),t.appendChild(i),i.onerror=function(){d(),u._handleError(e)},{abort:d}}}),{_cbCount:0,getCallbackName:function(){return this._cbCount+=1,"__jsonp"+this._cbCount+"__"},isUsable:function(e,t,n,i){n.call(i,!0)}});t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util/class":27,"../util/copy_object":30,"../util/extend":32,"../util/to_json":35,"../util/uri":36,"./transport":22}],22:[function(e,t,n){(function(n){"use strict";var i=e("../util/class"),s=e("../util/cookies").Cookie,r=e("../util/promise"),o=e("../util/uri"),a=e("../util/array"),c=e("../util/extend"),l=e("../mixins/logging"),u=e("../mixins/timeouts"),d=e("../protocol/channel"),h=c(i({className:"Transport",DEFAULT_PORTS:{"http:":80,"https:":443,"ws:":80,"wss:":443},MAX_DELAY:0,batching:!0,initialize:function(e,t){this._dispatcher=e,this.endpoint=t,this._outbox=[],this._proxy=c({},this._dispatcher.proxy),this._proxy.origin||(this._proxy.origin=this._findProxy())},close:function(){},encode:function(e){return""},sendMessage:function(e){return this.debug("Client ? sending message to ?: ?",this._dispatcher.clientId,o.stringify(this.endpoint),e),this.batching?(this._outbox.push(e),this._flushLargeBatch(),e.channel===d.HANDSHAKE?this._publish(.01):(e.channel===d.CONNECT&&(this._connectMessage=e),this._publish(this.MAX_DELAY))):r.resolve(this.request([e]))},_makePromise:function(){var e=this;this._requestPromise=this._requestPromise||new r(function(t){e._resolvePromise=t})},_publish:function(e){return this._makePromise(),this.addTimeout("publish",e,function(){this._flush(),delete this._requestPromise},this),this._requestPromise},_flush:function(){this.removeTimeout("publish"),this._outbox.length>1&&this._connectMessage&&(this._connectMessage.advice={timeout:0}),this._resolvePromise(this.request(this._outbox)),this._connectMessage=null,this._outbox=[]},_flushLargeBatch:function(){var e=this.encode(this._outbox);if(!(e.length<this._dispatcher.maxRequestSize)){var t=this._outbox.pop();this._makePromise(),this._flush(),t&&this._outbox.push(t)}},_receive:function(e){if(e){e=[].concat(e),this.debug("Client ? received from ? via ?: ?",this._dispatcher.clientId,o.stringify(this.endpoint),this.connectionType,e);for(var t=0,n=e.length;t<n;t++)this._dispatcher.handleResponse(e[t])}},_handleError:function(e,t){e=[].concat(e),this.debug("Client ? failed to send to ? via ?: ?",this._dispatcher.clientId,o.stringify(this.endpoint),this.connectionType,e);for(var n=0,i=e.length;n<i;n++)this._dispatcher.handleError(e[n])},_getCookies:function(){var e=this._dispatcher.cookies,t=o.stringify(this.endpoint);return e?a.map(e.getCookiesSync(t),function(e){return e.cookieString()}).join("; "):""},_storeCookies:function(e){var t,n=this._dispatcher.cookies,i=o.stringify(this.endpoint);if(e&&n){e=[].concat(e);for(var r=0,a=e.length;r<a;r++)t=s.parse(e[r]),n.setCookieSync(t,i)}},_findProxy:function(){if("undefined"!=typeof n){var e=this.endpoint.protocol;if(e){var t,i,s=e.replace(/:$/,"").toLowerCase()+"_proxy",r=s.toUpperCase(),o=n.env;return"http_proxy"===s&&o.REQUEST_METHOD?(t=Object.keys(o).filter(function(e){return/^http_proxy$/i.test(e)}),1===t.length?t[0]===s&&void 0===o[r]&&(i=o[s]):t.length>1&&(i=o[s]),i=i||o["CGI_"+r]):(i=o[s]||o[r],i&&!o[s]&&console.warn("The environment variable "+r+" is discouraged. Use "+s+".")),i}}}}),{get:function(e,t,n,i,s){var r=e.endpoint;a.asyncEach(this._transports,function(r,o){var c=r[0],l=r[1],u=e.endpointFor(c);return a.indexOf(n,c)>=0?o():a.indexOf(t,c)<0?(l.isUsable(e,u,function(){}),o()):void l.isUsable(e,u,function(t){if(!t)return o();var n=l.hasOwnProperty("create")?l.create(e,u):new l(e,u);i.call(s,n)})},function(){throw new Error("Could not find a usable connection type for "+o.stringify(r))})},register:function(e,t){this._transports.push([e,t]),t.prototype.connectionType=e},getConnectionTypes:function(){return a.map(this._transports,function(e){return e[0]})},_transports:[]});c(h.prototype,l),c(h.prototype,u),t.exports=h}).call(this,e("_process"))},{"../mixins/logging":6,"../mixins/timeouts":8,"../protocol/channel":9,"../util/array":25,"../util/class":27,"../util/cookies":29,"../util/extend":32,"../util/promise":33,"../util/uri":36,_process:39}],23:[function(e,t,n){(function(n){"use strict";var i=e("../util/class"),s=e("../util/promise"),r=e("../util/set"),o=e("../util/uri"),a=e("../util/browser"),c=e("../util/copy_object"),l=e("../util/extend"),u=e("../util/to_json"),d=e("../util/websocket"),h=e("../mixins/deferrable"),p=e("./transport"),f=l(i(p,{UNCONNECTED:1,CONNECTING:2,CONNECTED:3,batching:!1,isUsable:function(e,t){this.callback(function(){e.call(t,!0)}),this.errback(function(){e.call(t,!1)}),this.connect()},request:function(e){this._pending=this._pending||new r;for(var t=0,n=e.length;t<n;t++)this._pending.add(e[t]);var i=this,o=new s(function(t,n){i.callback(function(n){n&&1===n.readyState&&(n.send(u(e)),t(n))}),i.connect()});return{abort:function(){o.then(function(e){e.close()})}}},connect:function(){if(!f._unloaded&&(this._state=this._state||this.UNCONNECTED,this._state===this.UNCONNECTED)){this._state=this.CONNECTING;var e=this._createSocket();if(!e)return this.setDeferredStatus("failed");var t=this;e.onopen=function(){e.headers&&t._storeCookies(e.headers["set-cookie"]),t._socket=e,t._state=t.CONNECTED,t._everConnected=!0,t._ping(),t.setDeferredStatus("succeeded",e)};var n=!1;e.onclose=e.onerror=function(){if(!n){n=!0;var i=t._state===t.CONNECTED;e.onopen=e.onclose=e.onerror=e.onmessage=null,delete t._socket,t._state=t.UNCONNECTED,t.removeTimeout("ping");var s=t._pending?t._pending.toArray():[];delete t._pending,i||t._everConnected?(t.setDeferredStatus("unknown"),t._handleError(s,i)):t.setDeferredStatus("failed")}},e.onmessage=function(e){var n;try{n=JSON.parse(e.data)}catch(e){}if(n){n=[].concat(n);for(var i=0,s=n.length;i<s;i++)void 0!==n[i].successful&&t._pending.remove(n[i]);t._receive(n)}}}},close:function(){this._socket&&this._socket.close()},_createSocket:function(){var e=f.getSocketUrl(this.endpoint),t=this._dispatcher.headers,n=this._dispatcher.wsExtensions,i=this._getCookies(),s=this._dispatcher.tls,r={extensions:n,headers:t,proxy:this._proxy,tls:s};return""!==i&&(r.headers.Cookie=i),d.create(e,[],r)},_ping:function(){this._socket&&1===this._socket.readyState&&(this._socket.send("[]"),this.addTimeout("ping",this._dispatcher.timeout/2,this._ping,this))}}),{PROTOCOLS:{"http:":"ws:","https:":"wss:"},create:function(e,t){var n=e.transports.websocket=e.transports.websocket||{};return n[t.href]=n[t.href]||new this(e,t),n[t.href]},getSocketUrl:function(e){return e=c(e),e.protocol=this.PROTOCOLS[e.protocol],o.stringify(e)},isUsable:function(e,t,n,i){this.create(e,t).isUsable(n,i)}});l(f.prototype,h),a.Event&&void 0!==n.onbeforeunload&&a.Event.on(n,"beforeunload",function(){f._unloaded=!0}),t.exports=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});
},{"../mixins/deferrable":5,"../util/browser":26,"../util/class":27,"../util/copy_object":30,"../util/extend":32,"../util/promise":33,"../util/set":34,"../util/to_json":35,"../util/uri":36,"../util/websocket":38,"./transport":22}],24:[function(e,t,n){(function(n){"use strict";var i=e("../util/class"),s=e("../util/uri"),r=e("../util/browser"),o=e("../util/extend"),a=e("../util/to_json"),c=e("./transport"),l=o(i(c,{encode:function(e){return a(e)},request:function(e){var t,i=this.endpoint.href,s=this;if(n.XMLHttpRequest)t=new XMLHttpRequest;else{if(!n.ActiveXObject)return this._handleError(e);t=new ActiveXObject("Microsoft.XMLHTTP")}t.open("POST",i,!0),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("Pragma","no-cache"),t.setRequestHeader("X-Requested-With","XMLHttpRequest");var o=this._dispatcher.headers;for(var a in o)o.hasOwnProperty(a)&&t.setRequestHeader(a,o[a]);var c=function(){t.abort()};return void 0!==n.onbeforeunload&&r.Event.on(n,"beforeunload",c),t.onreadystatechange=function(){if(t&&4===t.readyState){var i=null,o=t.status,a=t.responseText,l=o>=200&&o<300||304===o||1223===o;if(void 0!==n.onbeforeunload&&r.Event.detach(n,"beforeunload",c),t.onreadystatechange=function(){},t=null,!l)return s._handleError(e);try{i=JSON.parse(a)}catch(e){}i?s._receive(i):s._handleError(e)}},t.send(this.encode(e)),t}}),{isUsable:function(e,t,n,i){var r="ReactNative"===navigator.product||s.isSameOrigin(t);n.call(i,r)}});t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util/browser":26,"../util/class":27,"../util/extend":32,"../util/to_json":35,"../util/uri":36,"./transport":22}],25:[function(e,t,n){"use strict";t.exports={commonElement:function(e,t){for(var n=0,i=e.length;n<i;n++)if(this.indexOf(t,e[n])!==-1)return e[n];return null},indexOf:function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},map:function(e,t,n){if(e.map)return e.map(t,n);var i=[];if(e instanceof Array)for(var s=0,r=e.length;s<r;s++)i.push(t.call(n||null,e[s],s));else for(var o in e)e.hasOwnProperty(o)&&i.push(t.call(n||null,o,e[o]));return i},filter:function(e,t,n){if(e.filter)return e.filter(t,n);for(var i=[],s=0,r=e.length;s<r;s++)t.call(n||null,e[s],s)&&i.push(e[s]);return i},asyncEach:function(e,t,n,i){var s=e.length,r=-1,o=0,a=!1,c=function(){return o-=1,r+=1,r===s?n&&n.call(i):void t(e[r],u)},l=function(){if(!a){for(a=!0;o>0;)c();a=!1}},u=function(){o+=1,l()};u()}}},{}],26:[function(e,t,n){(function(e){"use strict";var n={_registry:[],on:function(e,t,n,i){var s=function(){n.call(i)};e.addEventListener?e.addEventListener(t,s,!1):e.attachEvent("on"+t,s),this._registry.push({_element:e,_type:t,_callback:n,_context:i,_handler:s})},detach:function(e,t,n,i){for(var s,r=this._registry.length;r--;)s=this._registry[r],e&&e!==s._element||t&&t!==s._type||n&&n!==s._callback||i&&i!==s._context||(s._element.removeEventListener?s._element.removeEventListener(s._type,s._handler,!1):s._element.detachEvent("on"+s._type,s._handler),this._registry.splice(r,1),s=null)}};void 0!==e.onunload&&n.on(e,"unload",n.detach,n),t.exports={Event:n}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],27:[function(e,t,n){"use strict";var i=e("./extend");t.exports=function(e,t){"function"!=typeof e&&(t=e,e=Object);var n=function(){return this.initialize?this.initialize.apply(this,arguments)||this:this},s=function(){};return s.prototype=e.prototype,n.prototype=new s,i(n.prototype,t),n}},{"./extend":32}],28:[function(e,t,n){t.exports={VERSION:"1.2.3",BAYEUX_VERSION:"1.0",ID_LENGTH:160,JSONP_CALLBACK:"jsonpcallback",CONNECTION_TYPES:["long-polling","cross-origin-long-polling","callback-polling","websocket","eventsource","in-process"],MANDATORY_CONNECTION_TYPES:["long-polling","callback-polling","in-process"]}},{}],29:[function(e,t,n){"use strict";t.exports={}},{}],30:[function(e,t,n){"use strict";var i=function(e){var t,n,s;if(e instanceof Array){for(t=[],n=e.length;n--;)t[n]=i(e[n]);return t}if("object"==typeof e){t=null===e?null:{};for(s in e)t[s]=i(e[s]);return t}return e};t.exports=i},{}],31:[function(e,t,n){function i(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1}function s(){}var r="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};t.exports=s,s.prototype.emit=function(e){if("error"===e&&(!this._events||!this._events.error||r(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var t=this._events[e];if(!t)return!1;if("function"==typeof t){switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);t.apply(this,n)}return!0}if(r(t)){for(var n=Array.prototype.slice.call(arguments,1),i=t.slice(),s=0,o=i.length;s<o;s++)i[s].apply(this,n);return!0}return!1},s.prototype.addListener=function(e,t){if("function"!=typeof t)throw new Error("addListener only takes instances of Function");return this._events||(this._events={}),this.emit("newListener",e,t),this._events[e]?r(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,this},s.prototype.on=s.prototype.addListener,s.prototype.once=function(e,t){var n=this;return n.on(e,function i(){n.removeListener(e,i),t.apply(this,arguments)}),this},s.prototype.removeListener=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var n=this._events[e];if(r(n)){var s=i(n,t);if(s<0)return this;n.splice(s,1),0==n.length&&delete this._events[e]}else this._events[e]===t&&delete this._events[e];return this},s.prototype.removeAllListeners=function(e){return 0===arguments.length?(this._events={},this):(e&&this._events&&this._events[e]&&(this._events[e]=null),this)},s.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),r(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]}},{}],32:[function(e,t,n){"use strict";t.exports=function(e,t,n){if(!t)return e;for(var i in t)t.hasOwnProperty(i)&&(e.hasOwnProperty(i)&&n===!1||e[i]!==t[i]&&(e[i]=t[i]));return e}},{}],33:[function(e,t,n){"use strict";var i=e("asap"),s=0,r=1,o=2,a=function(e){return e},c=function(e){throw e},l=function(e){if(this._state=s,this._onFulfilled=[],this._onRejected=[],"function"==typeof e){var t=this;e(function(e){f(t,e)},function(e){g(t,e)})}};l.prototype.then=function(e,t){var n=new l;return u(this,e,n),d(this,t,n),n},l.prototype.catch=function(e){return this.then(null,e)};var u=function(e,t,n){"function"!=typeof t&&(t=a);var i=function(e){h(t,e,n)};e._state===s?e._onFulfilled.push(i):e._state===r&&i(e._value)},d=function(e,t,n){"function"!=typeof t&&(t=c);var i=function(e){h(t,e,n)};e._state===s?e._onRejected.push(i):e._state===o&&i(e._reason)},h=function(e,t,n){i(function(){p(e,t,n)})},p=function(e,t,n){var i;try{i=e(t)}catch(e){return g(n,e)}i===n?g(n,new TypeError("Recursive promise chain detected")):f(n,i)},f=function(e,t){var n,i,s=!1;try{if(n=typeof t,i=null!==t&&("function"===n||"object"===n)&&t.then,"function"!=typeof i)return m(e,t);i.call(t,function(t){s^(s=!0)&&f(e,t)},function(t){s^(s=!0)&&g(e,t)})}catch(t){if(!(s^(s=!0)))return;g(e,t)}},m=function(e,t){if(e._state===s){e._state=r,e._value=t,e._onRejected=[];for(var n,i=e._onFulfilled;n=i.shift();)n(t)}},g=function(e,t){if(e._state===s){e._state=o,e._reason=t,e._onFulfilled=[];for(var n,i=e._onRejected;n=i.shift();)n(t)}};l.resolve=function(e){return new l(function(t,n){t(e)})},l.reject=function(e){return new l(function(t,n){n(e)})},l.all=function(e){return new l(function(t,n){var i,s=[],r=e.length;if(0===r)return t(s);for(i=0;i<r;i++)(function(e,i){l.resolve(e).then(function(e){s[i]=e,0===--r&&t(s)},n)})(e[i],i)})},l.race=function(e){return new l(function(t,n){for(var i=0,s=e.length;i<s;i++)l.resolve(e[i]).then(t,n)})},l.deferred=l.pending=function(){var e={};return e.promise=new l(function(t,n){e.resolve=t,e.reject=n}),e},t.exports=l},{asap:1}],34:[function(e,t,n){"use strict";var i=e("./class");t.exports=i({initialize:function(){this._index={}},add:function(e){var t=void 0!==e.id?e.id:e;return!this._index.hasOwnProperty(t)&&(this._index[t]=e,!0)},forEach:function(e,t){for(var n in this._index)this._index.hasOwnProperty(n)&&e.call(t,this._index[n])},isEmpty:function(){for(var e in this._index)if(this._index.hasOwnProperty(e))return!1;return!0},member:function(e){for(var t in this._index)if(this._index[t]===e)return!0;return!1},remove:function(e){var t=void 0!==e.id?e.id:e,n=this._index[t];return delete this._index[t],n},toArray:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}})},{"./class":27}],35:[function(e,t,n){"use strict";t.exports=function(e){return JSON.stringify(e,function(e,t){return this[e]instanceof Array?this[e]:t})}},{}],36:[function(e,t,n){"use strict";t.exports={isURI:function(e){return e&&e.protocol&&e.host&&e.path},isSameOrigin:function(e){return e.protocol===location.protocol&&e.hostname===location.hostname&&e.port===location.port},parse:function(e){if("string"!=typeof e)return e;var t,n,i,s,r,o,a={},c=function(t,n){e=e.replace(n,function(e){return a[t]=e,""}),a[t]=a[t]||""};for(c("protocol",/^[a-z]+\:/i),c("host",/^\/\/[^\/\?#]+/),/^\//.test(e)||a.host||(e=location.pathname.replace(/[^\/]*$/,"")+e),c("pathname",/^[^\?#]*/),c("search",/^\?[^#]*/),c("hash",/^#.*/),a.protocol=a.protocol||location.protocol,a.host?(a.host=a.host.substr(2),t=a.host.split(":"),a.hostname=t[0],a.port=t[1]||""):(a.host=location.host,a.hostname=location.hostname,a.port=location.port),a.pathname=a.pathname||"/",a.path=a.pathname+a.search,n=a.search.replace(/^\?/,""),i=n?n.split("&"):[],o={},s=0,r=i.length;s<r;s++)t=i[s].split("="),o[decodeURIComponent(t[0]||"")]=decodeURIComponent(t[1]||"");return a.query=o,a.href=this.stringify(a),a},stringify:function(e){var t=e.protocol+"//"+e.hostname;return e.port&&(t+=":"+e.port),t+=e.pathname+this.queryString(e.query)+(e.hash||"")},queryString:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return 0===t.length?"":"?"+t.join("&")}}},{}],37:[function(e,t,n){"use strict";var i=e("./array");t.exports=function(e,t){for(var n in e)if(i.indexOf(t,n)<0)throw new Error("Unrecognized option: "+n)}},{"./array":25}],38:[function(e,t,n){(function(e){"use strict";var n=e.MozWebSocket||e.WebSocket;t.exports={create:function(e,t,i){return"function"!=typeof n?null:new n(e)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],39:[function(e,t,n){function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function r(e){if(d===setTimeout)return setTimeout(e,0);if((d===i||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function o(e){if(h===clearTimeout)return clearTimeout(e);if((h===s||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){g&&f&&(g=!1,f.length?m=f.concat(m):v=-1,m.length&&c())}function c(){if(!g){var e=r(a);g=!0;for(var t=m.length;t;){for(f=m,m=[];++v<t;)f&&f[v].run();v=-1,t=m.length}f=null,g=!1,o(e)}}function l(e,t){this.fun=e,this.array=t}function u(){}var d,h,p=t.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:i}catch(e){d=i}try{h="function"==typeof clearTimeout?clearTimeout:s}catch(e){h=s}}();var f,m=[],g=!1,v=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.push(new l(e,t)),1!==m.length||g||r(c)},l.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=u,p.addListener=u,p.once=u,p.off=u,p.removeListener=u,p.removeAllListeners=u,p.emit=u,p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],40:[function(e,t,n){"use strict";function i(e){return e&&"EPROMISERETRY"===e.code&&a.call(e,"retried")}function s(e,t){var n,s;return"object"==typeof e&&"function"==typeof t&&(n=t,t=e,e=n),s=o.operation(t),new Promise(function(t,n){s.attempt(function(o){Promise.resolve().then(function(){return e(function(e){throw i(e)&&(e=e.retried),r("Retrying","EPROMISERETRY",{retried:e})},o)}).then(t,function(e){i(e)&&(e=e.retried,s.retry(e||new Error))||n(e)})})})}var r=e("err-code"),o=e("retry"),a=Object.prototype.hasOwnProperty;t.exports=s},{"err-code":3,retry:41}],41:[function(e,t,n){t.exports=e("./lib/retry")},{"./lib/retry":42}],42:[function(e,t,n){var i=e("./retry_operation");n.operation=function(e){var t=n.timeouts(e);return new i(t,{forever:e&&e.forever,unref:e&&e.unref})},n.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],s=0;s<t.retries;s++)i.push(this.createTimeout(s,t));return e&&e.forever&&!i.length&&i.push(this.createTimeout(s,t)),i.sort(function(e,t){return e-t}),i},n.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,i=Math.round(n*t.minTimeout*Math.pow(t.factor,e));return i=Math.min(i,t.maxTimeout)},n.wrap=function(e,t,i){if(t instanceof Array&&(i=t,t=null),!i){i=[];for(var s in e)"function"==typeof e[s]&&i.push(s)}for(var r=0;r<i.length;r++){var o=i[r],a=e[o];e[o]=function(){var i=n.operation(t),s=Array.prototype.slice.call(arguments),r=s.pop();s.push(function(e){i.retry(e)||(e&&(arguments[0]=i.mainError()),r.apply(this,arguments))}),i.attempt(function(){a.apply(e,s)})},e[o].options=t}}},{"./retry_operation":43}],43:[function(e,t,n){function i(e,t){"boolean"==typeof t&&(t={forever:t}),this._timeouts=e,this._options=t||{},this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}t.exports=i,i.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null},i.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;this._errors.push(e);var t=this._timeouts.shift();if(void 0===t){if(!this._cachedTimeouts)return!1;this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),t=this._timeouts.shift()}var n=this,i=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),this._options.unref&&n._timeout.unref()),n._fn(n._attempts)},t);return this._options.unref&&i.unref(),!0},i.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout)),this._fn(this._attempts)},i.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},i.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},i.prototype.start=i.prototype.try,i.prototype.errors=function(){return this._errors},i.prototype.attempts=function(){return this._attempts},i.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,i=0;i<this._errors.length;i++){var s=this._errors[i],r=s.message,o=(e[r]||0)+1;e[r]=o,o>=n&&(t=s,n=o)}return t}},{}],44:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c,l,u,d,h,p,f,m,g){function v(){function e(){var e=m.notifySharedAccessWiley();i.$watch("sharing",function(t){t||m.hide(e)}),$(o).on("access-check",function(){o.hasFullAccess()&&i.$emit("close-checkout")})}function t(){var e=null;a.onExternalCheck(function(){o.hasAccess()||(e=m.notifySharedPaywallWiley())}),$(o).on("access-check",function(){e&&o.hasFullAccess()&&m.hide(e)})}function n(){o.isShared()?e():i.sharingToken&&t()}function s(){if(o.isShared()){var e=f.notifySharedAccess();$(o).on("access-check",function(){o.isShared()||f.hide(e)})}}function r(){"wiley"==o.get().publisher?n():"ieee"!=o.get().publisher&&s()}$(a).on("rental-expiry",f.notifyRentalExpiry),$(a).on("external-access-timeout",function(){o.isShared()&&!a.externalCheckAvailable()||f.notifyAuthFailed()}),$(o).on("access-forbidden",f.notifyAccessForbidden),o.onData(function(){a.externalCheckAvailable()?a.onExternalCheck(r):o.onAccess(r)}),Promise.all([w(),b()]).then(f.notifyReadPersonal)}function w(){return new Promise(function(e){a.onExternalCheck(function(){!o.hasAccess()&&e()})})}function b(){return new Promise(function(e){o.onInit(function(){c.item.get().then(function(t){t.item.pdf_hash&&e()},_.noop)})})}e.trackPdfToolbar=!0,e.download=function(e){return p.download(e)},e.print=function(e){return p.print(e)},$(window).on("keydown",function(e){(e.metaKey||e.ctrlKey)&&(70==e.keyCode?l.loadAll():80==e.keyCode&&(e.preventDefault(),p.print()))}),$(d).on("update",function(){h.available().then(f.notifyUpdateAvailable)}),$(d).on("toast",function(e,t){f.notifyMessage(t)}),o.onInit(function(e){e.viewer_pdf&&n.pdfjs?l.setLocalData(e):(l.setPreviewData(e).catch(function(e){if(!e||"load_html_fail"!=e.error)throw e;$.get(r.ip_api,function(t){(trackJs||window).console.log("load html fail location:",t),g(e,{country:t.country})}).always(function(){setTimeout(function(){o.onData(function(e){s.redirectOrPost(e.meta.pdf_url)})},300)})}),o.onAccessCheck(function(e){o.hasAccess()&&l.setFullData(e)}),o.onAccess(function(){$(o).on("resources-expired",function(){$(l).one("loading-start",a.performAccessChecks)})}))}),$(l).on("page-changed",function(e,t){u.scroll(t)}),v()}i.$inject=["$scope","$state","$stateParams","$rootScope","util","endpoint","article","access","sync","viewer","tracker","command","update","articleExport","toast","infoBar","trackError"],angular.module("reader").controller("ArticleCtrl",i)},{}],45:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c,l,u){function d(){"wiley"==r.get().publisher&&t(function(){e.publisherPageLabel="Go to HTML"})}function h(){r.get().doi&&(e.defaultAction={handler:e.openRelated,tooltip:"Related Articles",icon:"layers"})}e.user=o,e.article=r,e.tracker=c,e.altmetric=void 0,e.publisherPageLabel=void 0,e.notes=l.listArr(),u.then(function(t){e.altmetric=t},_.noop),e.toggleAnnots=function(){s.$emit("toggle-annotations")},r.onInit(function(e){d(),h()}),$(l).on("changed",function(){t(function(){e.notes=l.listArr()})}),e.toolsEnabled=function(){return"ieee"!=r.get().publisher&&(r.get().doi||e.notesEnabled())},e.notesEnabled=function(){return o.signedIn()&&r.hasAccess()&&!r.get().sync_item_sponsored},e.gotoPublisher=function(){window.open(r.getProxiedUrl(),"_blank"),c.linkout("publisher")},e.openAltmetric=function(){window.open(e.altmetric.detailsUrl,"_blank"),c.altmetric()},e.export=function(e){i.show(i.alert({targetEvent:e,clickOutsideToClose:!0,templateUrl:"dialogs/export.html",controller:"ExportCtrl"})),c.exportOptions()},e.share=function(e){var t=angular.merge(s.$new(!0),{type:"dialog"}),n="dialogs/share.html",o="ShareCtrl";"wiley"==r.get().publisher&&(n="dialogs/share_wiley.html",o="ShareWileyCtrl"),i.show(i.alert({scope:t,targetEvent:e,clickOutsideToClose:!0,templateUrl:n,controller:o})),c.sidepanel("share")}}i.$inject=["$scope","$timeout","$http","$mdDialog","$rootScope","article","user","endpoint","tracker","annotationsModel","altmetricInit"],angular.module("reader").controller("ArticleToolsCtrl",i)},{}],46:[function(e,t,n){function i(e,t,n,i,s,r){i.onInit(function(i){$("body").addClass("publisher-"+(i.original_publisher||i.publisher)),s.setPreviewData(i).catch(function(){t.go("error.404",null,{location:!1})}),n(function(){e.articleUrl=[r.dx_doi,i.doi].join("/")})})}i.$inject=["$scope","$state","$timeout","article","viewer","endpoint"],angular.module("reader").controller("DiscoverCtrl",i)},{}],47:[function(e,t,n){function i(e,t,n,i,s){function r(){return t.is("error.404")?"Possible Broken Link (404)":"Possible Server Error (500)"}function o(){return sprintf("I cannot load the following webpage: %s",location.href)}function a(e,t){return sprintf("mailto:support@readcube.com?subject=%s&body=%s",encodeURIComponent(e),encodeURIComponent(t))}e.showCode=!1,e.showMessage=!1,e.supportHref=a(r(),o()),e.edgeSupportHref=["http://support.readcube.com/knowledgebase/articles","815760-i-can-t-open-pdfs-from-the-web-library-app-in-edge"].join("/"),i.visible().then(function(){s.start(),n(function(){e.showCode=!0},600),n(function(){e.showMessage=!0},1200)})}i.$inject=["$scope","$state","$timeout","visibility","errorAnimation"],angular.module("reader").controller("ErrorCtrl",i)},{}],48:[function(e,t,n){function i(e,t,n){function i(t){e.index!=t&&(e.index=t,e.busy=!0)}e.busy=!0,e.detailsOpen=!0,e.figures=n.get().figures||[],e.showNav=e.figures.length>1,e.toggleDetails=function(){e.detailsOpen=!e.detailsOpen},e.figure=function(){return e.figures[e.index]},e.next=function(){i((e.index+1)%e.figures.length)},e.prev=function(){i((e.index+e.figures.length-1)%e.figures.length)},$(window).on("keydown.figure-viewer",function(n){if(!n.metaKey&&!n.ctrlKey)switch(n.keyCode){case 37:case 38:t(e.prev);break;case 39:case 40:t(e.next)}}),e.$on("$destroy",function(){$(window).off("keydown.figure-viewer")})}i.$inject=["$scope","$timeout","article"],angular.module("reader").controller("FigureViewerCtrl",i)},{}],49:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c,l,u,d,h,p,f){function m(){return h.saveCloud(),c.item.add().then(d.showSyncedAd).catch(_.noop)}function g(){return c.item.remove().catch(_.noop)}function v(){$(c.item).on("busy",function(){n(function(){e.syncing=!0})}),$(c.item).on("done",function(){n(function(){e.syncing=!1})}),c.item.onAdd(function(){n(function(){e.inLibrary=!0})}),c.item.onRemove(function(){n(function(){e.inLibrary=!1})}),l.onInit(function(t){"wiley"==t.publisher&&n(function(){e.publisherLinkout=function(){window.open(l.getProxiedUrl(),"_blank"),h.linkout("publisher")}})})}e.user=o,e.article=l,e.syncing=!1,e.inLibrary=!1,e.downloading=!1,e.showClose=r.show_close,e.close=function(){window.parent.postMessage({type:"close"},"*")},e.downloadPdf=function(t){e.downloading=!0,p.download(t).finally(function(){n(function(){e.downloading=!1})}),h.menuBar("download_pdf")},e.getAccess=function(){t.$emit("toggle-checkout")},e.toggleInLibrary=function(t){e.syncing||(e.inLibrary?g():(o.signedIn()?m():f.showRegister({targetEvent:t,params:{tracking_action:"add_to_library",tracking_origin:h.trackingOrigin()},onAuth:function(){u.onLoginCheck(m)},registerAd:"ads/add_to_library.html"}),h.menuBar("add_to_library")))},e.openMoreMenu=function(e,t){e(t)},e.onAppMenuClick=function(t){t.stopPropagation(),o.signedIn()?e.toggleAppNav():f.showRegister({targetEvent:t,params:{tracking_action:"toolbar_signup",tracking_origin:h.trackingOrigin(),promocode:"WRSUM162"},registerAd:"ads/my_library_register.html",successAd:"ads/my_library_success.html"})},t.toggleAppNav=function(){i("appnav").toggle(),i("appnav").isOpen()&&(t.$emit("appnav-open"),h.sidepanel("library"))},t.closeAppNav=function(){i("appnav").close(),t.$emit("appnav-close")},v()}i.$inject=["$scope","$rootScope","$timeout","$mdSidenav","$sce","$stateParams","user","endpoint","sync","article","access","toast","tracker","articleExport","userModal"],angular.module("reader").controller("MenuBarCtrl",i)},{}],50:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c,l,u,d,h,p,f,m,g,v,w,b,y,k){function x(){"wiley"==o.get().publisher?o.isShared()?g.notifySharedAccessWiley():!o.hasAccess()&&A()&&g.notifySharedPaywallWiley():o.isShared()&&g.notifySharedAccess()}function C(){return v.saveCloud(),d.item.add().then(g.showSyncedAd).catch(_.noop)}function T(){return d.item.remove().catch(_.noop)}function A(){return!_.isEmpty(a.pickDefined(t,y.SHARING_TOKENS))}function E(){return new Promise(function(e){f.onExternalCheck(function(){!o.hasAccess()&&e()})})}function j(){return new Promise(function(e){o.onInit(function(){d.item.get().then(function(t){t.item.pdf_hash&&e()},_.noop)})})}e.user=l,e.article=o,e.syncing=!1,e.inLibrary=!1,e.altmetric=void 0,e.numPages=void 0,e.notes=m.listArr(),s.mobileFeedback=!!k.local.get("mobile-feedback"),e.contactSupport=function(){window.open("https://support.readcube.com")},e.leaveFeedback=function(){i("leave-feedback").open()},e.accountPage=function(){window.open(c.web+"/account","_blank")},e.share=function(){var e="wiley"==o.get().publisher?"share-wiley":"share";i(e).open().then(function(){return s.$emit(e+"-open")}),v.sidepanel("share")},e.sharingEnabled=function(){return o.get().access_share_enabled},e.notesEnabled=function(){return e.notes.length&&l.signedIn()&&o.hasAccess()&&!o.get().sync_item_sponsored},e.openAnnots=function(){i("annotations").open()},e.openAltmetric=function(){window.open(e.altmetric.detailsUrl,"_blank"),v.altmetric()},e.closeSidenav=function(e){i(e).close()},e.openRelated=function(){i("related").open(),v.related(),v.sidepanel("related"),o.getRelated().then(function(t){n(function(){e.related=t||[]})})},e.openReferences=function(){i("references").open(),v.sidepanel("references")},e.openMetrics=function(){l.signedIn()?(i("cited-by").open(),s.$emit("cited-by-open"),v.sidepanel("cited_by")):g.promptRegister(function(){i("cited-by").open(),s.$emit("cited-by-open"),v.sidepanel("cited_by")})},e.openRCR=function(){i("rcr").open(),v.sidepanel("rcr")},e.openSupplements=function(){i("supplements").open(),v.sidepanel("supplements")},e.openFigures=function(){i("figures").open(),v.sidepanel("figures")},e.signIn=function(e){u.showRegister({params:{tracking_action:"toolbar_signup",tracking_origin:v.trackingOrigin()},targetEvent:e})},e.signOut=function(){w.clear(),l.signOut(function(){c.parent?window.parent.postMessage({type:"sign_out",url:c.parent},"*"):location.reload()})},e.gotoPublisher=function(){v.linkout("publisher"),o.isShared()&&/springer|nature/.test(o.get().publisher)?y.getProxiedArticle(o.get().doi).then(function(e){return a.redirectOrPost(e.url)}).catch(function(){return a.redirectOrPost(o.getProxiedUrl())}):n(function(){return a.redirectOrPost(o.getProxiedUrl())},300)},e.toggleInLibrary=function(t){e.syncing||(e.inLibrary?T():(l.signedIn()?C():u.showRegister({title:"Add To Library",params:{tracking_action:"add_to_library",tracking_origin:v.trackingOrigin()},onAuth:function(){f.onLoginCheck(C)},registerAd:"ads/add_to_library.html",targetEvent:t}),v.menuBar("add_to_library")))},t.feed_token&&$("body").addClass("article-feed"),b.then(function(t){n(function(){return e.altmetric=t})},_.noop),o.onInit(function(t){n(function(){return e.numPages=t.options.total_pages})}),$(h).on("update",function(){p.available().then(g.notifyUpdateAvailable)}),$(h).on("toast",function(e,t){g.notifyMessage(t)}),$(m).on("changed",function(){n(function(){return e.notes=m.listArr()})}),$(f).on("rental-expiry",g.notifyRentalExpiry),$(f).on("external-access-timeout",function(){o.isShared()&&!f.externalCheckAvailable()||g.notifyAuthFailed()}),$(o).on("access-forbidden",g.notifyAccessForbidden),Promise.all([E(),j()]).then(g.notifyReadPersonal),d.item.onAdd(function(){n(function(){e.inLibrary=!0})}),d.item.onRemove(function(){n(function(){e.inLibrary=!1})}),$(d.item).on("busy",function(){n(function(){e.syncing=!0})}),$(d.item).on("done",function(){n(function(){e.syncing=!1})}),o.onInit(function(t){$("body").addClass("initialized"),t.publisher&&o.isBrandable()&&$("body").addClass("publisher-"+t.publisher),"wiley"==o.get().publisher&&n(function(){return e.publisherPageLabel="Go to HTML"})}),o.onData(function(t){$("body").addClass("metadata"),e.$emit("start-read-mode"),n(function(){e.metadata=t.meta,e.supplements=t.supplements,e.references=t.references,e.figures=t.figures})}),o.onData(function(){f.externalCheckAvailable()?f.onExternalCheck(x):o.onAccess(x)}),o.onAccessCheck(function(e){e.pdf_url&&$("body").addClass("can-save"),e.print_url&&$("body").addClass("can-print")})}i.$inject=["$scope","$stateParams","$timeout","$mdSidenav","$rootScope","$http","article","util","endpoint","user","userSidenav","sync","command","update","access","annotationsModel","toast","tracker","trackId","altmetricInit","accessToken","storage"],angular.module("reader").controller("MobileReaderCtrl",i)},{}],51:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c,l,u){t.pageIndex=1,t.numPages=1,t.downloading=!1,t.authorizing=!1,t.unauthorized=!1,$(a).on("auth-begin",function(){n(function(){return t.authorizing=!0})}),$(a).on("auth-end",function(){n(function(){return t.authorizing=!1})}),o.onData(function(){a.onExternalCheck(function(){o.hasAccess()||n(function(){return t.unauthorized=!0})})}),t.getAccess=function(){s.redirectOrPost([r.web+"/checkout/new?","doi="+encodeURIComponent(o.get().doi)+"&","redirect="+encodeURIComponent(location.href)+"&","embed=1&mobile=1"].join(""))},t.download=function(e){t.downloading=!0,u.download(e).catch(function(e){"preview"==e&&t.getAccess()}).finally(function(){n(function(){return t.downloading=!1})}),c.menuBar("download_pdf")},t.menu=function(){i("mobile_menu").toggle()},t.prevPage=function(){l.curIndex--},t.nextPage=function(){l.curIndex++},l.onInit(function(){n(function(){t.viewer=l,t.numPages=l.numPages})}),$(l).on("page-changed",function(e,i){n(function(){return t.pageIndex=i})}),$(l).on("slide",function(e,i){n(function(){i=Math.round(i),i!=t.pageIndex&&(t.pageIndex=i)})})}i.$inject=["$rootScope","$scope","$timeout","$mdSidenav","util","endpoint","article","access","tracker","mobileViewer","articleExport"],angular.module("reader").controller("MobileToolbarCtrl",i)},{}],52:[function(e,t,n){function i(e,t,n,i){function s(){return parseInt(n.session.get(o()))||10}function r(e){n.session.set(o(),Math.min(e,60))}function o(){return["processing-refresh",CryptoJS.MD5(location.href).toString()].join(":")}e.refresh=s();var a=t(function(){--e.refresh>0||(t.cancel(a),r(2*s()),i.reload())},1e3)}i.$inject=["$scope","$interval","storage","util"],angular.module("reader").controller("ProcessingCtrl",i)},{}],53:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c,l,u,d,h,p){function f(){return!_.isEmpty(o.pickDefined(t,p.SHARING_TOKENS))}e.env=a,e.article=l,e.metadata=void 0,e.related=void 0,e.references=void 0,e.supplements=void 0,e.figures=void 0,e.goNext=void 0,e.goPrev=void 0,n.sharingToken=f(),e.openRelated=function(){s("related").open(),d.related(),d.sidepanel("related"),l.getRelated().then(function(t){r(function(){e.related=t||[]})})},e.openReferences=function(){s("references").open(),d.sidepanel("references")},e.openMetrics=function(){u.signedIn()?(s("cited-by").open(),n.$emit("cited-by-open"),d.sidepanel("cited_by")):h.promptRegister(function(){s("cited-by").open(),n.$emit("cited-by-open"),d.sidepanel("cited_by")})},e.openRCR=function(){s("rcr").open(),d.sidepanel("rcr")},e.openSupplements=function(){s("supplements").open(),d.sidepanel("supplements")},e.openFigures=function(){s("figures").open(),d.sidepanel("figures")},t.feed_token&&$("body").addClass("article-feed"),$(c).on("bg-click",function(){t.lightbox&&window.parent.postMessage({type:"close"},"*")}),l.onInit(function(t){$("body").addClass("initialized"),t.publisher&&l.isBrandable()&&$("body").addClass("publisher-"+t.publisher),r(function(){t.sync_next_item_id&&(e.goNext=function(){o.redirectOrPost(i.href("sponsored",{
resource_id:[t.sync_collection_id,t.sync_next_item_id].join(":")},{absolute:!0}))}),t.sync_prev_item_id&&(e.goPrev=function(){o.redirectOrPost(i.href("sponsored",{resource_id:[t.sync_collection_id,t.sync_prev_item_id].join(":")},{absolute:!0}))})})}),l.onData(function(t){$("body").addClass("metadata"),e.$emit("start-read-mode"),r(function(){e.metadata=t.meta,e.supplements=t.supplements,e.references=t.references,e.figures=t.figures})}),l.onAccessCheck(function(e){e.pdf_url&&$("body").addClass("can-save"),e.print_url&&$("body").addClass("can-print")}),$(l).on("access-check",function(){r(function(){return n.sharing=l.isShared()})})}i.$inject=["$scope","$stateParams","$rootScope","$state","$mdSidenav","$timeout","util","environment","viewer","article","user","tracker","toast","accessToken"],angular.module("reader").controller("ReaderCtrl",i)},{}],54:[function(e,t,n){function i(e,t,n,i,s){e.types=n.types.split(","),i.onInit(function(e){s.setPreviewData(e).catch(function(e){if(!e||"load_html_fail"!=e.error)throw e;t.go("error.404",null,{location:!1})})}),i.onAccess(function(e){s.setFullData(e)})}i.$inject=["$scope","$state","$stateParams","article","viewer"],angular.module("reader").controller("ResolveCtrl",i)},{}],55:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c){e.article=r,e.details=void 0,e.toolbarLinks=void 0,e.notes=a.listArr(),e.toggleAnnots=function(){s.$emit("toggle-annotations")},e.toggleInfo=function(){s.$emit("toggle-info")},r.onInit(function(t){$("body").addClass("initialized"),t.publisher&&r.isBrandable()&&$("body").addClass("publisher-"+t.publisher),t.description&&t.description.length&&$("body").addClass("info-open"),(t.download_url||t.url)&&$("body").addClass("can-save"),t.viewer_pdf?o.setLocalData(t):(o.setPreviewData(t).catch(function(e){if(!e||"load_html_fail"!=e.error)throw e;c(e)}),o.setFullData(t),$(r).on("resources-expired",function(){$(o).one("loading-start",function(){r.updateSupplement().then(o.setFullData)})})),n(function(){e.$emit("start-read-mode"),e.caption=t.caption||["Supplement",parseInt(t.index)+1].join(" "),e.type=t.type.toUpperCase().slice(0,4).replace(/\W/,""),e.details=t.description&&t.description.length,e.toolbarLinks={save:{target:t.download_url?void 0:"_blank",href:t.download_url||t.url}}})}),$(a).on("changed",function(){n(function(){e.notes=a.listArr()})})}i.$inject=["$scope","$state","$timeout","$stateParams","$rootScope","article","viewer","annotationsModel","trackError"],angular.module("reader").controller("SupplementCtrl",i)},{}],56:[function(e,t,n){function i(e,t,n,i,s,r){function o(t){e.trackPdfToolbar&&r.pdfToolbar(t)}e.printing=!1,e.downloading=!1,e.disabled={fullscreen_exit:!0},s.onInit(function(t){"ieee"==t.publisher&&(e.disabled.save=!0,e.disabled.print=!0)}),t.$watch("sharing",function(){"wiley"==s.get().publisher&&(e.disabled.save=t.sharing,e.disabled.print=t.sharing)}),e.toolbar={zoom_in:function(){i.scaleBy(1.25),o("zoom_in")},zoom_out:function(){i.scaleBy(.8),o("zoom_out")},rotate_right:function(){i.rotatePageBy(90),o("rotate")},fullscreen:function(){i.fitWidth(),o("fit_width"),e.disabled.fullscreen=!0,e.disabled.fullscreen_exit=!1},fullscreen_exit:function(){i.fitPage(),i.gotoPage(i.getPage()),o("fit_page"),e.disabled.fullscreen=!1,e.disabled.fullscreen_exit=!0},keyboard_arrow_down:function(){i.gotoPage(i.getPage()+1),o("page_down")},keyboard_arrow_up:function(){i.gotoPage(i.getPage()-1),o("page_up")},save:function(t){e.download&&!e.downloading&&(e.downloading=!0,e.download(t).finally(function(){n(function(){e.downloading=!1})}),o("save"))},print:function(t){e.print&&!e.printing&&(e.printing=!0,e.print(t).finally(function(){n(function(){e.printing=!1})}),o("print"))}}}i.$inject=["$scope","$rootScope","$timeout","viewer","article","tracker"],angular.module("reader").controller("ViewerToolbarCtrl",i)},{}],57:[function(e,t,n){function i(e,t,n,i,s,r){e.gotoPublisher=void 0,e.titleAction=r,e.msgAction={download:"saving",print:"printing"}[r],e.close=function(){n.hide()},i.onData(function(){t(function(){e.articleUrl=i.getProxiedUrl()})}),i.onData(function(n){("taylorfrancis"!=n.publisher||n.meta.url)&&t(function(){e.gotoPublisher=function(){window.open(i.getProxiedUrl(),"_blank"),s.linkout("publisher")}})})}i.$inject=["$scope","$timeout","$mdDialog","article","tracker","action"],angular.module("reader").controller("ComplimentaryCtrl",i)},{}],58:[function(e,t,n){function i(e,t,n,i,s){function r(e){return"bibtex"==e?"bib":"ris"}var o={type:"text/plain;charset=UTF-8"};e.format="ris",e.export=function(e){var a=n.get().meta,c=new Blob([s[r(e)](a,!0)],o);saveAs(c,encodeURIComponent(s.getKey(a)+"."+r(e))),i.exportCitation(e),t.hide()}}i.$inject=["$scope","$mdDialog","article","tracker","exporter"],angular.module("reader").controller("ExportCtrl",i)},{}],59:[function(e,t,n){function i(e,t,n,i,s,r,o){e.endpoint=t,e.savePaper=!0,e.openLibrary=function(){!s.item.id()&&e.savePaper&&n.onLoginCheck(function(){i.saveCloud(),s.item.add().then(r.showSyncedAd).catch(_.noop)}),o.hide()}}i.$inject=["$scope","endpoint","access","tracker","sync","toast","userModal"],angular.module("reader").controller("MyLibrarySuccessCtrl",i)},{}],60:[function(e,t,n){function i(e,t,n,i){e.synced=!1,e.endpoint=n,e.printPdf=function(){i.pdf().then(function(){t.hide()})},e.cloudPrint=function(){i.cloud().then(function(){t.hide()})},e.sendToMobile=function(){i.mobile().then(function(){e.synced=!0})}}i.$inject=["$scope","$mdDialog","endpoint","articlePrint"],angular.module("reader").controller("PrintCtrl",i)},{}],61:[function(e,t,n){function i(e,t,n,i){function s(){t.busy=!0,i.generate(t.includeAnnotations).then(function(e){n(function(){t.shareLink=e.url})}).finally(function(){n(function(){t.busy=!1})})}t.busy=!0,t.includeAnnotations=!1,t.shareLink="Generating Link...",t.$watch("includeAnnotations",function(e,t){e!=t&&s()}),t.select=function(e){e.preventDefault(),e.target.select()},"dialog"==t.type?s():e.$on("share-open",_.once(s))}i.$inject=["$rootScope","$scope","$timeout","share"],angular.module("reader").controller("ShareCtrl",i)},{}],62:[function(e,t,n){function i(e,t,n){function i(){e.busy=!0,e.shareLink="Generating Link...",n.generate().then(function(n){t(function(){e.shareLink=s=n.url})}).finally(function(){t(function(){e.busy=!1})})}var s=null;e.busy=!1,e.shareLink="",e.acceptTerms=!1,e.select=function(e){e.preventDefault(),e.target.select()},e.$watch("acceptTerms",function(t){t?s?e.shareLink=s:i():e.shareLink=""})}i.$inject=["$scope","$timeout","share"],angular.module("reader").controller("ShareWileyCtrl",i)},{}],63:[function(e,t,n){function i(e,t,n,i){e.titleAction=i,e.msgAction={download:"Saving",print:"Printing"}[i],e.close=function(){t.hide()},n.get().purchased_at&&(e.purchaseDate=new Date(1e3*n.get().purchased_at),e.purchaseType={1:"48-hour Rental",2:"Cloud Access"}[n.get().purchase_tier])}i.$inject=["$scope","$mdDialog","article","action"],angular.module("reader").controller("UnavailableCtrl",i)},{}],64:[function(e,t,n){function i(e,t,n,i,s){e.score=void 0,e.disabled=function(){return isNaN(e.score)},e.submit=function(){s(),n("leave-feedback").close(),i.local.set("mobile-feedback",!0),t.mobileFeedback=!!i.local.get("mobile-feedback"),mixpanel.track("NPS - Mobile Web Reader",{Score:e.score})}}i.$inject=["$scope","$rootScope","$mdSidenav","storage","initMixpanel"],angular.module("reader").controller("LeaveFeedbackCtrl",i)},{}],65:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c){function l(e){return i.merge(i.pickDefined(n,a),{index:e.index,st:i.readcube("st")})}function u(e){var n=t.href("supplement",l(e),{absolute:!0});window.open(n,"_blank")}e.viewSupplement=function(e,t){if("video"==t.type){e.preventDefault();var n=$(e.target.closest(".supplement.video"));n.find(".thumb").hasClass("load-failed")?window.open(t.source_url,"_blank"):o(t),r.video()}else c?r.supplement():(t.stylesheet||t.viewer_pdf)&&(e.preventDefault(),r.supplement(),u(t))}}i.$inject=["$scope","$state","$stateParams","util","article","tracker","videoPlayer","SUPPL_PARAMS","MOBILE"],angular.module("reader").controller("SupplementsCtrl",i)},{}],66:[function(e,t,n){function i(e,t,n){e.close=function(){n.hide()},e.reload=function(){t.reload()}}i.$inject=["$scope","util","toast"],angular.module("reader").controller("AccessFrobiddenCtrl",i)},{}],67:[function(e,t,n){function i(e,t,n,i,s,r,o){function a(){return r.saveCloud(),s.item.add().then(n.showSyncedAd).catch(_.noop)}e.close=function(){n.hide()},e.addToLibrary=function(e){n.hide(t),i.signedIn()?a():o.showRegister({params:{tracking_action:"annotations_notification",tracking_origin:r.trackingOrigin()},onAuth:a,registerAd:"ads/add_to_library.html",targetEvent:e})}}i.$inject=["$scope","toastId","toast","user","sync","tracker","userModal"],angular.module("reader").controller("AnnotsNotSyncedCtrl",i)},{}],68:[function(e,t,n){function i(e,t,n,i,s){e.articleUrl=void 0,e.close=function(){i.hide()},n.onData(function(i){t(function(){e.articleUrl=n.getProxiedUrl()})}),n.onAccessCheck(function(){n.hasFullAccess()&&i.hide(s)})}i.$inject=["$scope","$timeout","article","toast","toastId"],angular.module("reader").controller("AuthFailCtrl",i)},{}],69:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c){var l=c?a:o;e.close=function(){n.hide()},e.register=function(){l.showRegister({params:{tracking_action:"metrics_register_prompt",tracking_origin:s.trackingOrigin()},onAuth:r})},e.login=function(){l.showLogin({params:{tracking_action:"metrics_login_prompt",tracking_origin:s.trackingOrigin()},onAuth:r})},i.onSignIn(function(){n.hide(t)})}i.$inject=["$scope","toastId","toast","user","tracker","onAuth","userModal","userSidenav","MOBILE"],angular.module("reader").controller("PromptRegisterCtrl",i)},{}],70:[function(e,t,n){function i(e,t,n,i,s,r){t.close=function(){s.hide()},t.openPersonal=function(){r.item.get().then(function(t){i.redirectOrPost(e.href("library",{resource_id:[t.item.collection_id,t.item.id].join(":")},{absolute:!0}))},_.noop)}}i.$inject=["$state","$scope","$timeout","util","toast","sync"],angular.module("reader").controller("ReadPersonalCtrl",i)},{}],71:[function(e,t,n){function i(e,t,n,i,s){function r(){a()>=0?e.expiresIn=a():n.cancel(r.promise)}function o(){return 1e3*s.get().expires_at}function a(){return o()-Date.now()}e.expiresIn=void 0,e.expiredOn=void 0,e.close=function(){i.hide()},e.$on("$destroy",function(){n.cancel(r.promise)}),a()>=0?(r(),r.promise=n(r,1e3)):e.expiredOn=o()}i.$inject=["$scope","$timeout","$interval","toast","article"],angular.module("reader").controller("RentalExpiryCtrl",i)},{}],72:[function(e,t,n){function i(e,t,n,i,s,r){switch(e.gotoPublisher=void 0,e.publisherName="Publisher",e.initiative="sharing initiative",n.get().publisher){case"nature":case"springer":e.publisherName="Springer Nature",e.initiative="SharedIt",e.whatsThisLink="http://www.springernature.com/content-sharing";break;case"taylorfrancis":e.publisherName="Taylor & Francis",e.whatsThisLink="https://www.routledge.com/resources/authors/promoting";break;case"ieee":e.publisherName="IEEE"}"author_token"==n.get().access_method?e.message=sprintf("Online access to this article has been shared by the author(s) via %s %s.",e.publisherName,e.initiative):e.message=sprintf("Online access to this article has been provided by %s %s.",e.publisherName,e.initiative),e.close=function(){s.hide()},n.onData(function(s){("taylorfrancis"!=s.publisher||s.meta.url)&&t(function(){e.gotoPublisher=function(){window.open(n.getProxiedUrl(),"_blank"),i.linkout("publisher")}})})}i.$inject=["$scope","$timeout","article","tracker","toast","toastId"],angular.module("reader").controller("SharedAccessCtrl",i)},{}],73:[function(e,t,n){function i(e,t,n,i,s,r,o){e.type=o,e.learnMoreLink="http://www.wiley.com/WileyCDA/Section/id-829333.html",e.message={access:"Limited access to this article is provided by the Wiley Content Sharing initiative.",paywall:"The Wiley Content Sharing link that you used to access this page is no longer valid."}[o],e.getAccess=function(){t.redirectOrPost([i.web+"/checkout/new?","doi="+encodeURIComponent(n.get().doi)+"&","redirect="+encodeURIComponent(location.href)+"&","embed=1&mobile=1"].join(""))},e.close=function(){s.hide()}}i.$inject=["$scope","util","article","endpoint","toast","toastId","type"],angular.module("reader").controller("SharedAccessWileyCtrl",i)},{}],74:[function(e,t,n){function i(e,t,n){e.endpoint=t,e.close=function(){n.hide()}}i.$inject=["$scope","endpoint","toast"],angular.module("reader").controller("SyncedAdCtrl",i)},{}],75:[function(e,t,n){function i(e,t,n){e.close=function(){n.hide()},e.reload=function(){t.reload()}}i.$inject=["$scope","util","toast"],angular.module("reader").controller("UpdateAvailableCtrl",i)},{}],76:[function(e,t,n){function i(){return O.get().publisher}function s(){return!/^springer|taylorfrancis|ieee$/.test(i())}function r(e){return P(i())?e.replace(parseUri(e).host,P(i())):e}function o(){var e=R.jsonp_access[i()];return e?r(e):null}function a(){return"https://www.nature.com/articles/doi:"+O.get().doi+".epdf"}function c(){return"nature"!=i()?null:Y.addParams(r(a()),{doi:O.get().doi,pdf_url:O.get().meta.pdf_url,parent_url:location.href})}function l(){$(N.all).on("jsonp_access_result",function(e,t){b(t.result)}).on("pdf_size",function(e,t){Y.log("pdf size:",t.size),f(),m(t.size)}).on("pdf_size_fail",function(e,t){Y.log("get pdf size failed with status:",t.status),f(),E().then(function(){/5\d{2}/.test(t.status)||A()})})}function u(){if(!s())return!1;var e=parseUri(location.href).queryKey.standalone_access;o()?g():!e&&R.parent?h():p()}function d(){if(M={},L=!1,U=!1,z=!1,O.isPersonal()||O.isFeed())E();else try{$(D).trigger("auth-begin"),O.onData(function(){u(),y()}),X.onSignIn(k)}catch(e){throw $(D).trigger("auth-end"),e}}function h(){parseUri(location.href).queryKey.access_api?w():v()}function p(){c()&&(f(),$("<iframe></iframe>").attr("src",c()).addClass("access").appendTo(document.body))}function f(){$("iframe.access").remove()}function m(e){M.size=parseInt(e)||1337,E().then(A)}function g(){R.parent?w():_()}function v(){window.parent.postMessage({type:"get_pdf_size",pdf_url:O.get().meta.pdf_url},R.parent)}function w(){window.parent.postMessage({type:"jsonp_access_check"},R.parent)}function _(){var e=Y.timer.tic(),t=O.get(),n={resource:t.meta.original_doi};t.options&&t.options.cochrane&&(n.pdfType=t.options.cochrane),$.ajax({url:o(),dataType:"jsonp",data:n,success:function(t){Y.log("jsonp access response:",Y.timer.toc(e)+"ms",t),b(t)}})}function b(e){M.publisher_access_response=Y.merge(e,{publisher:i()}),E().then(A)}function y(){var e=!1;$(O).on("access-forbidden",function(){return e=!0}),setTimeout(function(){U||E()},5e3),setTimeout(function(){z||e||O.hasFullAccess()||$(D).trigger("external-access-timeout")},12e3)}function k(){E().then(function(){L=!0,$(D).trigger("login-access-check")})}function x(e){L?e():$(D).one("login-access-check",e)}function C(e){z?e():$(D).one("external-access-check",e)}function T(){O.onAccess(function(e){if(e.expires_at){var t=1e3*e.expires_at,n=t-Date.now();n>=0&&I.add(function(){Y.reload()},Date.now()+n),$(D).trigger("rental-expiry",[t])}})}function A(){z=!0,$(D).trigger("external-access-check")}function E(){return U=!0,$(D).trigger("auth-begin"),O.checkAccessWith(M).then(function(e){return $(D).trigger("auth-end"),e},function(e){return $(D).trigger("auth-end"),e})}function j(){R.parent&&C(function(){O.hasAccess()?window.parent.postMessage({type:"access:fulltext",share_type:O.get().share_type,share_token:O.get().share_token},R.parent):window.parent.postMessage({type:"access:preview"},R.parent)})}function S(){F||(O.onInit(function(e){j(),l(),d(),T()}),F=!0)}var X=e("./user"),Y=e("./utils/util"),I=e("./utils/alarm_clock"),P=e("./proxy_host"),R=e("./endpoint"),N=e("./receiver"),O=e("./article"),D={},F=!1,M={},L=!1,U=!1,z=!1;D.init=S,D.checkAccess=E,D.onLoginCheck=x,D.onExternalCheck=C,D.externalCheckAvailable=s,D.performAccessChecks=d,t.exports=D},{"./article":87,"./endpoint":95,"./proxy_host":112,"./receiver":113,"./user":128,"./utils/alarm_clock":130,"./utils/util":143}],77:[function(e,t,n){function i(){for(var e=parseUri(location.href),t=0;t<l.length;t++){var n=l[t],i=e.queryKey[n];if(i)return{key:n,val:decodeURIComponent(i)}}return null}function s(e){var t=i(),n={doi:e,source:"mobile_reader",referrer_url:decodeURIComponent(location.href),referrer:r.referrerHost(),tracking_id:a.get()};return n[t.key]=t.val,new Promise(function(e,t){$.get(o.services+"/reader/generate_proxy_url?"+$.param(n)).done(function(n){return n.url?e(n):t(n)}).fail(t)})}var r=e("./utils/util"),o=e("./endpoint"),a=e("./tracking/track_id"),c=["shared_access_token","referrer_access_token","author_access_token"],l=["feed_token"].concat(c);t.exports={get:i,getProxiedArticle:s,SHARING_TOKENS:c,ACCESS_TOKENS:l}},{"./endpoint":95,"./tracking/track_id":125,"./utils/util":143}],78:[function(e,t,n){function i(e,t){var n="html5"==t.renderer,i="swf"==t.renderer,o=!n&&!i,c=null,l={container:e.getElem(),insertWhitespace:!n};return t.text?(t.preceeding_text||(t.preceeding_text=""),o&&!_.isEmpty(t.rects)&&(l.boundingRects=a.getTransformedRects(e,t.rects)),c||(c=r.deserialize({prefix:t.preceeding_text,text:t.text},l)),!c&&i&&(c=r.deserialize({prefix:t.preceeding_text.slice(0,-1),text:t.text.slice(0,-1)},l)),!c&&i&&(c=r.deserialize({prefix:t.preceeding_text,text:t.text},s.merge(l,{matchMisconverted:!0}))),!c&&o&&(c=r.deserialize({prefix:"",text:t.text},l)),c):null}var s=e("../utils/util"),r=e("../utils/range_serializer"),o=e("./annotation_toolbar"),a=e("./annotation_helper"),c=function(e,t,n){t=s.merge({id:s.guid(),created:s.dateISO(),renderer:"html5",type:"highlight",has_note:!1,color_id:1},t),n=n||i(e,t),this.klass="annotation",this.id=s.guid(),this.page=e,this.data=t,this.range=n,this._initData(),this._initRects(),this._initElems(),this._addDrawable(),this._addEventable(),this._initToolbar()};c.prototype={_initData:function(){!this.data.text&&this.range&&(this.data=s.merge(this.data,a.rangeToTextData(this.range,this.page))),!this.data.rects&&this.range&&(this.data=s.merge(this.data,a.rangeToRectData(this.range,this.page)))},_initRects:function(){this.data.rects?this.rects=a.fromSyncCoords(this.page,this.data.rects):this.range&&(this.rects=a.getNormalizedRects(this.page,this.range))},_initElems:function(){var e=[],t=this.page.getZoom();_.each(this.rects,function(n){e.push(s.divFromRect(n.scale(t,t)))}),this._elems=$(e)},_addDrawable:function(){var e=[this.klass+"-elem-draw",this.getColor(),this.id].join(" ");a.isTextTransparent(this.range,this.page)&&(e+=" transparent");var t=a.addToDocumentFragment(this._elems,e);this._drawableElems=$(t).children(),this.page.getDrawable().append(t)},_addEventable:function(){var e=[this.klass,this.id].join(" "),t=a.addToDocumentFragment(this._elems,e);this._eventableElems=$(t).children(),this.page.getEventable().append(t)},_initToolbar:function(){var e=this;this.toolbar=new o(this),$(this.toolbar).on("add-note",function(){e._setNote(""),e.openToolbar()}).on("set-note",function(){e._setNote(e.toolbar.getNote())}).on("delete",function(){e.toolbar.close(),$(e).trigger("delete")})},_removeEventable:function(){this._eventableElems.remove(),this._eventableElems=null},_removeDrawable:function(){this._drawableElems.remove(),this._drawableElems=null},_destroyToolbar:function(){$(this.toolbar).off("add-note set-note delete"),this.toolbar.destroy(),this.toolbar=null},_setNote:function(e){this.hasNote()&&this.getNote()==e||(this.data.has_note=!0,this.data.note=e,$(this).trigger("change"))},setData:function(e){this.data=s.clone(e)},openToolbar:function(){this.toolbar.open()},hasNote:function(){return this.data.has_note},getElems:function(){return this._eventableElems},getNote:function(){return this.data.note},getColor:function(){var e=parseInt(this.data.color_id);return!e||e<1||e>4?"color-1":"color-"+e},getId:function(){return this.id},getDataId:function(){return this.data.id},getKlass:function(){return this.klass},destroy:function(){this._destroyToolbar(),this._removeEventable(),this._removeDrawable(),this.range=null,this.klass=null,this.data=null,this.page=null},serialize:function(){return s.clone(this.data)}},t.exports=c},{"../utils/range_serializer":137,"../utils/util":143,"./annotation_helper":79,"./annotation_toolbar":80}],79:[function(e,t,n){function i(e,t){return e?p.hasTransparentText(p.getElems(e)):t.hasTransparentText()}function s(e,t){var n=document.createDocumentFragment();return e.each(function(){var e=this.cloneNode();e.className=t,n.appendChild(e)}),n}function r(e,t){return Math.abs(e.top+e.height-(t.top+t.height))<1}function o(e,t){var n=[];return _.each(e,function(e){var i=n[n.length-1];i&&t(e,i)?i.boundingRect(e):n.push(e)}),n}function a(e,t){var n=[],i=e.getNormRect(),s=1/e.getScale();return p.getElems(t).each(function(){var e=this.getBoundingClientRect();if(e.width>0&&e.height>0){var t=new f(e.left,e.top,e.width,e.height);t.translate(-i.left,-i.top),t.scale(s,s),n.push(t)}}),o(n,r)}function c(e,t){var n=e.getNormRect(),i=e.getScale();return $.map(t,function(e){var t=new f(e[0],n.height-e[1]-e[3],e[2],e[3]);return t.scale(i,i),t.translate(n.left,n.top),t})}function l(e,t){var n=e.getNormRect();return $.map(t,function(e){return[[m.round10(e.left,-1),m.round10(n.height-e.top-e.height,-1),m.round10(e.width,-1),m.round10(e.height,-1)]]})}function u(e,t){var n=e.getNormRect();return $.map(t,function(e){return new f(e[0],n.height-e[1]-e[3],e[2],e[3])})}function d(e,t){var n=g.serialize(e,t.getElem(),128);return{preceeding_text:n.prefix,text:n.text}}function h(e,t){return{rects:l(t,a(t,e))}}var p=e("../utils/util"),f=e("../utils/rect"),m=e("../utils/number"),g=e("../utils/range_serializer");t.exports={isTextTransparent:i,addToDocumentFragment:s,getNormalizedRects:a,getTransformedRects:c,fromSyncCoords:u,rangeToTextData:d,rangeToRectData:h}},{"../utils/number":136,"../utils/range_serializer":137,"../utils/rect":138,"../utils/util":143}],80:[function(e,t,n){var i=e("./base_toolbar"),s=function(e){this.annot=e,this._init("annotations-base-toolbar","annotation")};s.prototype=$.extend(new i,{_initEvents:function(){this._deleted=!1,this._elem.find(".add-note").click($.proxy(this._onAddNote,this)),this._elem.find(".delete").click($.proxy(this._onDelete,this)),this._textarea().on("keydown",function(e){e.stopPropagation()}),this._textarea().on("keyup",_.debounce($.proxy(this._onSetNote,this),5e3)),this._textarea().on("blur",$.proxy(this._onSetNote,this)),$(this.annot).on("click",$.proxy(this.open,this))},_textarea:function(){return this._elem.find("textarea")},_onAddNote:function(){this._elem.toggleClass("note",!0),$(this).trigger("add-note")},_onDelete:function(){this._deleted=!0,$(this).trigger("delete")},_onSetNote:function(){this._deleted||$(this).trigger("set-note")},getNote:function(){return this._textarea().val()},updateNote:function(){this._textarea().is(":focus")||(this._elem.toggleClass("note",this.annot.hasNote()),this.getNote()!=this.annot.getNote()&&this._textarea().val(this.annot.getNote()||""))},open:function(){this.updateNote(),i.prototype.open.call(this,this.annot.getElems().first(),this.annot.getColor()),this._textarea().is(":visible")&&!this.getNote()&&this._textarea().focus()},destroy:function(){i.prototype.destroy.apply(this),this.selection=null,this.annot=null}}),t.exports=s},{"./base_toolbar":83}],81:[function(e,t,n){function i(e,t){A[e.getId()]=e,y.add(e),$(e).on("change",function(){k.updateItem(e.serialize())}).on("delete",function(){k.removeItem(e.getDataId()),s(e)}),t&&e.openToolbar()}function s(e){$(e).off("change delete"),y.remove(e),delete E[e.getDataId()],delete A[e.getId()],e.destroy()}function r(e){var t=e.page_start+1,n=C.getPageObj(t),s=new x(n,e,null);s&&(delete E[e.id],i(s))}function o(e){var t=e.page_start+1;j[t]=!1,E[e.id]=e,C.onInit(function(){a(t,C.getPageObj(t))})}function a(e,t){if(!j[e]&&t.hasText()){g.timer.tic();for(var n in E){var i=E[n];i&&i.page_start+1==e&&r(i)}j[e]=!0}}function c(e){return _.find(A,function(t){return t.getDataId()==e})}function l(){v.hasAccess()&&w.item.get().then(function(e){e.item.pdf_hash||w.item.add().catch(_.noop)},_.noop)}function u(e,t,n){var s=C.getPageObj(t),r=new x(s,g.merge(n,{sha256:v.get().hash,page_start:t-1,page_end:t-1}),e);i(r,n.has_note),k.addItem(r.serialize())}function d(e,t,n){u(e,t,{color_id:n}),b.highlight()}function h(e,t,n){u(e,t,{has_note:!0,note:n}),b.note()}function p(e){var t=c(e);t&&(k.removeItem(e),s(t))}function f(){S||v.get().sync_item_shared||(E=k.list(),$(C).on("page-loaded",function(e,t){a(t,C.getPageObj(t))}),C.onInit(function(){C.eachPage(a)}),$(k).on("add.external",function(e,t){o(t)}),$(k).on("update.external",function(e,t,n){var i=c(t.id);i&&i.setData(n)}),$(k).on("remove.external",function(e,t){var n=c(t.id);n&&s(n)}),$(k).on(["add.internal","update.internal","remove.internal"].join(" "),l),S=!0)}var m=e("../utils/mobile_detect").any,g=e("../utils/util"),v=e("../article"),w=e("../sync/sync"),b=e("../tracking/tracker"),y=e("../input_handler"),k=e("./annotations_model"),x=e("./annotation"),C=e(m?"../viewer/mobile_viewer":"../viewer/viewer"),T={},A={},E={},j={},S=!1;T.init=f,T.addHighlight=d,T.addNote=h,T.remove=p,t.exports=T},{"../article":87,"../input_handler":111,"../sync/sync":119,"../tracking/tracker":126,"../utils/mobile_detect":135,"../utils/util":143,"../viewer/mobile_viewer":148,"../viewer/viewer":151,"./annotation":78,"./annotations_model":82}],82:[function(e,t,n){function i(e){return e?".internal":".external"}function s(e){$(R).trigger("not-synced",[e])}function r(e,t){$(R).trigger("add"+i(t),[e]).trigger("changed")}function o(e,t,n){$(R).trigger("update"+i(n),[e,t]).trigger("changed")}function a(e,t){$(R).trigger("remove"+i(t),[e]).trigger("changed")}function c(e,t){e.text&&(N[e.id]=e,r(e,t))}function l(e,t,n){N[e.id]&&(_.isEqual(e,t)||(delete N[e.id],N[t.id]=t,o(e,t,n)))}function u(e,t){var n=N[e];n&&(delete N[e],a(n,t))}function d(e){return _.pick(e,["preceeding_text","text","color_id","has_note","note","page_start","page_end"])}function h(e){return CryptoJS.MD5(JSON.stringify(d(e))).toString()}function p(e,t){var n={},i={};return _.each(e,function(e){n[h(e)]=e}),_.each(t,function(e){i[h(e)]=e}),E.arrayToHash(_.filter(E.objDiff(n,i),function(e){return!_.isEmpty(d(e))}))}function f(e,t){_.each(e,function(e){e.sha256=t})}function m(){X.onData(function(){var e=X.get().shared_annotations_url;e&&Y.read(e).then(function(e){f(e.user_data.annotations,X.get().hash);var t=p(N,e.user_data.annotations);_.isEmpty(t)||(I.item.id()?$(R).trigger("merge-shared-prompt",function(){A(t)}):A(t))})})}function g(e){return e=e||{},I.annots.list().then(function(t){e=p(t.annotations,e);var n=E.arrayToHash(t.annotations);_.each(N,function(t,i){n[i]||e[i]||u(i)}),_.each(n,function(t,n){N[n]?(delete e[n],l(N[n],t)):c(t)}),_.each(e,function(e){I.annots.add(e).then(function(t){l(e,t.annotation)},s)})},_.noop)}function v(){var e=X.get().sync_collection_id||j.get().id;return sprintf("/%s/collections/%s/items/%s",S.get(),e,I.item.id())}function w(){var e=null,t=_.once(m);I.item.get().finally(function(){I.item.id()||t(),I.item.onAdd(function(){g(_.clone(N)).then(t),e=P.subscribe(v(),function(){g()})}),I.item.onRemove(function(){e&&e.cancel()})})}function b(){return E.clone(N)}function y(){return E.hashToArray(N)}function k(e){return c(e,!0),I.annots.add(e).then(function(t){l(e,t.annotation)},s)}function x(e){var t=E.objDiff(N[e.id],e);return _.isEmpty(t)?Promise.resolve({status:"ok"}):(l(N[e.id],e,!0),I.annots.update(e.id,t).then(function(t){l(e,t.annotation)},function(t){404==t.status?u(e.id):s(t)}))}function C(e){return u(e,!0),I.annots.remove(e).catch(_.noop)}function T(){return Y.writableUrl().then(function(e){return new Promise(function(t){Y.write(e.url,{user_data:{modified:E.dateISO(),annotations:_.toArray(N)}}).then(function(){t(e.id)},_.noop)})})}function A(e){_.each(e,function(e){c(e),I.annots.add(e).then(function(t){l(e,t.annotation)},_.noop)})}var E=e("../utils/util"),j=e("../user"),S=e("../environment"),X=e("../article"),Y=e("../s3_storage"),I=e("../sync/sync"),P=e("../sync/faye_client"),R={},N={};X.onInit(w),R.list=b,R.listArr=y,R.addItem=k,R.updateItem=x,R.removeItem=C,R.writeShared=T,t.exports=R},{"../article":87,"../environment":96,"../s3_storage":115,"../sync/faye_client":117,"../sync/sync":119,"../user":128,"../utils/util":143}],83:[function(e,t,n){var i=e("../elements/popover"),s=function(){};s.prototype={_init:function(e,t){this._elem=$("#"+e).clone(),this._elem.removeAttr("id").addClass(t),this._initEvents()},_initEvents:function(){},_open:function(e,t){this._anchor=e,i.open({placement:"up",content:this._elem,anchor:this._anchor,klass:t})},open:function(e,t){this._open(e||this._anchor,t)},close:function(){i.close(this._anchor)},isOpen:function(){return i.isOpen(this._anchor)},destroy:function(){this.close(),this._elem.remove(),this._elem=null,this._anchor=null}},t.exports=s},{"../elements/popover":94}],84:[function(e,t,n){var i=e("./base_toolbar"),s=function(e){this.selection=e,this._init("resolve-toolbar","resolve")};s.prototype=$.extend(new i,{_initEvents:function(){var e=this;this._elem.find(".row").click(function(){e.close(),$(e).trigger("marked",[{type:$(this).attr("type").toLowerCase(),text:e.selection.getRangeAndClear().text().replace(/(?:\r?\n|\r)+/g," ")}])}),$(this.selection).on("set-selection",function(){e.open(e.selection.getElems().first())}).on("clear-selection",$.proxy(this.close,this))},destroy:function(){i.prototype.destroy.apply(this),this.selection=null}}),t.exports=s},{"./base_toolbar":83}],85:[function(e,t,n){function i(e,t){function n(){var e=p.commonAncestorContainer;return e.nodeType==Node.TEXT_NODE&&(e=e.parentNode.parentNode),$(e).find("."+h)}function i(e){try{e.removeAllRanges()}catch(e){}}function o(){r.remove(u),n().removeClass(h),i(rangy.getSelection()),$(u).trigger("clear-selection")}function a(){var e=rangy.getSelection(),n=e.getAllRanges()[0];return t(n)?(d=s.guid(),p=n,f.applyToRange(p),e.setSingleRange(p),r.add(u),$(u).trigger("set-selection"),!0):(i(e),!1)}function c(){var t=rangy.getSelection();return!t.isCollapsed&&(!!$.contains(e[0],t.anchorNode)&&!!$.contains(e[0],t.focusNode))}function l(){$(document).on("mousedown.selection",function(t){1==t.which&&(c()&&o(),e.one("mouseup.selection",function(t){if(1==t.which)return c()&&a()?(e.one("click.selection",!1),!1):void 0}))})}e=e||$(document.body),t=t||function(){return!0};var u={},d=null,h="current-selection",p=rangy.createRange(),f=rangy.createClassApplier(h);return l(),u.clear=function(){return o()},u.getRange=function(){return p.cloneRange()},u.getRangeAndClear=function(){var e=p.cloneRange();return o(),e},u.getElems=function(){return n()},u.getKlass=function(){return h},u.getId=function(){return d},u}var s=e("../utils/util"),r=e("../input_handler");t.exports=i},{"../input_handler":111,"../utils/util":143}],86:[function(e,t,n){var i=e("./base_toolbar"),s=function(e){this.selection=e,this._init("annotations-base-toolbar","selection")};s.prototype=$.extend(new i,{_initEvents:function(){var e=this;this._elem.find(".add-note").click(function(){$(e).trigger("add-note")}),this._elem.find(".annot-colors .sample").click(function(t){$(e).trigger("highlight",[$(this).data("colorid")])}),$(this.selection).on("set-selection",function(){e.selection.getRange().text()&&e.open(e.selection.getElems().first())}).on("clear-selection",$.proxy(this.close,this))},destroy:function(){i.prototype.destroy.apply(this),this.selection=null}}),t.exports=s},{"./base_toolbar":83}],87:[function(e,t,n){function i(){var e=new Date,t=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());return t+47*ae.hrs+_.random(ae.hrs-1)}function s(){return ee.clone(de)}function r(){return pe}function o(){return!!le.sync_item_id}function a(){return le.sync_item_sponsored}function c(){return!o()||a()}function l(){return/(?:sharing|referrer|author)_token/.test(le.access_method)}function u(){return l()&&le.access_method.replace("_token","").replace("sharing","shared")}function d(){return l()&&he[u()+"_access_token"];
}function h(){return!!he.feed_token}function p(){return ee.merge(de,he,_.pick(le,"doi","hash"),{st:ee.readcube("st")})}function f(){return ee.addParams(te.services+"/reader/basic_data",p())}function m(){return ee.addParams(te.services+"/reader/article_data",ee.merge(le.options,p()))}function g(e){return ee.addParams(te.services+"/articles/metrics",ee.merge({doi:le.doi,scroll:1,size:30},e))}function v(){return te.services+"/reader/pages"}function w(){return ee.addParams(te.services+"/reader/related",p())}function b(e){return ue=ee.merge(ue,le.options,e,p()),ee.referrerHost()&&(ue.referrer=ee.referrerHost()),ue}function y(e,t){return function(n){n.error?t(n):e(n)}}function k(e){return function(t){403==t.status&&$(ce).trigger("access-forbidden"),e(t.responseJSON||t.responseText||"unknown error")}}function x(e){return e.error||e.stylesheet||e.png}function C(){return new Promise(function(e,t){var n=ee.clone(re);x(n)?y(e,t)(n):$.ajax(ee.merge(ge,{url:f(),dataType:"json",success:y(e,t),error:k(t)}))})}function T(){return new Promise(function(e,t){$.ajax(ee.merge(ge,{url:m(),dataType:"json",success:e,error:k(t)}))})}function A(e){return new Promise(function(t,n){$.ajax(ee.merge(ge,{url:g(e),dataType:"json",success:t,error:k(n)}))})}function E(e,t){return new Promise(function(n,i){$.ajax(ee.merge(ge,{url:e,type:"POST",contentType:"application/json; charset=UTF-8",dataType:"json",data:JSON.stringify(b(t)),success:n,error:k(i)}))})}function j(){return new Promise(function(e){j.data?e(j.data):$.ajax(ee.merge(ge,{url:w(),dataType:"json",success:function(t){e(j.data=t)}}))})}function S(){return _.has(le,"access")}function X(e){return E(v(),e)}function Y(e){return e=e.toLowerCase(),e.indexOf("video")!=-1?"video":0==e.indexOf("vnd.")?e.indexOf("word")!=-1?"doc":e.indexOf("excel")!=-1||e.indexOf("sheet")!=-1?"xls":e.indexOf("powerpoint")!=-1||e.indexOf("presentation")!=-1?"ppt":"type":e}function I(e,t){return e.index=t,e.caption=e.caption||"Supplement "+(t+1),e.type=Y(e.type),e}function P(e){return"wiley"==le.publisher?e.badge=e.label||e.ordinal:e.badge=e.ordinal||e.label,e}function R(e){return e.meta=e.meta||{},e.figures=e.figures||[],e.citations=e.citations||[],le.cover&&e.citations.unshift([]),e.references=_(e.references||[]).map(P),e.supplements=_(e.supplements||[]).map(I),te.parent&&he.publisher&&(e.meta.publisher=he.publisher,"wiley"==he.publisher&&(e.meta.url=sprintf("http://onlinelibrary.wiley.com/doi/%s/abstract",le.doi),e.meta.pdf_url=sprintf("http://onlinelibrary.wiley.com/doi/%s/pdf",le.doi))),"wiley"!=le.publisher&&0!=parseFloat(e.meta.rcr)||delete e.meta.rcr,e}function N(){ie.remove(me),me=ie.add(function(){$(ce).trigger("resources-expired")},i())}function O(e){return le=ee.merge(le,e),te.parent&&he.publisher&&(le.publisher=he.publisher),le.stylesheet_linked=!!re.stylesheet,le.yield_thumb=function(t){return"https://images.readcube-cdn.com/prerendered/"+e.hash+"/"+ ++t+".jpg"},N(),$(ce).trigger("initialized",[L()]),le}function D(e){return le=ee.merge(le,R(e)),$(ce).trigger("data",[L()]),le}function F(e){return le=ee.merge(le,e),le.share_type=u(),le.share_token=d(),$(ce).trigger("access-check",[L()]),U()&&(N(),$(ce).trigger("access",[L()])),le}function M(){return U()&&le.pdf_url}function L(){return ee.clone(le)}function U(){return le.access}function z(e){return X(e).then(F)}function B(e){return E(te.services+"/reader/generate_shared_access",e)}function H(e){le.meta?e(L()):$(ce).one("data",function(t,n){e(n)})}function W(e){U()?e(L()):$(ce).one("access",function(t,n){e(n)})}function q(e){S()&&e(L()),$(ce).on("access-check",function(t,n){e(n)})}function V(e){S()?e(L()):$(ce).one("access-check",function(t,n){e(n)})}function J(){if(!le.meta||!le.meta.url||"ieee"==le.publisher)return sprintf("%s/%s",te.dx_doi,le.doi);var e=(le.meta.url||"").replace("#","%23");return ne(le.publisher)?e.replace(parseUri(e).host,ne(le.publisher)):e}function Q(e){_.isEmpty(le)?$(ce).one("initialized",function(t,n){e(n)}):e(L())}function G(e){return fe?fe:(pe="supplement",fe=se.init(e),fe.then(O),fe)}function K(){return se.update().then(O)}function Z(e,t){return fe?fe:(de=e||{},he=t||{},oe&&(he.mobile=1),fe=C(),fe.then(O).then(function(e){e.meta?D(e):T().then(D)}),fe)}var ee=e("./utils/util"),te=e("./endpoint"),ne=e("./proxy_host"),ie=e("./utils/alarm_clock"),se=e("./supplement"),re=(e("./environment"),window.readcube||{}),oe=e("./utils/mobile_detect").any,ae={sec:1e3,min:6e4,hrs:36e5},ce={},le={},ue={},de={},he={},pe="article",fe=null,me=null,ge={crossDomain:!0,xhrFields:{withCredentials:!0}};ce.init=Z,ce.initSupplement=G,ce.updateSupplement=K,ce.onInit=Q,ce.get=L,ce.getIds=s,ce.getType=r,ce.hasAccess=U,ce.hasFullAccess=M,ce.checkAccessWith=z,ce.generateSharedAccess=B,ce.getMetrics=A,ce.onData=H,ce.onAccess=W,ce.onAccessCheck=q,ce.onceAccessChecked=V,ce.getRelated=j,ce.isPersonal=o,ce.isSponsored=a,ce.isBrandable=c,ce.isShared=l,ce.isFeed=h,ce.getProxiedUrl=J,window.article=ce,t.exports=ce},{"./endpoint":95,"./environment":96,"./proxy_host":112,"./supplement":116,"./utils/alarm_clock":130,"./utils/mobile_detect":135,"./utils/util":143}],88:[function(e,t,n){function i(){return l.getPageObj(1)}function s(){var e=i();if(e){var t=e.getWidth()*e.getScale(),n=e.getMargin()*e.getScale(),s=t/d.data("original-width"),r=d.data("original-height")*s,o=d.data("bg-original-width"),a=d.data("bg-original-height")*s;d.css({width:t,height:r,margin:n+"px auto","background-size":o+"px "+a+"px"}),d.find("img").each(function(){var e=$(this),n=e.data("original-height")*s,i=e.data("original-width")*s,o=1;i>r&&(o=r/i),n*o>t&&(o=t/n),e.css("height",i*o)})}}function r(e){d=e,d.data("original-width",d.width()),d.data("original-height",d.height()),c.onData(function(e){c.isPersonal()&&!c.get().sync_item_sponsored||o(e.banner)})}function o(e){e&&(e.url&&d.click(function(){window.open(e.url,"_blank")}),a(e.background,function(t){function n(e){$(e).attr("role","presentation").appendTo(d)}d.css("background-image",'url("'+e.background+'")').show(),d.data("bg-original-width",$(t).data("original-width")),d.data("bg-original-height",$(t).data("original-height")),s(),a(e.left,function(e){e.className="left",n(e),s()}),a(e.center,function(e){e.className="center",n(e),s()}),a(e.right,function(e){e.className="right",n(e),s()})}),$(l).on("scale",s),l.onInit(s))}function a(e,t){var n=new Image;n.onload=function(){$(n).data("original-width",n.width),$(n).data("original-height",n.height),t(n)},n.src=e}var c=e("./article"),l=e("./viewer/viewer"),u={},d=null;u.init=r,t.exports=u},{"./article":87,"./viewer/viewer":151}],89:[function(e,t,n){function i(e,t){var n=[];e.indexOf("'",1)!=-1&&(e=e.replace(/\'$/,""),n.push(e)),e.indexOf("",1)!=-1&&(e=e.replace(/\/,""),n.push(e)),n.push(e.replace(" "," "));for(var i=1;i<e.length-2;i++)n.push(e.substring(0,i)+e.substring(i,e.length).replace(/(.{1})/,"$1-"));return n.push(".",".",""),t.match(/^\s*\d{1}\s*$/)||n.push(""),n}function s(e){for(var t=[],n=1;n<e.length-2;n++)t.push(e.substring(0,n)+e.substring(n,e.length).replace(/(.{1})/,"$1-"));return t}var r=e("../utils/util"),o=e("../utils/range_serializer"),a=function(e,t,n){this.klass="enhanced-"+t.type,this.id=r.guid(),this.page=e,this.data=t,this.range=n,this.elems=null,this.klassApp=null,this.idApp=null,this._init()};a.prototype={_init:function(){this.klassApp=rangy.createClassApplier(this.klass),this.idApp=rangy.createClassApplier(this.id),this.klassApp.applyToRange(this.range),this.idApp.applyToRange(this.range),this.elems=r.getElems(this.range,this.id),this.elems.closest("div.t").addClass("citation-container")},getElems:function(){return this.elems},getId:function(){return this.id},getKlass:function(){return this.klass},getType:function(){return this.data.type},getData:function(){return r.clone(this.data)},getRange:function(){return this.range.cloneRange()},getPage:function(){return this.page},destroy:function(){this.klassApp.undoToRange(this.range),this.idApp.undoToRange(this.range),this.klassApp=null,this.idApp=null,this.range=null,this.elems=null,this.data=null}},a.deserialize=function(e,t,n){var c=null,l={container:e.getElem(),matchFilter:n,matchWeirdCitations:!0,matchTranslits:"author"==t.type,matchCase:"author"==t.type};if(!c&&t.text.match(/^\d{4}$/)&&(c=o.deserialize({prefix:t.prefix.split(/\(|\[|;/g).pop().trim(),text:t.text},r.merge(l,{matchTranslits:!1}))),c||(c=o.deserialize({prefix:t.prefix.split(/\s+|\n/).pop(),text:t.text},l)),!c&&t.text.match(/\d+\s+-\s+\d+/)&&(c=o.deserialize({prefix:t.prefix,text:t.text.replace(/\s+-\s+/g," - - ")},l)),c||(c=o.deserialize({prefix:t.prefix.replace(/(;)/g," $1 "),text:t.text.replace(/(\d+|[a-zA-Z\.]+|,|;)/g," $1 ")},l)),c||(c=o.deserialize(t,r.merge(l,{matchBrokenTxt:!0}))),c||(c=o.deserialize(t,r.merge(l,{insertWhitespace:!0}))),c||"author"!=t.type||(c=o.deserialize(t,r.merge(l,{removeDiacritics:!0}))),c||"author"!=t.type||(c=o.deserialize(t,r.merge(l,{removeDiacritics:!0,matchCase:!1}))),c||(c=o.deserialize(t,r.merge(l,{matchTranslits:!1,matchMisconverted:!0}))),c||(c=o.deserialize(t,r.merge(l,{matchTranslits:!1,matchBrokenSpaces:!0}))),c||(c=o.deserialize(t,r.merge(l,{matchTranslits:!1,matchBrokenDigits:!0}))),!c&&t.prefix.length)for(var u=i(t.prefix,t.text),d=0;d<u.length&&!(c=o.deserialize({prefix:u[d],text:t.text},l));d++);if(!c&&!t.text.match(/^\s*\d{1}\s*$/))for(var u=s(t.text),d=0;d<u.length&&!(c=o.deserialize({prefix:t.prefix,text:u[d]},l));d++);return c?new a(e,t,c):(l.container.children().length&&r.log("* missed citation: ["+t.prefix+"]["+t.text+"]"),null)},t.exports=a},{"../utils/range_serializer":137,"../utils/util":143}],90:[function(e,t,n){function i(e){if("reference"!=e.getType())return!1;var t=e.getData().text;return t=t.replace(/[\s\[\]\(\)]/g,""),t=t.replace(/[-]/g,","),/^(\d{1,3},)*\d{1,3}$/.test(t)}function s(e){return i(e)?"enhanced-rectangle-draw":"enhanced-underline-draw"}function r(e){e.getElem().addClass("animate-enhanced show-enhanced")}function o(e){e.getElem().removeClass("show-enhanced"),setTimeout(function(){e.getElem().removeClass("animate-enhanced")},1e3)}function a(){var e=h.getPageObj(h.getPage());return!(!e||!e.hasText())&&(r(e),setTimeout(function(){o(e)},1e3),!0)}function c(e){m[e.getId()]=e;var t=s(e),n=e.getElems().filter(function(){return!!this.textContent});d.hasTransparentText(n)&&(t+=" transparent"),n.addClass(t),"author"==e.getType()?n.filter(function(){return p.detectGlyph(this.textContent.trim())}).addClass("diacritic"):n.length>1&&n.each(function(e){0==e?$(this).addClass("leftmost"):e==n.length-1?$(this).addClass("rightmost"):$(this).addClass("middle")}),n.on({"mouseenter.citation-drawer":function(){n.addClass("hover")},"mouseleave.citation-drawer":function(){n.removeClass("hover")},"open.popover.citation-drawer":function(){n.addClass("active")},"close.popover.citation-drawer":function(){n.removeClass("active")}})}function l(e){var t=s(e),n=e.getElems();n.off(["mouseenter.citation-drawer","mouseleave.citation-drawer","open.popover.citation-drawer","close.popover.citation-drawer"].join(" ")),n.removeClass(t+" transparent diacritic leftmost middle rightmost"),delete m[e.getId()]}function u(){_.each(_.keys(m),function(e){l(m[e])})}var d=e("../utils/util"),h=e("../viewer/viewer"),p=e("../utils/diacritics"),f={},m={};f.add=c,f.remove=l,f.showAll=r,f.hideAll=o,f.animateAll=a,f.removeAll=u,t.exports=f},{"../utils/diacritics":133,"../utils/util":143,"../viewer/viewer":151}],91:[function(e,t,n){function i(e){var t=e.getId();k[t]=e,w.add(e),_.add(e),$(y).trigger("add",[e])}function s(e){return[e.startNode.textContent,e.startNodeIndex.toString(),e.endNode.textContent,e.endNodeIndex.toString()].join("-")}function r(e){return[e.startContainer.textContent,e.startOffset.toString(),e.endContainer.textContent,e.endOffset.toString()].join("-")}function o(e,t){var n=t.getRange(),i=[e,r(n)].join(":");x[i]||(x[i]=[]),x[i].push(n)}function a(e){var t=rangy.createRange();return t.setStart(e.startNode,e.startNodeIndex),t.setEnd(e.endNode,e.endNodeIndex),t}function c(e,t){return!!t.startContainer.isEqualNode(e.startNode)&&(!!t.endContainer.isEqualNode(e.endNode)&&t.equals(a(e)))}function l(e){return function(t){var n=[e,s(t)].join(":");if(!x[n])return!0;for(var i=0;i<x[n].length;i++)if(c(t,x[n][i]))return!1;return!0}}function u(e){var t=[];return"nature"==j&&t.push({provider:"NPG Journals",url:"https://www.nature.com/search?"+$.param({author_match:"all",author:e.standard_name})}),t.concat([{provider:"PubMed",url:"http://www.ncbi.nlm.nih.gov/pubmed/?"+$.param({term:e.standard_name+"[Author]"})},{provider:"Google Scholar",url:"http://scholar.google.com/scholar?"+$.param({as_q:"",as_sauthors:e.text})}])}function d(e,t){var n=A[e-1][t],s=v.getPageObj(e);"author"==n.type&&(n=g.merge(n,{search:u(n)})),"figure"==n.type?n.figures=$.map(n.ids,function(e){return T[e-1]}):n.references=$.map(n.ids,function(e){return E[e-1]});var r=b.deserialize(s,n,l(e));r&&(o(e,r),i(r))}function h(e,t){if(!C[e]&&t.hasText()&&A[e-1]){for(var n=g.timer.tic(),i=0;i<A[e-1].length;i++)d(e,i);g.log("citations("+e+") duration: "+g.timer.toc(n)+"ms"),C[e]=!0}}function p(e){T=e.figures,A=e.citations,E=e.references,j=e.publisher,v.onInit(function(){v.eachPage(h)}),$(v).on("page-loaded.citations-model",function(e,t){h(t,v.getPageObj(t))})}function f(e){for(var t in k)if(!1===e(k[t]))break}function m(){return g.clone(k)}var g=e("../utils/util"),v=e("../viewer/viewer"),w=e("../input_handler"),_=e("./citation_drawer"),b=e("./citation"),y={},k={},x={},C={},T=null,A=null,E=null,j=null;y.init=p,y.forEach=f,y.getAll=m,t.exports=y},{"../input_handler":111,"../utils/util":143,"../viewer/viewer":151,"./citation":89,"./citation_drawer":90}],92:[function(e,t,n){var i=e("./environment"),s=e("./sync/faye_client"),r={};s.subscribe(sprintf("/%s/web_reader",i.get()),function(e){if(e&&e.command){var t=e.command.split(":");$(r).trigger(t[0],[t.pop()])}}),t.exports=r},{"./environment":96,"./sync/faye_client":117}],93:[function(e,t,n){function i(){return d.readcube("mobile_browser_supported")}function s(){return"WebkitAppearance"in document.documentElement.style}function r(){return"safari"==h.name&&"win"==h.os}function o(){return"safari"==h.name&&h.versionNumber<6}function a(){return"chrome"==h.name&&h.versionNumber<29}function c(){return"firefox"==h.name&&h.versionNumber<17}function l(){if(p.any&&!i())return d.log("browser is mobile"),{result:!1,message:"mobile_browser"};if(d.readcube("browser_bot"))return{result:!0,message:"bot"};for(var e=0;e<m.length;e++){var t=m[e];if("string"!=typeof t){for(var n=!1,l=0;l<t.length;l++)if(Modernizr[t[l]]){n=!0;break}if(!n)return d.log("browser does not support "+t.join(" or ")),{result:!1,message:"old_browser"}}else if(!Modernizr[t])return d.log("browser does not support "+t),{result:!1,message:"old_browser"}}return s()||f()?c()||a()||o()||r()?(d.log("browser is outdated"),{result:!1,message:"old_browser"}):{result:!0,message:"ok"}:(d.log("browser does not support subpixel font rendering"),{result:!1,message:"font_fail"})}function u(){return u.retval?u.retval:u.retval=l()}var d=e("./utils/util"),h=e("./utils/browser"),p=e("./utils/mobile_detect"),f=e("./utils/subpixelfont_test"),m=(e("./environment"),[["flexbox","flexboxlegacy"],"fontface","backgroundsize","borderradius","boxshadow","opacity","rgba","textshadow","cssgradients","csstransforms","csstransitions","hashchange","history","video","postmessage","svg"]);t.exports=u},{"./environment":96,"./utils/browser":131,"./utils/mobile_detect":135,"./utils/subpixelfont_test":140,"./utils/util":143}],94:[function(e,t,n){function i(e){return{width:e[0].offsetWidth,height:e[0].offsetHeight}}function s(e){if(document.body.contains(e[0]))return i(e);e=e.clone(),k.append(e).appendTo(document.body);var t=i(e);return e.remove(),k.detach(),t}function r(e){function t(){v.removeClass("up down left right"),v.css({top:"",left:""}),y.css({top:"",left:""})}function n(){t(),v.addClass("up"),X=s(b),v.css({top:I.top-R-Y.height-X.height-h.top,left:P.x-N-Y.width/2});var e=u.getBoundingRect(y);return Math.max(0,S.top-(e.top-d.top))}function i(){t(),v.addClass("down"),X=s(b),v.css({top:I.bottom-R+X.height+h.bottom,left:P.x-N-Y.width/2});var e=u.getBoundingRect(y);return Math.max(0,e.bottom+d.bottom-S.bottom)}function r(){t(),v.addClass("left"),X=s(b),v.css({top:P.y-R-Y.height/2,left:I.left-N-Y.width-X.width-h.left});var e=u.getBoundingRect(y);return Math.max(0,S.left-(e.left-d.left))}function a(){t(),v.addClass("right"),X=s(b),v.css({top:P.y-R-Y.height/2,left:I.right-N+X.width+h.right});var e=u.getBoundingRect(y);return Math.max(0,e.right+d.right-S.right)}function l(e){var t=[],s=[n,i],r="up"==e?0:1;(t[r]=s[r]())&&(t[1-r]=s[1-r]())&&(t[r]<=t[1-r]?s[r]():s[1-r]())}function k(e){var t=[],n=[r,a],i="left"==e?0:1;(t[i]=n[i]())&&(t[1-i]=n[1-i]())&&(t[i]<=t[1-i]?n[i]():n[1-i]())}function x(e){var t=e.left>0,n=e.right>0;return n&&t?e.left>=e.right?"right":"left":n?"left":t?"right":null}function C(e){var t=e.top>0,n=e.bottom>0;return n&&t?e.top>=e.bottom?"bottom":"top":n?"top":t?"bottom":null}function T(){var e=u.getBoundingRect(y),t={left:S.left-e.left+d.left,right:e.right-S.right+d.right},n=x(t);"left"==n&&y.css("left",Math.max(-(Y.width/2)+X.width,-t.right)),"right"==n&&y.css("left",Math.min(Y.width/2-X.width,t.left))}function A(){var e=u.getBoundingRect(y),t={top:S.top-e.top+d.top,bottom:e.bottom-S.bottom+d.bottom},n=C(t);"top"==n&&y.css("top",Math.max(-(Y.height/2)+X.height,-t.bottom)),"bottom"==n&&y.css("top",Math.min(Y.height/2-X.height,t.top))}function E(){switch(t(),j=g.offset(),S=u.getBoundingRect(g),Y=s(m),I=u.getBoundingRect(f),P={x:(I.left+I.right)/2,y:(I.top+I.bottom)/2},R=j.top-g.scrollTop(),N=j.left-g.scrollLeft(),e.placement){case"up":case"down":l(e.placement),T();break;case"left":case"right":k(e.placement),A()}}c()&&o(),f=e.anchor,m=e.content,g=u.scrollParent(f);var j=null,S=null,X=null,Y=null,I=null,P=null,R=null,N=null;y.removeClass(),y.addClass("container"),e.klass&&y.addClass(e.klass),y.children().detach(),y.append(m),v.appendTo(g),v.css({visibility:"hidden",display:"block"}),E(),w=function(){c()&&E()},$(window).on("resize.popover",_.throttle(w,50)),$(document).one("mouseup.popover touchstart.popover",function(e){$.contains(f[0],e.target)||o()}),v.css("visibility","visible"),f.trigger("open.popover"),$(p).trigger("open-popover")}function o(e){return!!c(e)&&($(window).off(".popover"),$(document).off(".popover"),v.css({visibility:"hidden",display:"none"}),f.trigger("close.popover"),$(p).trigger("close-popover"),m=null,f=null,g=null,!0)}function a(){w()}function c(e){return!!f&&(!e||e.is(f))}function l(e){o(e.anchor)||r(e)}var u=e("../utils/util"),d={top:42,right:20,bottom:0,left:20},h={top:7,right:2,bottom:2,left:2},p={},f=null,m=null,g=null,v=$(['<div class="popover">','<div class="container"></div>','<div class="arrow"></div>',"</div>"].join("")),w=function(){};v.on("mousedown mouseup click touchstart touchend",function(e){e.stopImmediatePropagation()});var b=v.find(".arrow"),y=v.find(".container"),k=$("<div></div>").css({position:"absolute",visibility:"hidden"});p.open=r,p.close=o,p.update=a,p.toggle=l,p.isOpen=c,t.exports=p},{"../utils/util":143}],95:[function(e,t,n){var i=e("./environment"),s=e("./utils/util"),r="https:"==document.location.protocol?"https:":"http:",o=parseUri(location.href).queryKey.parent_url;o&&(o=decodeURIComponent(o));var a={production:"https://reader.readcube.com",staging:"https://reader-staging.readcube.com",development:r+"//local.readcube.com:5000"}[i.get()],c=s.merge({parent:o,dx_doi:"https://doi.org",ip_api:"http://ip-api.com/json",altmetric:"https://api.altmetric.com",authors_springernature:"http://authors.springernature.com",chrome_extension:"https://chrome.google.com/webstore/detail/readcube-web-importer/mfacblegickmnfpaebakfnlbfhpoegin",mobile_apps:{ios:"https://itunes.apple.com/us/app/readcube/id864042981?ls=1&amp;mt=8",android:"https://play.google.com/store/apps/details?id=com.readcube.mobile"},scripts:{easeljs:"https://code.createjs.com/easeljs-0.8.1.min.js",tweenjs:"https://code.createjs.com/tweenjs-0.6.1.min.js",movieclip:"https://code.createjs.com/movieclip-0.8.1.min.js",cpgadget:"https://www.google.com/cloudprint/client/cpgadget.js",videojs:"https://vjs.zencdn.net/5.8.0/video.min.js",pdfjs:a+"/scripts/pdfjs/pdf.1d425203.js",pdfjs_worker:a+"/scripts/pdfjs/pdf.worker.38593b5d.js"},stylesheets:{videojs:"https://vjs.zencdn.net/5.8.0/video-js.min.css"},jsonp_access:{wiley:"http://onlinelibrary.wiley.com/readcube",iucr:"http://onlinelibrary.wiley.com/readcube",kluwer:"http://journals.lww.com/readcubeaccess.rpdf/access",asha:"http://pubs.asha.org/services/ResourceAccessCheck.svc/CheckAccess"}},{production:{reader:r+"//www.readcube.com/articles",web:"https://www.readcube.com",app:"https://app.readcube.com",sync:"https://sync.readcube.com",analytics:"https://analytics.readcube.com",services:"https://services.readcube.com",push:"https://push.readcube.com/bayeux",version:"https://s3.amazonaws.com/reader.readcube.com/version.json"},staging:{reader:r+"//staging.readcube.com/articles",web:"https://staging.readcube.com",app:"https://app-staging.readcube.com",sync:"https://sync-staging.readcube.com",analytics:"https://analytics-staging.readcube.com",services:"https://services-staging.readcube.com",push:"https://push.readcube.com/bayeux",version:"https://s3.amazonaws.com/reader-staging.readcube.com/version.json"},development:{reader:r+"//local.readcube.com:3000/articles",web:r+"//local.readcube.com:3000",app:r+"//local.readcube.com:4000",sync:r+"//local.readcube.com:3003",analytics:r+"//local.readcube.com:3004",services:r+"//local.readcube.com:3001",push:r+"//local.readcube.com:8000/bayeux",version:"/version.b6c2a6c7.json"}}[i.get()]);window.endpoint=c,t.exports=c},{"./environment":96,"./utils/util":143}],96:[function(e,t,n){function i(e){return e.toLowerCase()==u}function s(){return u}function r(){return i("development")}function o(){return i("staging")}function a(){return i("production")}function c(){/(staging|test)\.readcube\.com/i.test(location.hostname)?u="staging":/local\.readcube\.com/i.test(location.hostname)&&(u="development")}var l={},u="production";c(),l.is=i,l.get=s,l.staging=o,l.production=a,l.development=r,t.exports=l},{}],97:[function(e,t,n){function i(e){return _.map(e||[],a.authorName).join(" and ")}function s(e){if(e)return e.replace("-","--")}function r(e,t){var n={author:i(e.authors),year:e.year,title:e.title,journal:e.journal,publisher:a.publisherName(e.publisher),issn:e.issn,doi:e.doi,volume:e.volume,month:e.month,pages:s(e.pagination),number:e.issue};return a.articleUrl()&&(n.url=a.articleUrl()),t&&(n.abstract=e.abstract),n}function o(e,t){var n=a.LINE_END,i=["@article{"+a.getKey(e)];return _.each(r(e,t),function(e,t){(e||0===e)&&i.push(sprintf("  %s = {%s}",t,e))}),i.join(","+n)+n+"}"+n}var a=e("./helper");t.exports=o},{"./helper":99}],98:[function(e,t,n){var i=e("./helper"),s=e("./bibtex"),r=e("./ris");t.exports={getKey:i.getKey,bib:s,ris:r}},{"./bibtex":97,"./helper":99,"./ris":100}],99:[function(e,t,n){function i(e){return{nature:"Nature Publishing Group",wiley:"Wiley Online Library"}[e]}function s(e){var t=e.name||e,n=t.split(" ");return 1==n.length?n[0]:n.pop()+", "+n.join(" ")}function r(){return a.get().meta.url?sprintf("http:%s/%s",c.dx_doi,a.get().doi):null}function o(e){try{return[e.authors[0].name.split(/[\s]+/).pop(),e.year,e.title.split(/[,\.\s]+/)[0]].join("").toLowerCase()}catch(e){return a.get().doi.replace(/[\W]+/g,"")}}var a=e("../article"),c=e("../endpoint"),l=e("../utils/browser"),u="win"==l.platform?"\r\n":"\n";t.exports={LINE_END:u,publisherName:i,authorName:s,articleUrl:r,getKey:o}},{"../article":87,"../endpoint":95,"../utils/browser":131}],100:[function(e,t,n){function i(e,t){if(t||0===t)return sprintf("%s  - %s",e,t)}function s(e,t){if(e)return e.split("-")[t]}function r(e,t){var n=[i("TY","JOUR")];return n.push(i("T1",e.title)),_.each(e.authors,function(e){n.push(i("AU",o.authorName(e)))}),n.push(i("DO",e.doi)),n.push(i("JO",e.journal)),n.push(i("VL",e.volume)),n.push(i("IS",e.issue)),n.push(i("SP",s(e.pagination,0))),n.push(i("EP",s(e.pagination,1))),n.push(i("SN",e.issn)),o.articleUrl()&&n.push(i("UR",o.articleUrl())),n.push(i("Y1",e.year)),n.push(i("PB",o.publisherName(e.publisher))),t&&n.push(i("AB",e.abstract)),n.push("ER  - "+o.LINE_END),_.compact(n).join(o.LINE_END)}var o=e("./helper");t.exports=r},{"./helper":99}],101:[function(e,t,n){var i=e("../environment"),s="UA-19582843-2",r="4587af51bbb542afbbc9d93bf9567159",o="190e62ffe743e9fc44da8419f01ade8f",a="H9jSrH2fJST0D33BtNfyOA",c={production:"c940ea0703828ead4745629146c021da",staging:"bf6138a7d35159129ccf0117fef1ce95",development:"bf6138a7d35159129ccf0117fef1ce95"}[i.get()];t.exports={ga:s,trackjs:r,altmetric:o,uservoice:a,mixpanel:c}},{"../environment":96}],102:[function(e,t,n){var i=["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"].join(" ");t.exports={transition_end:i}},{}],103:[function(e,t,n){!function(e,t,n,i,s,r,o){e.GoogleAnalyticsObject=s,e[s]=e[s]||function(){(e[s].q=e[s].q||[]).push(arguments)},e[s].l=1*new Date,r=t.createElement(n),o=t.getElementsByTagName(n)[0],r.async=1,r.src=i,o.parentNode.insertBefore(r,o)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga")},{}],104:[function(e,t,n){var i=i||{};i.cmd=i.cmd||[],function(){var e=document.createElement("script");e.async=!0,e.type="text/javascript";var t="https:"==document.location.protocol;e.src=(t?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}(),t.exports=i},{}],105:[function(e,t,n){function i(){if("undefined"==typeof ga)return e("./ga"),r.signedIn()?(ga("create",s.ga,{userId:r.get().id}),ga("set","dimension1",r.get().id)):(ga("create",s.ga,"auto"),ga("set","dimension1","Anonymous")),ga}var s=e("./api_keys"),r=e("../user");t.exports=i},{"../user":128,"./api_keys":101,"./ga":103}],106:[function(e,t,n){function i(){if("undefined"==typeof mixpanel)return e("./mixpanel"),mixpanel.init(s.mixpanel,{track_pageview:!1}),o.signedIn()?mixpanel.identify(o.get().id):mixpanel.identify(r.get()),mixpanel}var s=e("./api_keys"),r=e("../tracking/track_id"),o=e("../user");t.exports=i},{"../tracking/track_id":125,"../user":128,"./api_keys":101,"./mixpanel":108}],107:[function(e,t,n){function i(){return new Promise(function(e){function t(){PDFJS.workerSrc=r.scripts.pdfjs_worker,e(PDFJS)}window.PDFJS?t():s.loadScript(r.scripts.pdfjs,t)})}var s=e("../utils/util"),r=e("../endpoint");t.exports=i},{"../endpoint":95,"../utils/util":143}],108:[function(e,t,n){!function(e,t){if(!t.__SV){var n,i,s,r;window.mixpanel=t,t._i=[],t.init=function(e,n,i){function o(e,t){var n=t.split(".");2==n.length&&(e=e[n[0]],t=n[1]),e[t]=function(){e.push([t].concat(Array.prototype.slice.call(arguments,0)))}}var a=t;for("undefined"!=typeof i?a=t[i]=[]:i="mixpanel",a.people=a.people||[],a.toString=function(e){var t="mixpanel";return"mixpanel"!==i&&(t+="."+i),e||(t+=" (stub)"),t},a.people.toString=function(){return a.toString(1)+".people (stub)"},s="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" "),r=0;r<s.length;r++)o(a,s[r]);t._i.push([e,n,i])},t.__SV=1.2,n=e.createElement("script"),n.type="text/javascript",n.async=!0,n.src="undefined"!=typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js",i=e.getElementsByTagName("script")[0],i.parentNode.insertBefore(n,i)}}(document,window.mixpanel||[])},{}],109:[function(e,t,n){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e("./trackjs_prelude"),function(e,t,n){"use awesome";if(e.trackJs)e.console&&e.console.warn&&e.console.warn("TrackJS global conflict");else{var s=function(e,t,n,i,s){this.util=e,this.onError=t,this.onFault=n,this.options=s,s.enabled&&this.initialize(i)};s.prototype={initialize:function(e){e.addEventListener&&(this.wrapAndCatch(e.Element.prototype,"addEventListener",1),this.wrapAndCatch(e.XMLHttpRequest.prototype,"addEventListener",1),this.wrapRemoveEventListener(e.Element.prototype),this.wrapRemoveEventListener(e.XMLHttpRequest.prototype)),this.wrapAndCatch(e,"setTimeout",0),this.wrapAndCatch(e,"setInterval",0)},wrapAndCatch:function(e,t,n){var i=this,s=e[t];i.util.hasFunction(s,"apply")&&(e[t]=function(){try{var o,a,c=Array.prototype.slice.call(arguments),l=c[n];if(i.options.bindStack)try{throw Error()}catch(e){a=e.stack,o=i.util.isoNow()}if("addEventListener"===t&&(this._trackJsEvt||(this._trackJsEvt=new r),this._trackJsEvt.getWrapped(c[0],l,c[2])))return;return l&&i.util.hasFunction(l,"apply")&&(c[n]=function(){try{return l.apply(this,arguments)}catch(e){throw i.onError("catch",e,{bindTime:o,bindStack:a}),i.util.wrapError(e)}},"addEventListener"===t&&this._trackJsEvt.add(c[0],l,c[2],c[n])),s.apply(this,c)}catch(n){e[t]=s,i.onFault(n)}})},wrapRemoveEventListener:function(e){if(e&&e.removeEventListener&&this.util.hasFunction(e.removeEventListener,"call")){var t=e.removeEventListener;e.removeEventListener=function(e,n,i){if(this._trackJsEvt){var s=this._trackJsEvt.getWrapped(e,n,i);return s&&this._trackJsEvt.remove(e,n,i),t.call(this,e,s,i)}return t.call(this,e,n,i)}}}};var r=function(){this.events=[]};r.prototype={add:function(e,t,n,i){-1>=this.indexOf(e,t,n)&&this.events.push([e,t,!!n,i])},remove:function(e,t,n){e=this.indexOf(e,t,!!n),0<=e&&this.events.splice(e,1)},getWrapped:function(e,t,i){return e=this.indexOf(e,t,!!i),0<=e?this.events[e][3]:n},indexOf:function(e,t,n){for(var i=0;i<this.events.length;i++)if(this.events[i][0]===e&&this.events[i][1]===t&&this.events[i][2]===!!n)return i;return-1}};var o=function(e,t){this.util=e,this.initCurrent(t)};o.prototype={current:{},initOnly:{application:"",enabled:!0,token:!0,callback:{enabled:!0},console:{enabled:!0},network:{enabled:!0},visitor:{enabled:!0},window:{enabled:!0}},defaults:{application:"",enabled:!0,onError:function(){return!0},serialize:function(e){return e===n?"undefined":null===e?"null":"number"==typeof e&&isNaN(e)?"NaN":""===e?"Empty String":0===e?"0":!1===e?"false":e&&e.toString?e.toString():"unknown"},sessionId:"",token:"",userId:"",version:"",callback:{enabled:!0,bindStack:!1},console:{enabled:!0,display:!0,error:!0,watch:["log","debug","info","warn","error"]},network:{enabled:!0,error:!0},visitor:{enabled:!0},window:{enabled:!0}},initCurrent:function(e){return this.validate(e,this.defaults,"config",{})?(this.current=this.util.extend(this.current,this.defaults,e),!0):(this.current=this.util.extend(this.current,this.defaults),!1)},setCurrent:function(e){return!!this.validate(e,this.defaults,"config",this.initOnly)&&(this.current=this.util.extend(this.current,e),!0)},validate:function(e,t,n,s){var r=!0;n=n||"",s=s||{};for(var o in e)if(e.hasOwnProperty(o))if(t.hasOwnProperty(o)){var a=i(t[o]);a!==i(e[o])?(console.warn(n+"."+o+": property must be type "+a+"."),r=!1):"[object Array]"!==Object.prototype.toString.call(e[o])||this.validateArray(e[o],t[o],n+"."+o)?"[object Object]"===Object.prototype.toString.call(e[o])?r=this.validate(e[o],t[o],n+"."+o,s[o]):s.hasOwnProperty(o)&&(console.warn(n+"."+o+": property cannot be set after load."),r=!1):r=!1}else console.warn(n+"."+o+": property not supported."),r=!1;return r},validateArray:function(e,t,n){var i=!0;n=n||"";for(var s=0;s<e.length;s++)this.util.contains(t,e[s])||(console.warn(n+"["+s+"]: invalid value: "+e[s]+"."),i=!1);return i}};var a=function(e,t,n,i,s,r,o){this.util=e,this.log=t,this.onError=n,this.onFault=i,this.serialize=s,o.enabled&&(r.console=this.wrapConsoleObject(r.console,o));
};a.prototype={wrapConsoleObject:function(e,t){e=e||{};var n,i=e.log||function(){},s=this;for(n=0;n<t.watch.length;n++)!function(n){var r=e[n]||i;e[n]=function(){try{var e=Array.prototype.slice.call(arguments);if(s.log.add("c",{timestamp:s.util.isoNow(),severity:n,message:s.serialize(e)}),t.error&&"error"===n)try{throw Error(s.serialize(e))}catch(e){s.onError("console",e)}t.display&&(s.util.hasFunction(r,"apply")?r.apply(this,e):r(e[0],e[1],e[2]))}catch(e){s.onFault(e)}}}(t.watch[n]);return e},report:function(){return this.log.all("c")}};var c=function(e,t,n,i,s){this.config=e,this.util=t,this.log=n,this.window=i,this.document=s,this.correlationId=this.token=null,this.initialize()};c.prototype={initialize:function(){this.token=this.getCustomerToken(),this.correlationId=this.getCorrelationId()},getCustomerToken:function(){if(this.config.current.token)return this.config.current.token;var e=this.document.getElementsByTagName("script");return e[e.length-1].getAttribute("data-token")},getCorrelationId:function(){var e;try{e=this.document.cookie.replace(/(?:(?:^|.*;\s*)TrackJS\s*\=\s*([^;]*).*$)|^.*$/,"$1"),e||(e=this.util.uuid(),this.document.cookie="TrackJS="+e+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/")}catch(t){e=this.util.uuid()}return e},report:function(){return{application:this.config.current.application,correlationId:this.correlationId,sessionId:this.config.current.sessionId,token:this.token,userId:this.config.current.userId,version:this.config.current.version}}};var l=function(e){this.loadedOn=(new Date).getTime(),this.window=e};l.prototype={discoverDependencies:function(){var e,t={};this.window.jQuery&&this.window.jQuery.fn&&this.window.jQuery.fn.jquery&&(t.jQuery=this.window.jQuery.fn.jquery),this.window.jQuery&&this.window.jQuery.ui&&this.window.jQuery.ui.version&&(t.jQueryUI=this.window.jQuery.ui.version),this.window.angular&&this.window.angular.version&&this.window.angular.version.full&&(t.angular=this.window.angular.version.full);for(e in this.window)if("_trackJs"!==e&&"_trackJS"!==e&&"_trackjs"!==e&&"webkitStorageInfo"!==e&&"webkitIndexedDB"!==e&&"top"!==e&&"parent"!==e&&"frameElement"!==e)try{if(this.window[e]){var n=this.window[e].version||this.window[e].Version||this.window[e].VERSION;"string"==typeof n&&(t[e]=n)}}catch(e){}return t},report:function(){return{age:(new Date).getTime()-this.loadedOn,dependencies:this.discoverDependencies(),userAgent:this.window.navigator.userAgent,viewportHeight:this.window.document.documentElement.clientHeight,viewportWidth:this.window.document.documentElement.clientWidth}}};var u=function(e){this.util=e,this.appender=[],this.maxLength=30};u.prototype={all:function(e){var t,n,i=[];for(n=0;n<this.appender.length;n++)(t=this.appender[n])&&t.category===e&&i.push(t.value);return i},clear:function(){this.appender.length=0},truncate:function(){this.appender.length>this.maxLength&&(this.appender=this.appender.slice(Math.max(this.appender.length-this.maxLength,0)))},add:function(e,t){var n=this.util.uuid();return this.appender.push({key:n,category:e,value:t}),this.truncate(),n},get:function(e,t){var n,i;for(i=0;i<this.appender.length;i++)if(n=this.appender[i],n.category===e&&n.key===t)return n.value;return!1}};var d=function(e,t,n,i,s,r){this.util=e,this.log=t,this.onError=n,this.onFault=i,this.window=s,this.options=r,r.enabled&&this.initialize(s)};d.prototype={initialize:function(e){e.XMLHttpRequest&&this.util.hasFunction(e.XMLHttpRequest.prototype.open,"apply")&&this.watchNetworkObject(e.XMLHttpRequest),e.XDomainRequest&&this.util.hasFunction(e.XDomainRequest.prototype.open,"apply")&&this.watchNetworkObject(e.XDomainRequest)},watchNetworkObject:function(e){var t=this,n=e.prototype.open,i=e.prototype.send;return e.prototype.open=function(e,t){return 0>t.indexOf("localhost:0")&&(this._trackJs={method:e,url:t}),n.apply(this,arguments)},e.prototype.send=function(){try{if(!this._trackJs)return i.apply(this,arguments);this._trackJs.logId=t.log.add("n",{startedOn:t.util.isoNow(),method:this._trackJs.method,url:this._trackJs.url}),t.listenForNetworkComplete(this)}catch(e){t.onFault(e)}return i.apply(this,arguments)},e},listenForNetworkComplete:function(e){var t=this;t.window.ProgressEvent&&e.addEventListener&&e.addEventListener("readystatechange",function(){4===e.readyState&&t.finalizeNetworkEvent(e)},!0),e.addEventListener?e.addEventListener("load",function(){t.finalizeNetworkEvent(e),t.checkNetworkFault(e)},!0):setTimeout(function(){try{var n=e.onload;e.onload=function(){t.finalizeNetworkEvent(e),t.checkNetworkFault(e),"function"==typeof n&&t.util.hasFunction(n,"apply")&&n.apply(e,arguments)};var i=e.onerror;e.onerror=function(){t.finalizeNetworkEvent(e),t.checkNetworkFault(e),"function"==typeof oldOnError&&i.apply(e,arguments)}}catch(e){t.onFault(e)}},0)},finalizeNetworkEvent:function(e){if(e._trackJs){var t=this.log.get("n",e._trackJs.logId);t&&(t.completedOn=this.util.isoNow(),t.statusCode=1223==e.status?204:e.status,t.statusText=1223==e.status?"No Content":e.statusText)}},checkNetworkFault:function(e){if(this.options.error&&400<=e.status&&1223!=e.status){var t=e._trackJs||{};this.onError("ajax",e.status+" "+e.statusText+": "+t.method+" "+t.url)}},report:function(){return this.log.all("n")}};var h=function(t){this.util=t,this.disabled=!1,this.throttleStats={attemptCount:0,throttledCount:0,lastAttempt:(new Date).getTime()},e.JSON&&e.JSON.stringify||(this.disabled=!0)};h.prototype={errorEndpoint:function(t){var n="https://capture.trackjs.com/capture";return this.util.testCrossdomainXhr()||-1!==e.location.protocol.indexOf("https")||(n="http://capture.trackjs.com/capture"),n+"?token="+t},usageEndpoint:function(e){return this.appendObjectAsQuery(e,"https://usage.trackjs.com/usage.gif")},trackerFaultEndpoint:function(e){return this.appendObjectAsQuery(e,"https://usage.trackjs.com/fault.gif")},appendObjectAsQuery:function(e,t){t+="?";for(var n in e)e.hasOwnProperty(n)&&(t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n])+"&");return t},getCORSRequest:function(t,n){var i;return this.util.testCrossdomainXhr()?(i=new e.XMLHttpRequest,i.open(t,n),i.setRequestHeader("Content-Type","text/plain")):"undefined"!=typeof e.XDomainRequest?(i=new e.XDomainRequest,i.open(t,n)):i=null,i},sendTrackerFault:function(e){this.throttle(e)||((new Image).src=this.trackerFaultEndpoint(e))},sendUsage:function(e){(new Image).src=this.usageEndpoint(e)},sendError:function(t,i){var s=this;if(!this.disabled&&!this.throttle(t))try{var r=this.getCORSRequest("POST",this.errorEndpoint(i));r.onreadystatechange=function(){4===r.readyState&&200!==r.status&&(s.disabled=!0)},r._trackJs=n,r.send(e.JSON.stringify(t))}catch(e){throw this.disabled=!0,e}},throttle:function(e){var t=(new Date).getTime();if(this.throttleStats.attemptCount++,this.throttleStats.lastAttempt+1e3>=t){if(this.throttleStats.lastAttempt=t,10<this.throttleStats.attemptCount)return this.throttleStats.throttledCount++,!0}else e.throttled=this.throttleStats.throttledCount,this.throttleStats.attemptCount=0,this.throttleStats.lastAttempt=t,this.throttleStats.throttledCount=0;return!1}};var p=function(e){this.window=e};p.prototype={bind:function(e,t){return function(){return e.apply(t,Array.prototype.slice.call(arguments))}},contains:function(e,t){var n;for(n=0;n<e.length;n++)if(e[n]===t)return!0;return!1},defer:function(e,t){setTimeout(function(){e.apply(t)})},extend:function(e){for(var t,i=Array.prototype.slice.call(arguments,1),s=0;s<i.length;s++)for(t in i[s])null===i[s][t]||i[s][t]===n?e[t]=i[s][t]:"[object Object]"===Object.prototype.toString.call(i[s][t])?(e[t]=e[t]||{},this.extend(e[t],i[s][t])):e[t]=i[s][t];return e},hasFunction:function(e,t){try{return!!e[t]}catch(e){return!1}},isBrowserIE:function(){var e=this.window.navigator.userAgent,t=e.match(/Trident\/([\d.]+)/);return t&&"7.0"===t[1]?11:!!(e=e.match(/MSIE ([\d.]+)/))&&parseInt(e[1],10)},isBrowserSupported:function(){var e=this.isBrowserIE();return!e||8<=e},isoNow:function(){var e=new Date;return e.toISOString?e.toISOString():e.getUTCFullYear()+"-"+this.pad(e.getUTCMonth()+1)+"-"+this.pad(e.getUTCDate())+"T"+this.pad(e.getUTCHours())+":"+this.pad(e.getUTCMinutes())+":"+this.pad(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"},pad:function(e){return e=String(e),1===e.length&&(e="0"+e),e},testCrossdomainXhr:function(){return"withCredentials"in new XMLHttpRequest},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},wrapError:function(e){if(e.innerError)return e;var t=Error("TrackJS Caught: "+(e.message||e));return t.description="TrackJS Caught: "+e.description,t.file=e.file,t.line=e.line||e.lineNumber,t.column=e.column||e.columnNumber,t.stack=e.stack,t.innerError=e,t}};var f=function(e,t,n,i,s,r){this.util=e,this.log=t,this.onError=n,this.onFault=i,this.options=r,this.document=s,r.enabled&&this.initialize(s)};f.prototype={initialize:function(e){var t=this.util.bind(this.onDocumentClicked,this),n=this.util.bind(this.onInputChanged,this);e.addEventListener?(e.addEventListener("click",t,!0),e.addEventListener("blur",n,!0)):e.attachEvent&&(e.attachEvent("onclick",t),e.attachEvent("onfocusout",n))},onDocumentClicked:function(e){try{var t=this.getElementFromEvent(e);t&&t.tagName&&(this.isDescribedElement(t,"a")||this.isDescribedElement(t,"button")||this.isDescribedElement(t,"input",["button","submit"])?this.writeVisitorEvent(t,"click"):this.isDescribedElement(t,"input",["checkbox","radio"])&&this.writeVisitorEvent(t,"input",t.value,t.checked))}catch(e){this.onFault(e)}},onInputChanged:function(e){try{var t=this.getElementFromEvent(e);t&&t.tagName&&(this.isDescribedElement(t,"textarea")?this.writeVisitorEvent(t,"input",t.value):this.isDescribedElement(t,"select")&&t.options&&t.options.length?this.onSelectInputChanged(t):this.isDescribedElement(t,"input")&&!this.isDescribedElement(t,"input",["button","submit","hidden","checkbox","radio"])&&this.writeVisitorEvent(t,"input",t.value))}catch(e){this.onFault(e)}},onSelectInputChanged:function(e){if(e.multiple)for(var t=0;t<e.options.length;t++)e.options[t].selected&&this.writeVisitorEvent(e,"input",e.options[t].value);else 0<=e.selectedIndex&&e.options[e.selectedIndex]&&this.writeVisitorEvent(e,"input",e.options[e.selectedIndex].value)},writeVisitorEvent:function(e,t,i,s){"password"===this.getElementType(e)&&(i=n),this.log.add("v",{timestamp:this.util.isoNow(),action:t,element:{tag:e.tagName.toLowerCase(),attributes:this.getElementAttributes(e),value:this.getMetaValue(i,s)}})},getElementFromEvent:function(e){return e.target||t.elementFromPoint(e.clientX,e.clientY)},isDescribedElement:function(e,t,n){if(e.tagName.toLowerCase()!==t.toLowerCase())return!1;if(!n)return!0;for(e=this.getElementType(e),t=0;t<n.length;t++)if(n[t]===e)return!0;return!1},getElementType:function(e){return(e.getAttribute("type")||"").toLowerCase()},getElementAttributes:function(e){for(var t={},n=0;n<e.attributes.length;n++)"value"!==e.attributes[n].name.toLowerCase()&&(t[e.attributes[n].name]=e.attributes[n].value);return t},getMetaValue:function(e,t){return e===n?n:{length:e.length,pattern:this.matchInputPattern(e),checked:t}},matchInputPattern:function(e){return""===e?"empty":/^[a-z0-9!#$%&'*+=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/.test(e)?"email":/^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/.test(e)||/^(\d{4}[\/\-](0?[1-9]|1[012])[\/\-]0?[1-9]|[12][0-9]|3[01])$/.test(e)?"date":/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/.test(e)?"usphone":/^\s*$/.test(e)?"whitespace":/^\d*$/.test(e)?"numeric":/^[a-zA-Z]*$/.test(e)?"alpha":/^[a-zA-Z0-9]*$/.test(e)?"alphanumeric":"characters"},report:function(){return this.log.all("v")}};var m=function(e,t,n,i,s){this.onError=e,this.onFault=t,this.serialize=n,s.enabled&&this.watchWindowErrors(i)};m.prototype={watchWindowErrors:function(e){var t=this;e.onerror=function(e,n,i,s,r){try{r=r||{},r.message=r.message||t.serialize(e),r.file=r.file||t.serialize(n),r.line=r.line||parseInt(i,10)||null,r.column=r.column||parseInt(s,10)||null,t.onError("window",r)}catch(e){t.onFault(e)}}}};var g=function(e,t,n,i,s,r,o,a,c,l,u,d,h,p,f,m){try{if(this.window=f,this.document=m,this.util=new u(this.window),this.onError=this.util.bind(this.onError,this),this.onFault=this.util.bind(this.onFault,this),this.serialize=this.util.bind(this.serialize,this),this.transmitter=new l(this.util),this.config=new i(this.util,e),this.log=new a(this.util),this.api=new t(this.config,this.util,this.onError,this.serialize),this.environment=new o(this.window),this.customer=new r(this.config,this.util,this.log,this.window,this.document),this.customer.token&&(this.apiConsoleWatcher=new s(this.util,this.log,this.onError,this.onFault,this.serialize,this.api,this.config.defaults.console),this.config.current.enabled&&(this.windowConsoleWatcher=new s(this.util,this.log,this.onError,this.onFault,this.serialize,this.window,this.config.current.console),this.util.isBrowserSupported()))){this.callbackWatcher=new n(this.util,this.onError,this.onFault,this.window,this.config.current.callback),this.visitorWatcher=new d(this.util,this.log,this.onError,this.onFault,this.document,this.config.current.visitor),this.networkWatcher=new c(this.util,this.log,this.onError,this.onFault,this.window,this.config.current.network),this.windowWatcher=new h(this.onError,this.onFault,this.serialize,this.window,this.config.current.window);var g=this;setTimeout(function(){g.transmitter.sendUsage({token:g.customer.token,correlationId:g.customer.correlationId,application:g.config.current.application,x:g.util.uuid()})},1e3)}}catch(e){this.onFault(e)}};g.prototype={reveal:function(){return this.customer.token?this.api:(this.window.console&&this.window.console.warn&&this.window.console.warn("TrackJS could not find a token"),n)},onError:function(){var t=!1;return function(n,i,s){if(this.util.isBrowserSupported()&&this.config.current.enabled)try{i=i||{},s=s||{bindStack:null,bindTime:null,force:!1};var r=i.message||this.serialize(i,s.force);if(r&&r.indexOf){if(-1!==r.indexOf("TrackJS Caught"))return;if(t&&-1!==r.indexOf("Script error"))return void(t=!1)}var o=this.util.extend({},{bindStack:s.bindStack,bindTime:s.bindTime,column:i.column||i.columnNumber,console:this.windowConsoleWatcher.report(),customer:this.customer.report(),entry:n,environment:this.environment.report(),file:i.file||i.fileName,line:i.line||i.lineNumber,message:r,network:this.networkWatcher.report(),url:(e.location||"").toString(),stack:i.stack,timestamp:this.util.isoNow(),visitor:this.visitorWatcher.report(),version:"2.1.14"});if(!s.force)try{if(!this.config.current.onError(o,i))return}catch(e){o.console.push({timestamp:this.util.isoNow(),severity:"error",message:e.message});var a=this;setTimeout(function(){a.onError("catch",e,{force:!0})},0)}this.log.clear(),setTimeout(function(){t=!1}),t=!0,this.transmitter.sendError(o,this.customer.token)}catch(e){console.log(e),this.onFault(e)}}}(),onFault:function(e){var t=this.transmitter||new h;e=e||{},e={token:this.customer.token,file:e.file||e.fileName,msg:e.message||"unknown",stack:(e.stack||"unknown").substr(0,500),url:this.window.location,v:"2.1.14",x:this.util.uuid()},t.sendTrackerFault(e)},serialize:function(e,t){if(this.config.current.serialize&&!t)try{return this.config.current.serialize(e)}catch(e){this.onError("catch",e,{force:!0})}return this.config.defaults.serialize(e)}},s=new g(e._trackJs||e._trackJS||e._trackjs||{},function(e,t,n,i){return{attempt:function(e,i){try{var s=Array.prototype.slice.call(arguments,2);return e.apply(i||this,s)}catch(e){throw n("catch",e),t.wrapError(e)}},configure:function(t){return e.setCurrent(t)},track:function(e){if(e=e||{},!e.stack)try{throw Error(i(e))}catch(t){e=t}n("direct",e)},watch:function(e,i){return function(){try{var s=Array.prototype.slice.call(arguments,0);return e.apply(i||this,s)}catch(e){throw n("catch",e),t.wrapError(e)}}},watchAll:function(e){var i,s=Array.prototype.slice.call(arguments,1);for(i in e)"function"==typeof e[i]&&(t.contains(s,i)||function(){var s=e[i];e[i]=function(){try{var e=Array.prototype.slice.call(arguments,0);return s.apply(this,e)}catch(e){throw n("catch",e),t.wrapError(e)}}}());return e},version:"2.1.14"}},s,o,a,c,l,u,d,h,p,f,m,r,e,t),e.trackJs=s.reveal()}}(window,document)},{"./trackjs_prelude":110}],110:[function(e,t,n){function i(e){try{return"string"==typeof e?e:JSON.stringify(e)}catch(e){}}function s(e){for(var t=[],n=0;n<e.length;n++)t.push(i(e[n]));return t.join(" ")}function r(){return{production:"readcube-reader",staging:"readcube-reader-staging"}[o.get()]||""}var o=e("../environment"),a=e("./api_keys");window._trackJs={enabled:!!r(),application:r(),token:a.trackjs,serialize:function(e){return Array.isArray(e)?s(e):i(e)},onError:function(e){return!/401 Unauthorized: GET/.test(e.message)&&(!/^Script error(\.)?$/.test(e.message)&&(!/\/\/api\.altmetric\.com\/v1\/doi/.test(e.message)&&(!/file:\/\/(\/)?/.test(e.url)&&!/404 Not Found: GET https:\/\/sync\.readcube\.com/.test(e.message))))}}},{"../environment":96,"./api_keys":101}],111:[function(e,t,n){function i(e){var t=e.attr("class");return t?(t=$.grep(t.split(" "),function(e){return!!g[e]}).sort(function(e,t){return g[e]-g[t]}),t[0]):null}function s(e,t){t.getElems().on(e+"."+t.getId(),function(t){var n=$(t.target),s=i(n);if(s){var r=n.data(s+v).split(" ").pop();return $(m[r]).trigger(jQuery.Event(e,{originalEvent:t})),!1}})}function r(e,t){t.getElems().off(e+"."+t.getId())}function o(e){for(var t=0;t<f.length;t++)s(f[t],e)}function a(e){for(var t=0;t<f.length;t++)r(f[t],e)}function c(e){var t=e.getId(),n=e.getKlass()+v;e.getElems().each(function(){var e=$(this),i=e.data(n),s=i?[i,t].join(" "):t;e.data(n,s)})}function l(e){var t=e.getId(),n=e.getKlass()+v;e.getElems().each(function(){var e=$(this),i=e.data(n);if(i){var s=$.grep(i.split(" "),function(e){return e!=t});e.data(n,s.join(" "))}})}function u(e){m[e.getId()]=e,c(e),o(e)}function d(e){a(e),l(e),delete m[e.getId()]}function h(){_.each(_.keys(m),function(e){d(m[e])})}var p={},f=["mouseenter","mouseleave","click"],m={},g={termite:100,annotation:200,"current-selection":300,"enhanced-reference":400,"enhanced-author":500,"enhanced-figure":600},v="-input-id";p.add=u,p.remove=d,p.removeAll=h,t.exports=p},{}],112:[function(e,t,n){function i(e){return _.findKey(u,function(t){return t.test(e)})}function s(e,t){var n=JSON.parse(c.session.get(l)||"{}");n[e]=t,c.session.set(l,JSON.stringify(n))}function r(e){var t=JSON.parse(c.session.get(l));return t&&t[e]}function o(e){return e==i(a.referrerHost())&&s(e,a.referrerHost()),r(e)}var a=e("./utils/util"),c=e("./utils/storage"),l="readcube-proxy-referrer",u={nature:/nature\.com/,palgrave:/palgraveconnect\.com/,wiley:/onlinelibrary\.wiley\.com/,karger:/karger\.(com|de)/};t.exports=o},{"./utils/storage":139,"./utils/util":143}],113:[function(e,t,n){function i(e){return!!/readcube\.com(:\d+)?$/.test(e||"")}function s(){$(window).on("message",function(e){for(;e.originalEvent;)e=e.originalEvent;e.data&&e.data.type&&(i(e.origin)&&$(r.readcube).trigger(e.data.type,[e.data]),$(r.all).trigger(e.data.type,[e.data]))}),window.popupMessage=function(e){$(r.all).trigger(e.type,[e])}}var r=(e("./utils/util"),{all:{},readcube:{}});s(),t.exports=r},{"./utils/util":143}],114:[function(e,t,n){function i(){/10\.5966\/sctm\./gi.test(l.get().doi)&&u.onInit(function(){u.eachPage(function(e,t){1==e&&t.onLoaded(function(){t.hasText()&&t.getElem().find(".pc .t.ff1").first().hide()})})})}function s(){/10\.1002\/(?:cctc|cbic|cmdc|cssc|cphc|cplu|celc|chem|adsc|asia|ange|anie|open|ajoc)\./gi.test(l.get().doi)&&u.onInit(function(){u.eachPage(function(e,t){t.onLoaded(function(){t.hasText()&&t.getElem().find('*:contains("ACHTUNGTRENNUNG")').contents().each(function(e,t){"ACHTUNGTRENNUNG"==t.textContent&&$(a.wrapTextNode(t)).hide()})})})})}function r(){"10.1002/adfm.201502338"==l.get().doi&&"chrome"==c.name&&u.onInit(function(){u.eachPage(function(e,t){10==e&&t.onLoaded(function(){t.getElem().find(".x84.y2ec").css("left",1282)})})})}function o(){l.onInit(function(){i(),s(),r()})}var a=e("./utils/util"),c=e("./utils/browser"),l=e("./article"),u=e("./viewer/viewer");t.exports={init:o}},{"./article":87,"./utils/browser":131,"./utils/util":143,"./viewer/viewer":151}],115:[function(e,t,n){function i(e){return new Promise(function(t,n){$.ajax({url:e,dataType:"json",success:t,error:n})})}function s(e,t){return new Promise(function(n,i){$.ajax({url:e,type:"PUT",contentType:"application/json; charset=UTF-8",data:JSON.stringify(t),success:n,error:i})})}function r(){return new Promise(function(e,t){$.ajax({url:o.services+"/reader/annotations_bucket",success:e,error:t})})}var o=e("./endpoint"),a={};a.read=i,a.write=s,a.writableUrl=r,t.exports=a},{"./endpoint":95}],116:[function(e,t,n){function i(e){return c.addParams(l.services+"/reader/supplement",e)}function s(e){return new Promise(function(t,n){$.ajax(c.merge(p,{url:i(e),dataType:"json",success:t,error:function(e){n(e.responseJSON||e.responseText)}}))})}function r(){return c.clone(d)}function o(e){return h=e||{},s(h).then(function(e){return d=e})}function a(){return s(h).then(function(e){return d=e})}var c=e("./utils/util"),l=e("./endpoint"),u={},d={},h=null,p={crossDomain:!0,xhrFields:{withCredentials:!0}};u.init=o,u.update=a,u.get=r,window.supplement=u,t.exports=u},{"./endpoint":95,"./utils/util":143}],117:[function(e,t,n){function i(e){return e.data?e.data.sync_client_id:null}var s=e("faye"),r=(e("../utils/util"),e("../endpoint")),o=e("./primitives"),a=e("../tracking/track_error");r.push||a({error:"endpoint.push is undefined"});var c=new s.Client(r.push);c.addExtension({incoming:function(e,t){i(e)!=o.clientId&&t(e)},outgoing:function(e,t){t(e)}}),t.exports=c},{"../endpoint":95,"../tracking/track_error":124,"../utils/util":143,"./primitives":118,faye:4}],118:[function(e,t,n){function i(){return[k.sync,"items","add"].join("/")}function s(e){e=e||x.get().sync_item_id,e=e||encodeURIComponent(x.get().doi);var t=[k.sync];return x.get().sync_collection_id&&(t=t.concat(["collections",x.get().sync_collection_id])),t.concat(["items",e]).join("/")}function r(e){return[s(e),"view"].join("/")}function o(e,t){var n=[s(e),"annotations"].join("/");return t&&(n=[n,t].join("/")),n}function a(){return{"ext_ids[doi]":x.get().doi,access_token:x.get().access_token}}function c(e){return _.filter(e,function(e){return e.sha256==x.get().hash})}function l(e,t){return function(n){"ok"==n.status?e(n):t(n)}}function u(e,t){return function(n){404==n.status?e({status:"ok"}):t(n)}}function d(e){var t=s(e);return d[t]?d[t]:d[t]=new Promise(function(e,n){$.ajax(y.merge(E,{type:"GET",url:t,success:l(e,n),error:n,complete:function(){delete d[t]}}))})}function h(){return new Promise(function(e,t){$.ajax(y.merge(E,{type:"POST",url:i(),dataType:"json",data:a(),success:l(e,t),error:t}))})}function p(e,t){return new Promise(function(n,i){$.ajax(y.merge(E,{type:"PATCH",url:s(e),contentType:"application/json; charset=UTF-8",dataType:"json",data:JSON.stringify({item:t}),success:l(n,i),error:i}))})}function f(e){return new Promise(function(t,n){$.ajax(y.merge(E,{type:"DELETE",url:s(e),success:l(t,n),error:u(t,n)}))})}function m(e){return new Promise(function(e,t){$.ajax(y.merge(E,{type:"POST",url:r(),success:l(e,t),error:t}))})}function g(e){return new Promise(function(t,n){$.ajax(y.merge(E,{type:"GET",url:o(e),success:l(function(e){e.annotations=c(e.annotations),t(e)},n),error:n}))})}function v(e,t){return new Promise(function(n,i){$.ajax(y.merge(E,{type:"POST",url:o(e),contentType:"application/json; charset=UTF-8",dataType:"json",data:JSON.stringify({annotation:t}),success:l(n,i),error:i}))})}function w(e,t,n){return new Promise(function(i,s){$.ajax(y.merge(E,{type:"PATCH",url:o(e,t),contentType:"application/json; charset=UTF-8",dataType:"json",data:JSON.stringify({annotation:n}),success:l(i,s),error:s}))})}function b(e,t){return new Promise(function(n,i){$.ajax(y.merge(E,{type:"DELETE",url:o(e,t),success:l(n,i),error:u(n,i)}))})}var y=e("../utils/util"),k=e("../endpoint"),x=e("../article"),C={},T={},A=y.guid(),E={crossDomain:!0,xhrFields:{withCredentials:!0},headers:{"X-Readcube-Sync-Client":"Web Reader","X-Readcube-Sync-Client-Id":A}};C.get=d,C.add=h,C.update=p,C.remove=f,C.view=m,T.list=g,T.add=v,T.update=w,T.remove=b,t.exports={item:C,annots:T,clientId:A}},{"../article":87,"../endpoint":95,"../utils/util":143}],119:[function(e,t,n){function i(){return Y}function s(){Y=!0,$(I.item).trigger("busy")}function r(){Y=!1,$(I.item).trigger("done")}function o(e){X=e.item,$(I.item).trigger("added"),S(function(e){return E.item.view().catch(e)},{minTimeout:2e3})}function a(e){X=e.item,$(I.item).trigger("changed")}function c(e){_.isEmpty(X)?o(e):_.isEqual(X,e.item)||a(e)}function l(){_.isEmpty(X)||(X={},$(I.item).trigger("removed"))}function u(){return _.isEmpty(X)?null:X.id}function d(){return C.signedIn()?_.isEmpty(X)?E.item.get(u()):Promise.resolve({item:X}):Promise.reject({status:"signed_out"})}function h(){return i()?Promise.reject({status:"busy"}):(s(),E.item.add().then(function(e){c(e),r()},r))}function p(){return _.isEmpty(X)?Promise.resolve({status:"ok"}):i()?Promise.reject({status:"busy"}):(s(),E.item.remove(u()).then(function(){l(),r()},r))}function f(e){_.isEmpty(X)||e(X),$(I.item).on("added",function(){e(X)})}function m(e){_.isEqual(X,{})&&e(),$(I.item).on("removed",e)}function g(){return _.isEmpty(X)?Promise.reject({status:"item_not_synced"}):E.annots.list(u())}function v(e){return _.isEmpty(X)?Promise.reject({status:"item_not_synced"}):E.annots.add(u(),e)}function w(e,t){return _.isEmpty(X)?Promise.reject({status:"item_not_synced"}):E.annots.update(u(),e,t)}function b(e){return _.isEmpty(X)?Promise.reject({status:"item_not_synced"}):E.annots.remove(u(),e)}function y(e){C.signedIn()&&E.item.get(u()).then(c,function(e){404==e.status&&l()})}function k(){var e=T.get().sync_collection_id||C.get().id;return sprintf("/%s/collections/%s/items/*",A.get(),e)}function x(){T.onInit(function(e){e.discover||e.sync_item_sponsored||C.onSignIn(function(){j.subscribe(k(),y),E.item.get(u()).then(c).catch(_.noop)})})}var C=e("../user"),T=e("../article"),A=e("../environment"),E=e("./primitives"),j=e("./faye_client"),S=e("promise-retry"),X=null,Y=!1,I={item:{},annots:{}};x(),I.item.id=u,I.item.get=d,I.item.add=h,I.item.remove=p,I.item.onAdd=f,I.item.onRemove=m,I.annots.list=g,I.annots.add=v,I.annots.update=w,I.annots.remove=b,window.sync=I,t.exports=I},{"../article":87,"../environment":96,"../user":128,"./faye_client":117,"./primitives":118,"promise-retry":40}],120:[function(e,t,n){function i(e,t){var n=null,i={container:e.getElem()};return t.text?(t.preceeding_text||(t.preceeding_text=""),n||(n=r.deserialize({prefix:t.preceeding_text,text:t.text},i)),n||(n=r.deserialize({prefix:t.preceeding_text,text:t.text},s.merge(i,{matchMisconverted:!0}))),n):null}var s=e("../utils/util"),r=e("../utils/range_serializer"),o=e("../annotations/annotation_helper"),a=function(e,t,n){t=s.merge({id:s.guid(),color_id:1},t),n=n||i(e,t),this.klass="termite",this.id=s.guid(),this.page=e,this.data=t,this.range=n,this._initData(),this._initRects(),this._initElems(),this._addDrawable(),this._addEventable()};a.prototype={_initData:function(){!this.data.text&&this.range&&(this.data=s.merge(this.data,o.rangeToTextData(this.range,this.page))),!this.data.rects&&this.range&&(this.data=s.merge(this.data,o.rangeToRectData(this.range,this.page)))},_initRects:function(){this.data.rects?this.rects=o.fromSyncCoords(this.page,this.data.rects):this.range&&(this.rects=o.getNormalizedRects(this.page,this.range))},_initElems:function(){var e=[],t=this.page.getZoom();_.each(this.rects,function(n){e.push(s.divFromRect(n.scale(t,t)))}),this._elems=$(e)},_addDrawable:function(){var e=[this.klass+"-elem-draw",this.getColor(),this.id,"transparent"].join(" "),t=o.addToDocumentFragment(this._elems,e);this._drawableElems=$(t).children(),this.page.getDrawable().append(t)},_addEventable:function(){var e=[this.klass,this.id].join(" ");(this.data.meta||{})._ext_uri&&(e+=" linkout");var t=o.addToDocumentFragment(this._elems,e);this._eventableElems=$(t).children(),this.page.getEventable().append(t)},_removeEventable:function(){this._eventableElems.remove(),this._eventableElems=null},_removeDrawable:function(){this._drawableElems.remove(),this._drawableElems=null},getElems:function(){return this._eventableElems},getColor:function(){var e=parseInt(this.data.color_id);return!e||e<1||e>4?"color-1":"color-"+e},getId:function(){return this.id},getDataId:function(){return this.data.id},getKlass:function(){return this.klass},destroy:function(){this._removeEventable(),this._removeDrawable(),this.range=null,this.klass=null,this.data=null,this.page=null},serialize:function(){return s.clone(this.data)}},t.exports=a},{"../annotations/annotation_helper":79,"../utils/range_serializer":137,"../utils/util":143}],121:[function(e,t,n){function i(e){var t=e.getId();_[t]=e,g.add(e),$(w).trigger("add",[e]),$(e).on("click",function(){console.log("termite:",e.data),(e.data.meta||{})._ext_uri&&window.open(e.data.meta._ext_uri)})}function s(e,t){if(!b[e]&&y[e]&&t.hasText()){var n=u.timer.tic();y[e].forEach(function(e){return i(new v(t,e))}),u.log("termites("+e+") duration: "+u.timer.toc(n)+"ms"),b[e]=!0}}function r(e){var t=[];return e.forEach(function(e){t[e.page_start]||(t[e.page_start]=[]),t[e.page_start].push(e)}),t}function o(){return new Promise(function(e){f.onInit(function(){m.item.onAdd(function(t){$.ajax({xhrFields:{withCredentials:!0},url:p.sync+"/collections/"+t.collection_id+"/entities?id="+f.get().hash,success:function(t){"ok"==t.status&&e(r(t.entities))}})})})})}function a(){return!h.production()&&(o().then(function(e){y=e,d.onInit(function(){return d.eachPage(s)}),$(d).on("page-loaded.termites-model",function(e,t){s(t,d.getPageObj(t))})}),!0)}function c(e){for(var t in _)if(!1===e(_[t]))break}function l(){return u.clone(_)}var u=e("../utils/util"),d=e("../viewer/viewer"),h=e("../environment"),p=e("../endpoint"),f=e("../article"),m=e("../sync/sync"),g=e("../input_handler"),v=e("./termite"),w={},_={},b={},y=[];w.init=a,w.forEach=c,w.getAll=l,t.exports=w},{"../article":87,"../endpoint":95,"../environment":96,"../input_handler":111,"../sync/sync":119,"../utils/util":143,"../viewer/viewer":151,"./termite":120}],122:[function(e,t,n){function i(e){a(),c(),p(e)}function s(){var e=w.timer.toc(P)/1e3;N&&(e+=N,N=null),d({duration:Math.max(0,Math.min(Math.round(e),3600))})}function r(){clearTimeout(Y),Y=setTimeout(o,I),P&&s(),P=w.timer.tic()}function o(){P&&s(),P=null}function a(){C={},sessionUpdateBatch={},E={},A=!1,clearInterval(j),j=setInterval(l,S),setTimeout(function(){clearInterval(j),j=setInterval(l,X)},6e4)}function c(){clearTimeout(Y),P&&(w.timer.toc(P),P=null)}function l(){if(x){var e={};e=w.merge(e,T),A&&(e=w.merge(e,{counters:E})),$.isEmptyObject(e)||f(e),C=w.merge(C,T),T={},A=!1}}function u(e){w.log("received metrics event:",e),T=w.merge(T,w.objDiff(C,e))}function d(e){for(var t in e)E[t]=(E[t]||0)+e[t];A=!0}function h(){return article.isPersonal()?"web_library":v.any?"mobile_reader":"html5"}function p(e){N=Math.max(1,Math.round(w.timer.toc(R)/1e3));var t=parseUri(location.href).queryKey,n={session_id:k,doi:e.doi,publisher:e.meta.publisher,environment:h(),counters:{duration:N},shared:{view:!!t.shared_access_token,token:t.shared_access_token,annotations:!!e.shared_annotations_url},referred:{view:!!t.referrer_access_token,token:t.referrer_access_token},author_share:{view:!!t.author_access_token,token:t.author_access_token},feed:{view:!!t.feed_token,token:t.feed_token},referrer_url:t.tracking_referrer,article:{issn:e.meta.issn,eissn:e.meta.eissn,
isbn:e.meta.isbn,eisbn:e.meta.eisbn,year:e.meta.year,references:e.references.length>0,inline_references:g(e),video_supplement:m(e),supplements:e.supplements.length>0,figures:e.figures.length>0},access:{proxy:b(article.get().publisher)}};e.sync_collection_id&&(n.collection_id=e.sync_collection_id,e.sync_item_sponsored?n.collection_type="sponsored":e.sync_item_shared?n.collection_type="shared":n.collection_type="personal"),t.customer_ids&&(n.publisher_data||(n.publisher_data={}),n.publisher_data.customer_ids=decodeURIComponent(t.customer_ids)),$.ajax({url:_.analytics+"/metrics/create_session_ex.json",type:"POST",contentType:"application/json; charset=UTF-8",dataType:"json",crossDomain:!0,xhrFields:{withCredentials:!0},data:JSON.stringify({data:n}),success:function(e){w.log("created metrics session:",n),x=e.result}})}function f(e){w.log("updated metrics:",e),$.ajax({url:_.analytics+"/metrics/update_session_ex.json",type:"POST",contentType:"application/json; charset=UTF-8",dataType:"json",crossDomain:!0,xhrFields:{withCredentials:!0},data:JSON.stringify({data:w.merge(e,{session_id:k,article_session_id:x})})})}function m(e){if(!e.supplements)return!1;var t=e.supplements.filter(function(e){return"video"==e.type}).length;return t>0}function g(e){if(!e.citations)return!1;var t=e.citations.reduce(function(e,t){return e+t.length},0);return t>0}var v=e("../utils/mobile_detect"),w=e("../utils/util"),_=e("../endpoint"),b=e("../proxy_host"),y=e("./track_id"),k=y.get(),x=null,C={},T={},A=!1,E={},j=null,S=1e4,X=3e4,Y=null,I=6e4,P=null,R=w.timer.tic(),N=null;t.exports={start:i,active:r,idle:o,sendEvent:u,addCounter:d}},{"../endpoint":95,"../proxy_host":112,"../utils/mobile_detect":135,"../utils/util":143,"./track_id":125}],123:[function(e,t,n){function i(){o.onInit(function(){c=!0,$(a).trigger("new")})}var s=e("../endpoint"),r=e("../receiver"),o=e("../article"),a={},c=!1;s.parent?$(r.all).on("new_session",i):i(),a.onceStarted=function(e){c?e():$(a).one("new",e)},a.onStart=function(e){c&&e(),$(a).on("new",e)},t.exports=a},{"../article":87,"../endpoint":95,"../receiver":113}],124:[function(e,t,n){var i=e("../utils/util");t.exports=function(e,t){t&&("string"==typeof e&&(e={error:e}),t=i.pickDefined(t,["doi","resource_id","country","st"]),e=$.extend({params:t},e)),trackJs&&trackJs.track(e)}},{"../utils/util":143}],125:[function(e,t,n){function i(){l=a.getItem(u),l||(l=o.guid(),a.setItem(u,l))}function s(){a.removeItem(u)}function r(){return l}var o=e("../utils/util"),a=e("../utils/cookies"),c={},l=null,u="readcube-track-id";i(),c.get=r,c.clear=s,t.exports=c},{"../utils/cookies":132,"../utils/util":143}],126:[function(e,t,n){function i(){F.get().doi&&"article"==F.getType()&&(ga("set","dimension3",F.get().doi),ga("set","dimension7","web_reader"),L.onStart(s),$(D).on("auth",function(e,t){c(t.user,t.auth)}),F.onAccessCheck(function(e){var t=F.hasAccess()?e.access_method:"denied";ga("send","event","article","access_method",t),U.sendEvent({access:{method:t},access_denied:!F.hasAccess()})}),F.onAccess(function(e){e.feed_id&&U.sendEvent({feed:{id:e.feed_id}})}),$(document).on("mousemove click scroll",_.throttle(r,3e3,{leading:!0})),$(window).on({focus:r,blur:o}))}function s(){var e=window.READER_VERSION;ga("send","event","webreader","version",e.version),ga("send","event","webreader","build",e.build),F.onData(function(){U.start(F.get()),ga("send","event","article","read","web"),ga("send","event","article","origin",O())})}function r(){U.active()}function o(){U.idle()}function a(){ga("send","event","article","altmetric"),U.sendEvent({altmetric:!0})}function c(e,t){var n={};n[t]=!0,U.sendEvent(n)}function l(){U.sendEvent({cite:!0})}function u(){U.sendEvent({discover:!0})}function d(){ga("send","event","article","checkout_opened")}function h(e){ga("send","event","article","save_pdf","web",e?1:0),e&&U.sendEvent({download:!0})}function p(){U.addCounter({highlight:1})}function f(e){var t={};t[e]=!0,U.sendEvent({inline:t})}function m(e){ga("send","event","article","linkout",e)}function g(e,t){B.push({source:t,doi:e}),U.sendEvent({referrals:B.slice()}),ga("send","event","referral",t,e.split("/")[0])}function v(){U.addCounter({note:1})}function w(e){var t={};t[e]=!0,U.sendEvent({print:t}),ga("send","event","article","print","web")}function b(e){U.sendEvent({purchased:!0,purchase_id:e.purchase.id})}function y(){U.sendEvent({related:!0})}function k(){U.sendEvent({save_cloud:!0})}function x(e){ga("send","event","article","scroll","page",e)}function C(e){var t={};t[e]=!0,U.sendEvent({sidepanel:t}),ga("send","event","article","sidepanel",e)}function T(e){ga("send","event","article","pdf_toolbar",e)}function A(e){ga("send","event","article","menu_bar",e)}function E(e){var t={};t[e]=!0,U.sendEvent({share:t})}function j(e){U.sendEvent({share:{token:e}})}function S(){U.sendEvent({supplement:!0}),ga("send","event","article","supplement","view")}function X(e){e?U.sendEvent({tooltips:{viewed:!0}}):U.sendEvent({tooltips:{skipped:!0}})}function Y(){ga("send","event","article","video","view"),U.sendEvent({video_supplement:!0})}function I(){ga("send","event","article","export_options","view")}function P(e){ga("send","event","article","export_citation","format",e)}function R(){ga("send","event","article","export_notes")}function N(){var e=F.get().access_method;return"sharing_token"==e?"web_reader_share":"referrer_token"==e?"web_reader_referral":"web_reader"}function O(){return M.parent?M.parent.match(/[\.\/]epdf/i)?"epdf_endpoint":"overlay":"readcube.com"}var D=e("../user"),F=e("../article"),M=e("../endpoint"),L=e("./session"),U=e("./readcube_analytics"),z={},B=[];window.ga||(window.ga=_.noop),F.onInit(i),z.menuBar=A,z.pdfToolbar=T,z.trackingOrigin=N,z.altmetric=a,z.auth=c,z.cite=l,z.discover=u,z.checkout=d,z.download=h,z.highlight=p,z.inline=f,z.linkout=m,z.referral=g,z.note=v,z.print=w,z.purchase=b,z.related=y,z.saveCloud=k,z.scroll=x,z.share=E,z.shareToken=j,z.supplement=S,z.sidepanel=C,z.tooltips=X,z.video=Y,z.exportOptions=I,z.exportCitation=P,z.exportNotes=R,t.exports=z},{"../article":87,"../endpoint":95,"../user":128,"./readcube_analytics":122,"./session":123}],127:[function(e,t,n){function i(){return new Promise(function(e,t){$.ajax({url:s.version,cache:r.development()}).done(function(t){var n=new Date(t.build),i=new Date(window.READER_VERSION.build);i<n&&e()})})}var s=e("./endpoint"),r=e("./environment"),o={};o.available=i,t.exports=o},{"./endpoint":95,"./environment":96}],128:[function(e,t,n){function i(){return new Promise(function(e){$.ajax(f.services+"/auth/user_details",{xhrFields:{withCredentials:!0},crossDomain:!0,dataType:"json",success:e})})}function s(){return s.promise?s.promise:s.promise=i().then(a)}function r(){return p.clone(v)}function o(e){return e&&e.name&&!e.full_name&&(e.full_name=e.name,delete e.name),e}function a(e,t){var n=v;return v=o(p.clone(e)),"register"!=t&&(t="login"),!c(n)&&c(v)&&$(g).trigger("auth",[p.merge(r(),{auth:t})]),$(g).trigger("change",[r()]),r()}function c(e){return e&&e.id}function l(){return c(v)}function u(e){l()&&e(),$(g).on("auth",e)}function d(e){$.ajax({type:"DELETE",crossDomain:!0,xhrFields:{withCredentials:!0},url:f.web+"/session/delete.json",success:e})}function h(){$(m.readcube).on(["auth:success","checkout:auth"].join(" "),function(e,t){a(t.user,t.auth)}),s().catch(_.noop)}var p=e("./utils/util"),f=e("./endpoint"),m=e("./receiver"),g={},v={};h(),g.get=r,g.set=a,g.fetch=s,g.signOut=d,g.signedIn=l,g.onSignIn=u,t.exports=g},{"./endpoint":95,"./receiver":113,"./utils/util":143}],129:[function(e,t,n){function i(e){return _.compact([o,e]).join("-")}var s=e("./utils/storage"),r={},o=null;r.setPrefix=function(e){o||(o=e)},r.get=function(e,t){var n=s.local.get(i(e));return n?JSON.parse(n):t||null},r.set=function(e,t){s.local.set(i(e),JSON.stringify(t))},r.remove=function(e){s.local.remove(i(e))},r.clear=function(){s.local.clear()},t.exports=r},{"./utils/storage":139}],130:[function(e,t,n){function i(){setInterval(function(){c.forEach(function(e){Date.now()>=e.time_utc&&!o.docHidden()&&(e.time_utc=1/0,e.handler())})},1e3)}function s(e,t){if("function"==typeof e&&!(parseInt(t)<=Date.now()))return c.push({handler:e,time_utc:t})}function r(e){isNaN(e=parseInt(e))||e<1||e>c.length||(c[e-1].time_utc=1/0)}var o=e("./util"),a={},c=[];i(),a.add=s,a.remove=r,t.exports=a},{"./util":143}],131:[function(e,t,n){var i=[];jQBrowser.platform&&i.push(jQBrowser.platform+"-os"),jQBrowser.name&&(i.push(jQBrowser.name),parseInt(jQBrowser.versionNumber)&&i.push(jQBrowser.name+"-"+jQBrowser.versionNumber)),i.length&&$("html").addClass(i.join(" ")),t.exports=jQBrowser},{}],132:[function(e,t,n){var i={getItem:function(e){try{return e?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null}catch(e){return null}},setItem:function(e,t,n,i,s,r){try{if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var o="";if(n)switch(n.constructor){case Number:o=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:o="; expires="+n;break;case Date:o="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+o+(s?"; domain="+s:"")+(i?"; path="+i:"")+(r?"; secure":""),!0}catch(e){return!1}},removeItem:function(e,t,n){try{return!!this.hasItem(e)&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:""),!0)}catch(e){return!1}},hasItem:function(e){try{return!!e&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}catch(e){return!1}},keys:function(){try{for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=e.length,n=0;n<t;n++)e[n]=decodeURIComponent(e[n]);return e}catch(e){return[]}}};t.exports=i},{}],133:[function(e,t,n){function i(e){return/[^\u0000-\u007E]{1}/.test(e)}function s(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return o[e]||e})}for(var r=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"OE",letters:""},{base:"oe",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],o={},a=0;a<r.length;a++)for(var c=r[a].letters.split(""),l=0;l<c.length;l++)o[c[l]]=r[a].base;t.exports={detectGlyph:i,remove:s}},{}],134:[function(e,t,n){function i(e,t,n,i){var a,c=[],l=[],u=r(t);if(!u)return l;if(e.global)for(;a=e.exec(u);)c.push(s(a,i));else a=u.match(e),a&&c.push(s(a,i));return c.length&&(l=o(t,c,n)),l}function s(e,t){if(t=t||0,!e[0])throw"findTxt cannot handle zero-length matches";var n=e.index;if(t>0){var i=e[t];if(!i)throw"Invalid capture group";n+=e[0].indexOf(i),e[0]=i}return[n,n+e[0].length,[e[0]]]}function r(e){if(3===e.nodeType)return e.data;var t="";if(e=e.firstChild)do t+=r(e);while(e=e.nextSibling);return t}function o(e,t,n){var i,s,r,o,a=e,c=0,l=[],u=[],d=t.shift();e:for(;;){if(3===a.nodeType&&(!s&&a.length+c>=d[1]?(s=a,o=d[1]-c):i&&u.push(a),!i&&a.length+c>d[0]&&(i=a,r=d[0]-c),c+=a.length),i&&s){var h={startNode:i,startNodeIndex:r,endNode:s,endNodeIndex:o,matchIndex:l.length+1};if(l.push(h),n&&!1===n(h))break;if(a=s,c-=s.length-o,i=null,s=null,u=[],d=t.shift(),!d)break}else if(a.firstChild||a.nextSibling){a=a.firstChild||a.nextSibling;continue}for(;;){if(a.nextSibling){a=a.nextSibling;break}if(a.parentNode===e)break e;a=a.parentNode}}if(!n)return l}t.exports=i},{}],135:[function(e,t,n){var i=navigator.userAgent||navigator.vendor||window.opera,s=function(){var e={OperaMini:function(){return/Opera Mini/i.test(i)},Android:function(){return/Android/i.test(i)},BlackBerry:function(){return/BlackBerry/i.test(i)},iOS:function(){return/iPhone|iPad|iPod/i.test(i)},Windows:function(){/IEMobile/i.test(i)}};for(var t in e)if(e[t]())return t;return null}(),r=function(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4))||/micromessenger/i.test(i)}();t.exports={get phone(){return r},get platform(){return s},get any(){return!!s||r}}},{}],136:[function(e,t,n){function i(e,t,n){return"undefined"==typeof n||0===+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!==0?NaN:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+n:n))))}var s={};s.round10=function(e,t){return i("round",e,t)},s.floor10=function(e,t){return i("floor",e,t)},s.ceil10=function(e,t){return i("ceil",e,t)},t.exports=s},{}],137:[function(e,t,n){function i(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function s(e,t,n){var i=e.cloneRange(),s=i.text(),r=s.length,o=r-n;if(o<0){if(i.moveStart("character",o),!$.contains(t[0],i.commonAncestorContainer))return arguments.callee(e,t,n>>1);s=i.text()}return{text:s.substr(-r),prefix:s.substring(0,s.length-r)}}function r(e){return function(t){var n=t.nodeType==Node.TEXT_NODE;n&&(t=l.wrapTextNode(t));var i=t.getBoundingClientRect();n&&(t=l.unwrapTextNode(t));for(var s=new u(i.left,i.top,i.width,i.height),r=0;r<e.length;r++)if(s.intersects(e[r]))return!0;return!1}}function o(e){var t=rangy.createRange();return t.setStart(e.startNode,e.startNodeIndex),t.setEnd(e.endNode,e.endNodeIndex),t}function a(e,t){if(!e.length)return null;if(!t||!t.length)return o(e[0]);for(var n=null,i=0,s=r(t),a=0;a<e.length;a++){var c=o(e[a]),l=c.getNodes([Node.TEXT_NODE,Node.ELEMENT_NODE],s);l.length>i&&(i=l.length,n=c)}return n}function c(e,t){t=$.extend({matchFilter:null,insertWhitespace:!1,removeDiacritics:!1,matchTranslits:!1,matchCase:!1,matchBrokenTxt:!1,matchWeirdCitations:!1,matchMisconverted:!1,matchBrokenSpaces:!1,matchBrokenDigits:!1,boundingRects:null},t);var n=e.text,s=e.prefix;t.insertWhitespace&&(n=n.replace(/\s+/g,"").split("").join(" "),s=s.replace(/\s+/g,"").split("").join(" "));var r=i(n),o=i(s);if(t.removeDiacritics&&(r=h.remove(r)),t.matchTranslits){r=r.replace(/\\?[-]/gi,"."),r=r.replace(/([szc]{1})/gi,"$1[`'\"~]? ");var c=r.replace(/([aeiou]{1})/gi,".");c.replace(/[^a-z]/gi,"").length>3&&(r=c)}if(t.matchBrokenTxt&&e.text.match(/[a-z]+/i)&&e.text.match(/\d{4}/)&&(r=r.replace(/([a-z0-9]{1})/gi,"(?:$1|[^\\x20-\\x7F]{1})")),t.matchWeirdCitations&&(r=r.replace(/(| )/gi,"."),o=o.replace(/(\d+)\\\)/,"$1 \\)")),t.matchMisconverted){var l=o.replace(/(ff|fi|fl|[^\x00-\x7F])/gi,"(?:$1|.\\s?.?)"),u=r.replace(/(ff|fi|fl|[^\x00-\x7F])/gi,"(?:$1|.\\s?.?)");l.replace(/\\s/gi,"").replace(/[^a-z]/gi,"").length&&(o=l),u.replace(/\\s/gi,"").replace(/[^a-z]/gi,"").length&&(r=u)}t.matchBrokenDigits&&(r=r.replace(/\d+/g,"(?:[^\\x00-\\x7F]|\\d)+"),o=o.replace(/\d+/g,"(?:[^\\x00-\\x7F]|\\d)+")),t.matchBrokenSpaces&&(r=r.replace(/\s+/g,"(?:[^\\x00-\\x7F]|\\s)+"),o=o.replace(/\s+/g,"(?:[^\\x00-\\x7F]|\\s)+")),r="("+r.replace(/\s+/g,"\\s*")+")",o=o.replace(/\s+/g,"\\s*");var f=(t.matchCase?"":"i")+"g",m=new RegExp(o+"\\s*"+r,f),g=[];try{g=d(m,t.container[0],null,1)}catch(e){return null}t.matchFilter&&(g=$.grep(g,t.matchFilter));var v=a(g,t.boundingRects);return v&&p.test(v.toString())?v:null}var l=e("./util"),u=e("./rect"),d=e("./findtxt"),h=e("./diacritics"),p=new RegExp;t.exports={serialize:s,deserialize:c}},{"./diacritics":133,"./findtxt":134,"./rect":138,"./util":143}],138:[function(e,t,n){function i(e,t,n,i){this.left=e,this.top=t,this.width=n,this.height=i}i.prototype.intersects=function(e){return this.left<=e.left+e.width&&e.left<=this.left+this.width&&this.top<=e.top+e.height&&e.top<=this.top+this.height},i.prototype.boundingRect=function(e){var t=Math.max(this.left+this.width,e.left+e.width),n=Math.max(this.top+this.height,e.top+e.height);this.left=Math.min(this.left,e.left),this.top=Math.min(this.top,e.top),this.width=t-this.left,this.height=n-this.top},i.prototype.translate=function(e,t){return this.left+=e,this.top+=t,this},i.prototype.scale=function(e,t){return this.left*=e,this.width*=e,this.top*=t,this.height*=t,this},i.prototype.clone=function(){return new i(this.left,this.top,this.width,this.height)},t.exports=i},{}],139:[function(e,t,n){function i(e){return window[e+"Storage"]}function s(e,t){try{return i(e).getItem(t)}catch(e){return null}}function r(e,t,n){try{return i(e).setItem(t,n)}catch(e){}}function o(e,t){try{return i(e).removeItem(t)}catch(e){}}function a(e){try{return i(e).clear()}catch(e){}}var c={},l={};r("local","availability-test",!0),r("session","availability-test",!0),c.get=_.partial(s,"local"),c.set=_.partial(r,"local"),c.remove=_.partial(o,"local"),c.clear=_.partial(a,"local"),c.available=!!s("local","availability-test"),l.get=_.partial(s,"session"),l.set=_.partial(r,"session"),l.remove=_.partial(o,"session"),l.clear=_.partial(a,"session"),l.available=!!s("session","availability-test"),t.exports={local:c,session:l}},{}],140:[function(e,t,n){function i(){var e=document.getElementsByTagName("body")[0],t=document.createElement("div");t.style.position="absolute",t.style.visibility="hidden",t.style.fontFamily='"Georgia"',t.innerHTML="PICS",e.appendChild(t);var n=10,i=4,s=.1;t.style.fontSize=n+"px";var r=t.offsetWidth;t.style.fontSize=n*i+"px";var o=t.offsetWidth;return e.removeChild(t),Math.abs(o/r-i)<s}t.exports=i},{}],141:[function(e,t,n){function i(e,t){if(!e.translate)return"";var n=e.translate.x.toFixed(a),i=e.translate.y.toFixed(a);return t?"translate3d("+n+"px, "+i+"px, 0)":"translate("+n+"px, "+i+"px)"}function s(e){return e.scale?"scale("+e.scale.toFixed(a)+")":""}function r(e,t){return[i(e,t),s(e)].join(" ")}function o(e){return e?e.x.toFixed(a)+"px "+e.y.toFixed(a)+"px 0":""}var a=5;t.exports={getCssTransformOrigin:o,getCssTransform:r}},{}],142:[function(e,t,n){function i(e,t){this._elem=e,this._opts=t,this._mc=null,this._startX=null,this._startY=null,this._panDirectioon=null,this._initScale=null,this._minScale=null,this._maxScale=null,this._transform=null,this._transformOrigin=null,this._ticking=null,this._scaling=null,this._translating=null,this._swiping=null,this._offsetWidth=null,this._offsetHeight=null,this._dbltapScale=null,this._init()}var s=e("./transform_helper"),r=4,o=8,a=12;i.prototype={_init:function(){this._dbltapScale=.5,this._offsetWidth=this._elem.offsetWidth,this._offsetHeight=this._elem.offsetHeight,this._initTransform(),this._mc=new Hammer.Manager(this._elem,{preventDefault:!0,recognizers:[[Hammer.Pan,{pointers:0}],[Hammer.Pinch,{},["pan"]],[Hammer.Tap,{event:"doubletap",posThreshold:20,threshold:10,taps:2},["pan"]]]}),this._mc.on("pinchstart",this._onPinchStart.bind(this)),this._mc.on("panstart panmove",this._onPan.bind(this)),this._mc.on("pinchstart pinchmove",this._onPinch.bind(this)),this._mc.on("doubletap",this._onDoubleTap.bind(this)),this._mc.on("hammer.input",this._onInput.bind(this)),this._finalizeElementTransform()},_initTransform:function(){this._startX=0,this._startY=0,this._initScale=this._opts.scale||1,this._minScale=this._initScale,this._maxScale=this._initScale*r,this._transformOrigin={x:0,y:0},this._transform={translate:{x:this._startX,y:this._startY},scale:this._initScale}},_onPan:function(e){this._translating=!0,this._setPanDirection(e);var t=this._panDirection==Hammer.DIRECTION_VERTICAL?0:e.deltaX,n=this._panDirection==Hammer.DIRECTION_HORIZONTAL?0:e.deltaY,i={x:this._startX+t,y:this._startY+n},s=this._setTransfromTranslate(i,this._panDirection==Hammer.DIRECTION_HORIZONTAL);(e.panOutX=i.x-s.x)&&(this._swiping=!0),this._requestElementTransform()},_onPinchStart:function(e){this._setTransformOrigin(e.center)},_onPinch:function(e){this._scaling=!0;var t=this._swiping?1:e.scale;this._setTransformScale(this._initScale*t),this._requestElementTransform()},_onDoubleTap:function(e){this._dbltapScale=1/this._dbltapScale,this._setTransformOrigin(e.center),this._setTransformScale(this._transform.scale*this._dbltapScale),this._finalizeElementTransform(!0)},_onInput:function(e){e.isFirst&&this._elem.classList.remove("animate"),e.isFinal&&(this._scaling||this._translating)&&(this._setTransformOrigin(),this._setElementTransform(),this._addTranslateInertia(e),this._finalizeElementTransform(!0),this._translating=null,this._scaling=null,this._swiping=null,this._panDirection=null)},_setPanDirection:function(e){this._scaling&&!this._swiping?this._panDirection=Hammer.DIRECTION_ALL:this._panDirection||(this._offsetHeight*this._transform.scale<=this._opts.viewport.height?this._panDirection=Hammer.DIRECTION_HORIZONTAL:Math.abs(e.deltaY)<o&&Math.abs(e.deltaX)>a?this._panDirection=Hammer.DIRECTION_HORIZONTAL:Math.abs(e.deltaX)<o&&Math.abs(e.deltaY)>a?this._panDirection=Hammer.DIRECTION_VERTICAL:Math.abs(e.deltaX)>=o&&Math.abs(e.deltaY)>=o&&(this._panDirection=Hammer.DIRECTION_ALL))},_finalizeElementTransform:function(e){this._setTransformOrigin(),this._setTransfromTranslate(this._transform.translate,!0),this._updateStartValues(),this._elem.classList.toggle("animate",!!e),this._setElementTransform()},_setTransformOrigin:function(e){var t=this._elem.getBoundingClientRect(),n=e?{x:(e.x-t.left)/this._transform.scale,y:(e.y-t.top)/this._transform.scale}:{x:0,y:0},i=(n.x-this._transformOrigin.x)*(this._transform.scale-1),s=(n.y-this._transformOrigin.y)*(this._transform.scale-1);this._transformOrigin=n,this._transform.translate.x+=i,this._transform.translate.y+=s,this._initScale=this._transform.scale,this._startX+=i,this._startY+=s},_setTransformScale:function(e){e=Math.min(e,this._maxScale),e=Math.max(e,this._minScale),this._transform.scale=e},_setTransfromTranslate:function(e,t){return t&&(e=this._clipTranslate(e)),this._transform.translate=e},_clipTranslate:function(e){e={x:e.x,y:e.y};var t=this._offsetWidth*this._transform.scale,n=this._offsetHeight*this._transform.scale,i=this._transformOrigin.x*(this._transform.scale-1),s=this._transformOrigin.y*(this._transform.scale-1),r=this._opts.viewport.width-t,o=this._opts.viewport.height-n;return t>this._opts.viewport.width?(e.x=Math.max(e.x,i+r),e.x=Math.min(e.x,i)):e.x=i+r/2,n>this._opts.viewport.height?(e.y=Math.max(e.y,s+o),e.y=Math.min(e.y,s)):e.y=s+o/2,e},_setElementTransform:function(){var e=this._scaling||this._translating;this._elem.style.transformOrigin=s.getCssTransformOrigin(this._transformOrigin),this._elem.style.transform=s.getCssTransform(this._transform,e)},_requestElementTransform:function(){var e=this;this._ticking||(this._ticking=!0,requestAnimationFrame(function(){e._setElementTransform(),e._ticking=!1}))},_updateStartValues:function(){this._startX=this._transform.translate.x,this._startY=this._transform.translate.y,this._initScale=this._transform.scale},_addTranslateInertia:function(e){if(!this._scaling){var t=100*e.velocityX,n=100*e.velocityY;Math.max(Math.abs(t),Math.abs(n))<10&&(t=n=0),this._panDirection==Hammer.DIRECTION_VERTICAL&&(t=0),this._anDirection==Hammer.DIRECTION_HORIZONTAL&&(n=0),this._transform.translate.x+=t,this._transform.translate.y+=n}},resize:function(e){var t=e.width/this._opts.viewport.width;this._opts.viewport=e,this._initScale*=t,this._minScale*=t,this._maxScale*=t,this._offsetWidth=this._elem.offsetWidth,this._offsetHeight=this._elem.offsetHeight,this._setTransformOrigin({x:this._opts.viewport.left,y:this._opts.viewport.top}),this._setTransformScale(this._transform.scale*t),this._finalizeElementTransform()},reset:function(e){this._opts.scale=e,this._initTransform(),this._finalizeElementTransform()},destroy:function(){this._mc.destroy(),this._mc=null,this._elem=null,this._opts=null,this._startX=null,this._startY=null,this._panDirectioon=null,this._initScale=null,this._minScale=null,this._maxScale=null,this._transform=null,this._transformOrigin=null,this._ticking=null,this._scaling=null,this._translating=null,this._swiping=null,this._offsetWidth=null,this._offsetHeight=null,this._dbltapScale=null},get hammer(){return this._mc}},t.exports=i},{"./transform_helper":141}],143:[function(e,t,n){function i(){return!D.production()||O.local.get("readcube-console-log")}function s(){try{Array.prototype.unshift.call(arguments,"[READCUBE]"),i()&&console.log.apply(console,arguments)}catch(e){}}function r(e){return $.extend(!0,{},e)}function o(){return Array.prototype.splice.call(arguments,0,0,!0,{}),$.extend.apply($,arguments)}function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}function c(e){var t=[];for(var n in e)t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}function l(e,t){var n=e.split("#");return n[0]+=n[0].indexOf("?")==-1?"?":"&",n[0]+=c(t),n.join("#")}function u(e,t,n){$("<link>",{rel:"stylesheet",type:"text/css",href:e}).error(n||_.noop).load(t||_.noop).appendTo("head")}function d(e,t){var n=document.createElement("script");n.onload=t||_.noop,n.src=e,document.getElementsByTagName("head").item(0).appendChild(n)}function h(e){try{var t=e.scrollParent();return t.is(document)&&(t=$("body")),t}catch(e){return $("body")}}function p(e){var t=document.createElement("div");return t.setAttribute("style",["position:absolute","top:"+e.top+"px","left:"+e.left+"px","width:"+e.width+"px","height:"+e.height+"px"].join(";")),t}function f(e){for(var t={top:+(1/0),left:+(1/0),bottom:-(1/0),right:-(1/0)},n=0;n<e.length;n++){var i=e[n].getBoundingClientRect();t.top=Math.min(t.top,i.top),t.left=Math.min(t.left,i.left),t.bottom=Math.max(t.bottom,i.bottom),t.right=Math.max(t.right,i.right)}return t.width=t.right-t.left,t.height=t.bottom-t.top,t}function m(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}function g(){var e=m();return!!e&&document[e]}function v(e){return"undefined"==typeof e?(new Date).toISOString():new Date(e).toISOString()}function w(e){var t={};if(!e)return t;for(var n=0;n<e.length;n++)t[e[n].id]=e[n];return t}function b(e){var t=[];if(!e)return t;for(var n in e)t.push(e[n]);return t}function y(e,t){return _.pick(_.pick(e,t||_.keys(e)),function(e){return"undefined"!=typeof e})}function k(e,t){var n={};for(var i in e)if(i in t)if(_.isObject(t[i])&&!_.isArray(t[i])){var s=k(e[i],t[i]);_.isEmpty(s)||(n[i]=s)}else _.isEqual(e[i],t[i])||(n[i]=t[i]);for(var i in t)i in e||(n[i]=t[i]);return n}function x(e){var t=document.createElement("span");return e.parentNode.insertBefore(t,e),t.appendChild(e),t}function C(e){var t=e.firstChild;return e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e),t}function T(e){return e.textContent&&/[^\s]/.test(e.textContent)}function A(e){var t=!1;return e.each(function(){if(T(this)&&P($(this).css("color")))return t=!0,!1}),t}function E(e,t){var n=e.commonAncestorContainer;return n.nodeType==Node.TEXT_NODE&&(n=n.parentNode.parentNode),t?$(n).find("."+t):(t=a(),rangy.createClassApplier(t).applyToRange(e),$(n).find("."+t).removeClass(t))}function j(){try{return window.self!==window.top}catch(e){return!0}}function S(e){j()?window.parent.postMessage({type:"redirect",url:e},"*"):location.href=e}function X(){j()?location.href=l(location.href,{autoboot:1}):location.reload()}function Y(e,t){return(window.readcube||{})[e]||t}function I(){var e="reader-referrer-"+CryptoJS.MD5(location.href).toString(),t=O.session.get(e);return t?t:(t=parseUri(location.href).queryKey.referrer_host,t=t||Y("referrer"),t=t||parseUri(document.referrer).host,t&&O.session.set(e,t),t)}function P(e){return/transparent|rgba\(.+,\s?0\)/.test(e)}function R(){var e="(-webkit-min-device-pixel-ratio: 1.5), (min--moz-device-pixel-ratio: 1.5), (-o-min-device-pixel-ratio: 3/2), (min-resolution: 1.5dppx)";return window.devicePixelRatio>1||!(!window.matchMedia||!window.matchMedia(e).matches);
}function N(e,t){return"PDF "+e.fingerprint+" ["+t.info.PDFFormatVersion+" "+(t.info.Producer||"-").trim()+" / "+(t.info.Creator||"-").trim()+"] (PDF.js: "+(PDFJS.version||"-")+(PDFJS.disableWebGL?"":" [WebGL]")+")"}var O=e("./storage"),D=e("../environment"),F=function(){var e={};return{tic:function(){var t=a();return e[t]=Date.now(),t},toc:function(t){var n=Date.now()-e[t];return delete e[t],n}}}();t.exports={log:s,guid:a,clone:r,merge:o,timer:F,loadCss:u,loadScript:d,addParams:l,scrollParent:h,divFromRect:p,getBoundingRect:f,wrapTextNode:x,unwrapTextNode:C,getElems:E,docHidden:g,arrayToHash:w,hashToArray:b,pickDefined:y,dateISO:v,objDiff:k,reload:X,redirectOrPost:S,referrerHost:I,hasTransparentText:A,isRetina:R,pdfjsInfo:N,readcube:Y}},{"../environment":96,"./storage":139}],144:[function(e,t,n){function i(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}function s(){var e=i();return!!e&&document[e]}function r(e){var t=i();if(t){var n=t.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(n,e)}}function o(){return new Promise(function(e){e=_.once(e),s()?r(function(){s()||e()}):e()})}var a={};a.isHidden=s,a.onChange=r,a.visible=o,t.exports=a},{}],145:[function(e,t,n){var i=e("../utils/rect"),s=(e("../utils/util"),function(e){this._dimensions=e.dimensions,this._container=e.container,this._text=e.text,this._urls=e.urls,this._page=this._createPage(),this._scale=1,this._scalePage(),this._page.appendTo(this._container),this._drawable=$('<div class="drawable"></div>'),this._eventable=$('<div class="eventable"></div>')});s.prototype={_createPage:function(){var e=this;return $(['<div class="pf w0 h0">','<img class="cover page-bg" alt="" src="'+this._urls.url+'">',"</div>"].join("")).click(function(){window.open(e._urls.link)})},_scalePage:function(){this._page.css({width:this._dimensions.width*this._scale,height:this._dimensions.height*this._scale,margin:this._dimensions.margin*this._scale+"px auto"})},setUrls:function(e){},updateUrls:function(e){},hasAccess:function(){return!0},hasText:function(){return!1},fullyLoaded:function(){return!0},load:function(e){e()},scale:function(e){this._scale!=e&&(this._scale=e,this._scalePage())},rotateBy:function(e){var t=this;this._deg=(this._deg||0)+Math.floor(e),this._page.css({transition:"all .2s ease",transform:"rotate("+this._deg+"deg)"}),setTimeout(function(){t._page.css("transition","none")},200)},updateVisible:function(){var e=this._container[0].getBoundingClientRect(),t=this._page[0].getBoundingClientRect();this._visible=i.prototype.intersects.call(e,t),this._page.toggleClass("open",this._visible)},isVisible:function(){return this._visible},getElem:function(){return this._page},getWidth:function(){return this._dimensions.width},getHeight:function(){return this._dimensions.height},getMargin:function(){return this._dimensions.margin},getScale:function(){return this._scale},getZoom:function(){return this._dimensions.zoom},getNormRect:function(){var e=this._page[0].getBoundingClientRect();return new i(e.left,e.top,this._dimensions.width,this._dimensions.height)},getDrawable:function(){return this._drawable},getEventable:function(){return this._eventable},hasTransparentText:function(){return!1},onLoaded:function(e){e()},destroy:function(){this._page.remove()}},t.exports=s},{"../utils/rect":138,"../utils/util":143}],146:[function(e,t,n){function i(e){function t(e){1==++d&&$(l).trigger("loading-start")}function n(e,t){t&&!h[e]&&(++u,h[e]=!0,$(l).trigger("page-loaded",[e])),0==--d&&$(l).trigger("loading-stop")}function i(i,s,r){t(i),e[i].load(function(){n(i,!0),s&&s()},function(){n(i,!1),r&&r()})}function s(t,n){for(var s=0,r=!1,o=0;o<e.length;o++)i(o,function(){++s==e.length&&t&&t()},function(){r||(r=!0,n&&n())})}function r(){for(var t=0;t<e.length;t++)e[t].isVisible()&&i(t)}function o(t,n){p=!1,n=n||f;for(var s=Math.min(e.length,1+2*n),r=[t],o=0,a=1;r.length<s;a++){var c=t-a,l=t+a;c>=0&&r.push(c),l<e.length&&r.push(l)}!function(){if(!(p||o>=s)){var e=arguments.callee,t=r[o];i(t,function(){++o,e()})}}()}function a(){p=!0}function c(){return u}var l={},u=0,d=0,h={},p=!1,f=2;return l.loadAll=s,l.loadVisible=r,l.preloadPages=o,l.stopPreloading=a,l.getLoadedCnt=c,l}t.exports=i},{}],147:[function(e,t,n){function i(e){this._visible=!1,this._data=e,this._elem=this._createElem(),this._loader=this._createLoader(),this._img=this._elem.find("img.full").contextmenu(!1),this._tmb=this._elem.find("img.thumb").contextmenu(!1),this._tr=new r(this._elem[0],{viewport:this._data.container[0].getBoundingClientRect(),scale:this._getScale()}),this._init()}var s=(e("../utils/util"),e("../utils/rect")),r=e("../utils/transformable");i.prototype={_init:function(){var e=this;0==this._data.index?this._img.load(function(){e._tmb[0].src=e._data.thumb}):this._tmb[0].src=this._data.thumb},_getScale:function(){return this._data.container.width()/this._data.dimensions.width},_createElem:function(){return $('<div class="page">\n        <img class="bg thumb">\n        <img class="bg full">\n        <div class="drawable"></div>\n        <div class="eventable"></div>\n      </div>').css({width:this._data.dimensions.width,height:this._data.dimensions.height}).appendTo(this._data.container)},_createLoader:function(){return $('<div class="loader">\n        <div class="loader-inner ball-pulse">\n          <div></div>\n          <div></div>\n          <div></div>\n        </div>\n      </div>').appendTo(this._data.container)},_show:function(){var e=this;this._data.full&&this._data.full!=this._img[0].src&&(this._img.load(function(){return e._loader.remove()}),this._loader[0].style.display="block",this._img[0].src=this._data.full),this._img[0].style.display="block"},_hide:function(){this._img[0].style.display="none"},setUrls:function(e){this._data.full=this._data.full||e.full,this._visible&&this._show()},reset:function(){this._tr.reset(this._getScale())},resize:function(){this._tr.resize(this._data.container[0].getBoundingClientRect())},updateVisible:function(e){(this._visible=e)?this._show():this._hide()},getElem:function(){return this._elem},getWidth:function(){return this._data.dimensions.width/this._data.dimensions.zoom},getHeight:function(){return this._data.dimensions.height/this._data.dimensions.zoom},getZoom:function(){return this._data.dimensions.zoom},getNormRect:function(){var e=this._elem[0].getBoundingClientRect();return new s(e.left,e.top,this.getWidth(),this.getHeight())},getDrawable:function(){return this._elem.find(".drawable")},getEventable:function(){return this._elem.find(".eventable")},hasText:function(){return!0},hasTransparentText:function(){return!0},get hammer(){return this._tr.hammer}},t.exports=i},{"../utils/rect":138,"../utils/transformable":142,"../utils/util":143}],148:[function(e,t,n){function i(){return/iOS/i.test(Y.platform)?500:0}function s(e){z||(z=!0,requestAnimationFrame(function(){e(),z=!1}))}function r(e){H=e}function o(e,t){V[e]=t}function a(){var e=u();W.forEach(function(t,n){t.updateVisible(Math.abs(n-e)<2)})}function c(){var e={translate:{x:H,y:0}};B[0].style.transform=I.getCssTransform(e,!0),ee()}function l(){q.forEach(function(e,t){e[0].style.transform=I.getCssTransform({translate:{x:V[t],y:0}})})}function u(){return-H/T()}function d(e){L||(r(-e*T()),s(c),p("slide",e+1))}function h(e){return Math.min(W.length-1,Math.max(0,e))}function p(e,t){M&&(t?$(N).trigger(e,[t]):$(N).trigger(e))}function f(e){e.panOutX&&!L&&(r(-O*T()+e.panOutX),s(c))}function m(e){var t=0,n=u();if(n!=O&&Math.abs(e.velocityX)>Q)t=h(e.velocityX<0?O+1:O-1);else{var i=1/0;V.forEach(function(e,n){var s=Math.abs(-e-H);n==O&&(s+=.4*T()),s<i&&(t=n,i=s)}),t=Math.max(t,O-1),t=Math.min(t,O+1)}x(t)}function g(){W[O].hammer.off("pan",f),W[O].hammer.off("panend pancancel",m),W[O].hammer.on("pan",f),W[O].hammer.on("panend pancancel",m)}function v(){R=new Hammer.Manager(D[0]),R.add(new Hammer.Tap({event:"singletap"}));var e=R.get("singletap"),t=W[O].hammer.get("doubletap");e.requireFailure(t),g(),$(N).on("page-changed",function(){e.dropRequireFailure(t),t=W[O].hammer.get("doubletap"),e.requireFailure(t),g()})}function w(e){for(var t=$('<div class="page-container"></div>');e--;)q.push(t.clone().appendTo(B))}function b(){q.forEach(function(e,t){o(t,t*T())}),l()}function y(e){w(e.options.total_pages),b();for(var t=200/72,n=0;n<e.options.total_pages;n++){var i=e.sizes[n]||e.sizes[0];W.push(new P({index:n,full:e[F][n],thumb:e.yield_thumb(n),container:q[n],dimensions:{width:i[0],height:i[1],zoom:t}}))}x(0),v(),M=!0,p("initialized")}function k(e){W.forEach(function(t,n){t.setUrls({full:e[F][n]})}),a()}function x(e){if(!L){var t=W[O],n=W[O=h(e)];L=n!=t,U=!0,B.css("transition","transform "+G+"ms ease-out"),r(-e*T()),c(),setTimeout(function(){t&&L&&t.reset(),B.css("transition","none"),L=U=!1,p("page-changed",O+1)},G)}}function C(e){M?e():$(N).one("initialized",e)}function T(){return Z*J}function A(){var e=D.width();e!=Z&&(Z=e,r(-O*T()),c(),b(),W.forEach(function(e){return e.resize()}))}function E(e){D=$('<div class="viewer-inner"></div>').appendTo(e),B=$('<div class="sheet"></div>').appendTo(D),Z=D.width(),$(window).on("resize orientationchange",_.debounce(A,K))}function j(e){e=parseInt(e),isNaN(e)||(e=h(e),x(e))}function S(e){return W[e-1]}function X(e){for(var t=0;t<W.length;t++)if(!1===e(t+1,W[t]))return}var Y=(e("../utils/util"),e("../utils/browser"),e("../utils/mobile_detect")),I=e("../utils/transform_helper"),P=e("./mobile_page"),R=null,N=null,O=0,D=null,F="png",M=void 0,L=!1,U=!1,z=!1,B=null,H=0,W=[],q=[],V=[],J=1.02,Q=.4,G=350,K=i(),Z=screen.width,ee=_.debounce(a,100);N={init:E,onInit:C,setPreviewData:y,setFullData:k,getPageObj:S,eachPage:X,get initialized(){return M},get elem(){return D},get pages(){return W},get numPages(){return W.length},get curIndex(){return O+1},set curIndex(e){return j(e-1)},get slideIndex(){return u()+1},set slideIndex(e){return d(e-1)},get curPage(){return W[O]},get hammer(){return R}},window.viewer=N,t.exports=N},{"../utils/browser":131,"../utils/mobile_detect":135,"../utils/transform_helper":141,"../utils/util":143,"./mobile_page":147}],149:[function(e,t,n){var i=e("../utils/rect"),s=e("../utils/util"),r=e("../utils/browser"),o=e("promise-retry"),a={minTimeout:4e3,retries:2},c=function(e){this._dimensions=e.dimensions,this._container=e.container,this._text=e.text,this._urls=e.urls,this._init()};c.prototype={_init:function(){this._page=this._createPlaceholder(),this._bgLoaded=!1,this._catchevt=null,this._drawable=null,this._eventable=null,this._content=null,this._loading=!1,this._loaded=!1,this._jqxhr=null,this._scale=1,this._scalePage(),this._page.appendTo(this._container)},_createPlaceholder:function(){return $('<div class="pf w0 h0"></div>')},_setThumb:function(){var e=this;o(function(t){return new Promise(function(t,n){return e._urls.text?t():(e._page.find("img.bt").remove(),void $('<img class="bt" alt="" src="'+e._urls.thumb+'">').on("dragstart",!1).one("load",t).one("error",n).prependTo(e._page))}).catch(t)},a).catch(_.noop)},_setImageBg:function(){var e=this;o(function(t){return new Promise(function(t,n){e._content.find("img.page-bg").remove(),$('<img class="bf page-bg" alt="" src="'+e._urls.bg+'">').on("dragstart",!1).one("load",t).one("error",n).prependTo(e._content)}).then(function(){e._bgLoaded=!0}).catch(t)},a).catch(_.noop)},_setObjectBg:function(){var e=this;o(function(t,n){return new Promise(function(t,n){e._content.find("object.page-bg").remove();var i=$('<object class="bf page-bg" data="'+e._urls.bg+'"></object>').attr("type","image/svg+xml").on("dragstart",!1).prependTo(e._content);i[0].addEventListener("load",t),i[0].addEventListener("error",n)}).then(function(){e._bgLoaded=!0}).catch(t)},a).catch(_.noop)},_setBackground:function(){this._urls&&(this._page.find("img.bt").remove(),/chrome|safari/.test(r.name)?this._setObjectBg():this._setImageBg())},_scalePage:function(){if(this._page.css({width:this._dimensions.width*this._scale,height:this._dimensions.height*this._scale,margin:this._dimensions.margin*this._scale+"px auto"}),this._content){var e=this._scale/this._dimensions.zoom;this._content.css("transform","scale("+e.toFixed(5)+")")}},_createPage:function(e){this._content=$(e).find(".pc"),this._content.find("a").each(function(){var e=$(this),t=e.attr("href");/^http(s)?:\/\//.test(t)||e.attr("href","http://"+t.replace(/^\/+/,"")),e.text()||e.attr("aria-hidden","true"),e.attr("target","_blank")}),this._catchevt=$('<div class="bf"></div>'),this._drawable=$('<div class="drawable"></div>'),this._eventable=$('<div class="eventable"></div>'),this._content.prepend(this._drawable),this._content.prepend(this._catchevt),this._content.append(this._eventable),this._content.appendTo(this._page),this._scalePage(),this._setBackground()},_handleLoadSuccess:function(){this._jqxhr=null,this._loaded=!0,this._loading=!1,$(this).trigger("loaded")},_loadPage:function(){var e=this;this._text?(this._createPage(this._text),this._handleLoadSuccess()):this._urls.text?o(function(t){return new Promise(function(t,n){e._jqxhr=$.ajax({url:e._urls.text,dataType:"text",success:t,error:n})}).then(function(t){e._loading&&(e._createPage(t),e._handleLoadSuccess())}).catch(function(n){e._loading&&(/^4\d{2}$/.test(n.status)||t())})},a).catch(function(){e._loading=!1}):this._urls.thumb&&(this._setThumb(),this._handleLoadSuccess())},setUrls:function(e){!this._urls.text&&e.text&&(this._page.find("img").off("error"),this._jqxhr&&this._jqxhr.abort(),this._loading=!1,this._loaded=!1,this._jqxhr=null,this._urls=e)},updateUrls:function(e){this._urls=e},hasAccess:function(){return!!this._urls.text},hasText:function(){return!!this._content},fullyLoaded:function(){return!this.hasAccess()||this._bgLoaded&&this.hasText()},load:function(e,t){this.onLoaded(e),this._loaded||this._loading||(this._loading=!0,this._loadPage())},scale:function(e){this._scale!=e&&(this._scale=e,this._scalePage())},rotateBy:function(e){var t=this;this._deg=(this._deg||0)+Math.floor(e),this._page.css({transition:"all .2s ease",transform:"rotate("+this._deg+"deg)"}),setTimeout(function(){t._page.css("transition","none")},200)},updateVisible:function(){var e=this._container[0].getBoundingClientRect(),t=this._page[0].getBoundingClientRect();this._visible=i.prototype.intersects.call(e,t),this._page.toggleClass("open",this._visible)},isVisible:function(){return this._visible},getElem:function(){return this._page},getWidth:function(){return this._dimensions.width},getHeight:function(){return this._dimensions.height},getMargin:function(){return this._dimensions.margin},getScale:function(){return this._scale},getZoom:function(){return this._dimensions.zoom},getNormRect:function(){var e=this._page[0].getBoundingClientRect();return new i(e.left,e.top,this._dimensions.width,this._dimensions.height)},getDrawable:function(){return this._drawable},getEventable:function(){return this._eventable},hasTransparentText:function(){return s.hasTransparentText(this._page.find(".t"))},onLoaded:function(e){e=e||function(){},this._loaded&&e(),$(this).on("loaded",e)},destroy:function(){this._page.remove()}},t.exports=c},{"../utils/browser":131,"../utils/rect":138,"../utils/util":143,"promise-retry":40}],150:[function(e,t,n){var i=e("../utils/util"),s=e("../utils/rect"),r=4,o=window.devicePixelRatio,a=function(e){var t=e.page.getViewport(1);this._index=e.index,this._dimensions={height:t.height,width:t.width,margin:e.margin},this._container=e.container,this._pgObj=e.page,this._init()};a.prototype={_init:function(){this._scale=1,this._dirty=!1,this._loaded=!1,this._loading=!1,this._page=$('<div class="pf pdfjs-page"></div>'),this._background=$("<div></div>").appendTo(this._page),this._drawable=$('<div class="drawable"></div>'),this._eventable=$('<div class="eventable"></div>'),this._page.append(this._drawable),this._page.append(this._eventable),this._page.appendTo(this._container),this._scalePage(),this.updateVisible()},_rescaleBg:function(){var e=this._pgObj.getViewport(this._scale),t=parseFloat(this._background.attr("width"));this._background.css({transform:"scale("+e.width*o/t+")","transform-origin":"0 0"})},_renderCanvas:function(){var e=this,t=this._pgObj.getViewport(this._scale),n=document.createElement("canvas");return n.height=t.height*o,n.width=t.width*o,$(n).hide().css({position:"absolute",width:t.width,height:t.height}).prependTo(this._page),this._pgObj.render({canvasContext:n.getContext("2d"),transform:[o,0,0,o,0,0],viewport:t}).then(function(){e._background.replaceWith(n),e._background=$(n).show()})},_renderText:function(){if(this._text)return this._text.css("transform","scale("+this._scale/r+")"),Promise.resolve();var e=this,t=this._pgObj.getViewport(r);return this._text=$('<div class="textLayer"></div>').insertAfter(this._drawable).css({width:t.width,height:t.height,transform:"scale("+this._scale/r+")","transform-origin":"0 0"}),this._pgObj.getTextContent({normalizeWhitespace:!0}).then(function(n){return PDFJS.renderTextLayer({textContent:n,viewport:t,container:e._text[0]})})},_skipRender:function(){return!this._loaded||(!this._visible||(!this._dirty||void 0))},_render:function(e){if(!e&&this._skipRender())return Promise.resolve();this._dirty=!1;var t=this,n=i.timer.tic();return Promise.all([this._renderCanvas(),this._renderText()]).finally(function(){i.log(sprintf("render page (%s): %s ms",t._index,i.timer.toc(n)))})},_scalePage:function(){this._dirty=!0,this._page.css({width:this._dimensions.width*this._scale,height:this._dimensions.height*this._scale,margin:this._dimensions.margin*this._scale+"px auto"}),this._drawable.add(this._eventable).css({transform:"scale("+this._scale+")","transform-origin":"0 0"}),this._rescaleBg(),this._render()},hasAccess:function(){return!0},hasText:function(){return this._loaded},fullyLoaded:function(){return this._loaded},load:function(e,t){var n=this;this.onLoaded(e),this._loaded||this._loading||(this._loading=!0,this._render(!0).then(function(){n._loaded=!0,n._loading=!1,$(n).trigger("loaded")}))},scale:function(e){this._scale!=e&&(this._scale=e,this._scalePage())},rotateBy:function(e){var t=this;this._deg=(this._deg||0)+Math.floor(e),this._page.css({transition:"all .2s ease",transform:"rotate("+this._deg+"deg)"}),setTimeout(function(){t._page.css("transition","none")},200)},updateVisible:function(){var e=this._container[0].getBoundingClientRect(),t=this._page[0].getBoundingClientRect();this._visible=s.prototype.intersects.call(e,t),this._page.toggleClass("open",this._visible),this._render()},isVisible:function(){return this._visible},getElem:function(){return this._page},getWidth:function(){return this._dimensions.width},getHeight:function(){return this._dimensions.height},getMargin:function(){return this._dimensions.margin},getZoom:function(){return 1},getScale:function(){return this._scale},getNormRect:function(){var e=this._page[0].getBoundingClientRect();return new s(e.left,e.top,this._dimensions.width,this._dimensions.height)},getDrawable:function(){return this._drawable},getEventable:function(){return this._eventable},hasTransparentText:function(){return!0},onLoaded:function(e){this._loaded&&e(),$(this).on("loaded",e)},destroy:function(){this._page.remove()}},t.exports=a},{"../utils/rect":138,"../utils/util":143}],151:[function(e,t,n){function i(e,t){ee&&(t?$(Q).trigger(e,[t]):$(Q).trigger(e))}function s(){K=W(G),$(K).on({"page-loaded.viewer":function(e,t){K.getLoadedCnt()>=G.length&&oe.off("scroll.loader"),i("page-loaded",t+1)},"loading-start.viewer":function(){i("loading-start")},"loading-stop.viewer":function(){i("loading-stop")}})}function r(e){return Math.min(G.length-1e-9,Math.max(0,e))}function o(){var e=parseInt(oe.css("padding-left")),t=parseInt(oe.css("padding-right"));return oe[0].getBoundingClientRect().width-e-t}function a(){return 0}function c(){return oe.height()}function l(){return c()/(G[se].getHeight()+re)/ie}function u(){var e,t=0,n=(oe.scrollTop()-a())/ie;for(e=0;e<G.length&&(t+=G[e].getHeight()+re,!(t>n));e++);var i=(t-n)/(G[e].getHeight()+re);return e+(1-i)}function d(e){var t,n=e>0?Math.floor(e):Math.ceil(e),i=e-n,s=0;for(t=0;t<n;t++)s+=G[t].getHeight()+re;return s+=i*(G[t].getHeight()+re),Math.round(s*ie)+a()}function h(e,t){var n=d(e);t&&(n+=re/2),oe.scrollTop(n),m(),i("scroll")}function p(){return r(u()+l()/2)}function f(){var e=Math.floor(p());se!=e&&(se=e,i("page-changed",e+1)),i("scroll")}function m(){K.stopPreloading(),K.loadVisible()}function g(){K.preloadPages(Math.floor(p()))}function v(){oe[0].style.display="block"}function w(){v(),G.forEach(function(e){e.updateVisible()})}function b(){y(),oe.on("scroll.update",_.throttle(f,100)),oe.on("scroll.render",_.debounce(w,100)),oe.on("scroll.loader",_.debounce(m,200)),oe.on("scroll.loader",_.debounce(g,1e3))}function y(){oe.off("scroll.update"),oe.off("scroll.render"),oe.off("scroll.loader")}function k(e){return T(e/G[0].getWidth())}function x(e,t){e?(clearInterval(te),te=setInterval(t,500),t()):t()}function C(){clearInterval(te),te=null}function T(e){var t=u();e<=0&&(e=1),ie=e,G.forEach(function(t){t.scale(e)}),h(t),v(),i("scale")}function A(e,t){t=parseInt(t)||se,G[t].rotateBy(e),v(),i("rotate")}function E(e){T(ie*e)}function j(e){x(e,function(){T(o()/G[se].getWidth())})}function S(){var e=o()/G[se].getWidth();e<ie&&j()}function X(e){x(e,function(){var e=o()/G[se].getWidth(),t=c()/(G[se].getHeight()+re);T(Math.min(e,t))})}function Y(e){ee?e():$(Q).one("initialized",e)}function I(e){return e.text&&e.text.length?new Promise(function(t,n){$.ajax({url:e.text[0],dataType:"text",success:t,error:function(e){(trackJs||window).console.log(sprintf("first page failed, status: %s, statusText: %s, readyState: %s",e.status,e.statusText,e.readyState)),n({error:"load_html_fail"})}})}):Promise.reject({error:"load_html_fail"})}function P(e){return e.stylesheet_linked?Promise.resolve():e.stylesheet?new Promise(function(t,n){B.loadCss(e.stylesheet,t,function(){n({error:"load_html_fail"})})}):Promise.reject({error:"load_html_fail"})}function R(){"fit-width"==ne?j():"fit-page"==ne?X():k(Math.min(ne,o())),oe.scrollTop(0)}function N(){for(;G.length;)G.pop().destroy()}function O(e,t,n,i){var s=t.size||t.sizes[n],r={container:oe,dimensions:{zoom:t.zoom,height:s[1],width:s[0],margin:re},urls:{thumb:e.yield_thumb(n),text:e.text[n],bg:e.background[n]}};return i&&(r.text=i),new H(r)}function D(e,t,n){var i=t.size||t.sizes[n];return new V({urls:e.cover,container:oe,dimensions:{zoom:t.zoom,height:i[1],width:i[0],margin:re}})}function F(e){return Promise.all([I(e),P(e)]).then(function(t){var n=t[0],r=$(n).data("pages"),o=r.length;s(),N(),e.cover&&G.push(D(e,r,0)),G.push(O(e,r,0,n));for(var a=1;a<o;a++)G.push(O(e,r,a));R(),b(),g(),w(),ee=!0,i("initialized")})}function M(e){J().then(function(){PDFJS.getDocument(e.viewer_pdf).then(function(e){e.getMetadata().then(function(t){B.log(B.pdfjsInfo(e,t))});for(var t=[],n=Promise.resolve(),r=1,o=e.numPages;r<=o;r++)n=n.then(e.getPage.bind(e,r)).then(function(e){t.push(e)});n.then(function(){s(),N(),t.forEach(function(e,t){G.push(new q({index:t+1,container:oe,margin:re,page:e}))}),R(),b(),g(),w(),ee=!0,i("initialized")})})})}function L(e){Y(function(){G.slice(e.cover?1:0).forEach(function(t,n){t.updateUrls({thumb:e.yield_thumb(n),text:e.text[n],bg:e.background[n]})})})}function U(e){return U.called?void L(e):(U.called=!0,void Y(function(){G.slice(e.cover?1:0).forEach(function(t,n){t.setUrls({thumb:e.yield_thumb(n),text:e.text[n],bg:e.background[n]})}),s(),b(),g(),w()}))}function z(e){oe=e,Z=oe.find("#journal-banner"),advert=oe.find("#advert-leaderboard"),oe.on("click",function(e){oe.is(e.target)&&i("bg-click")}),s(),G=[new H({container:oe,text:"<div></div>",dimensions:{width:ne,height:1200,margin:12,zoom:1}})],R()}var B=e("../utils/util"),H=e("./page"),W=e("./loader"),q=e("./pdfjs_page"),V=e("./cover_page"),J=e("../includes/load_pdfjs"),Q={},G=[],K=null,Z=null,ee=!1,te=null,ne=900,ie=1,se=0,re=8,oe=null;Q.init=z,Q.onInit=Y,Q.setPreviewData=F,Q.setFullData=U,Q.setLocalData=M,Q.fitPage=function(e){if(ee)return X(e)},Q.shrinkToWidth=function(){if(ee)return S()},Q.fitWidth=function(e){if(ee)return j(e)},Q.getElem=function(){if(ee)return oe},Q.getPage=function(){return ee?se+1:0},Q.getPageObj=function(e){if(ee)return G[e-1]},Q.eachPage=function(e){if(ee)for(var t=0;t<G.length;t++)if(!1===e(t+1,G[t]))return},Q.eachVisiblePage=function(e){if(ee)for(var t=0;t<G.length;t++)if(G[t].isVisible()&&!1===e(t+1,G[t]))return},Q.gotoPage=function(e){if(ee&&(e=parseFloat(e),!isNaN(e)))return h(r(e-1),!0)},Q.loadAll=function(e,t){ee&&K.loadAll(e,t)},Q.numPages=function(){return ee?G.length:0},Q.numVisiblePages=function(){return ee?l():0},Q.scaleBy=function(e){if(ee)return C(),E(e)},Q.scaleTo=function(e){if(ee)return C(),T(e)},Q.rotatePageBy=function(e,t){if(ee)return A(e,t)},window.viewer=Q,t.exports=Q},{"../includes/load_pdfjs":107,"../utils/util":143,"./cover_page":145,"./loader":146,"./page":149,"./pdfjs_page":150}],152:[function(e,t,n){function i(t,n,i,s,r){return{restrict:"A",link:function(o,a,c){function l(){a.find("iframe").length&&(a.data("iframe-width")||a.data("iframe-width",a.find("iframe").width()),a.toggleClass("hidden",a.width()<a.data("iframe-width")))}t.parent&&s.onInit(function(s){if("wiley"==s.publisher){var o=parseUri(t.parent).host;n.production()&&"qae.onlinelibrary.wiley.com"!=o||(googletag=e("../core/includes/gpt"),$(i.all).on("ad_data",function(e,t){var n=t.data;if(n){var i=["",n.network_id,n.subject_id,n.journal_id].join("/");googletag.cmd.push(function(){var e=googletag.sizeMapping().addSize([768,100],[728,90]).addSize([340,100],[300,50]).build();googletag.defineSlot(i,[[728,90],[300,50]],"advert-leaderboard").defineSizeMapping(e).setCollapseEmptyDiv(!0).addService(googletag.pubads()),_.each(n.targeting,function(e,t){googletag.pubads().setTargeting(t,e)}),googletag.pubads().enableSingleRequest(),googletag.enableServices(),googletag.display("advert-leaderboard"),$(r).on("scale",l),$(window).on("resize",_.debounce(l,100)),l()})}}),window.parent.postMessage({type:"get_ad_data"},"*"))}})}}}i.$inject=["endpoint","environment","receiver","article","viewer"],angular.module("reader").directive("advertLeaderboard",i)},{"../core/includes/gpt":104}],153:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c,l,u){function d(e){return _.max(e,function(e){return e[1]})[1]}function h(e){var t=e.page_start+1,n=r.getPageObj(t);if(n){var i=n.getHeight(),s=(i-d(e.rects))/i;return t+s}return 0}function p(e){return new Date(e.created)}function f(e){return new Date(e.modified||e.created)}function m(){if(!s.get().doi)return"notes";var e=o.getKey(s.get().meta);return"supplement"==s.getType()&&(e+=sprintf("-supplement(%s)",s.get().index+1)),e+"-notes"}function g(){return $(document.body).hasClass("annotations-open")}function v(){g()||(a.sidepanel("notes"),$(document.body).addClass("annotations-open"),n.$emit("annotations-opened"))}function w(){g()&&($(document.body).removeClass("annotations-open"),n.$emit("annotations-closed"))}function b(){g()?w():v()}return n.$on("toggle-annotations",b),n.$on("open-annotations",v),n.$on("close-annotations",w),n.$on("checkout-opened",w),n.$on("info-opened",w),{restrict:"E",link:function(n,s){r.onInit(function(){n.annots=c.listArr(),n.predicates={position:function(e){return-h(e)},modified:f,created:p},n.directions={descending:!0,ascending:!1},n.sortPredicate="position",n.sortDirection="descending",n.annotationCreated=p,n.annotationModified=f,n.toggleAnnots=b,n.downloadAnnots=function(){var e={type:"text/csv;charset=UTF-8"},i=_.map(n.annots,function(e){return{Text:t("breaksToSpaces")(e.text),Note:t("breaksToSpaces")(e.note),Created:p(e).toLocaleString(),Modified:f(e).toLocaleString()}}),s=new Blob([Papa.unparse(i)],e);saveAs(s,m()+".csv"),a.exportNotes()},n.scrollTo=function(e){var t=h(e),n=r.numVisiblePages();r.gotoPage(t-.2*n),r.shrinkToWidth(),i.update()},n.delete=function(e,t){e.stopPropagation(),l.remove(t.id)},$(c).on("changed",function(){e(function(){n.annots=c.listArr()})}),s.on(u.transition_end,function(){g()&&r.shrinkToWidth(),i.update()})})}}}i.$inject=["$timeout","$filter","$rootScope","popover","article","viewer","exporter","tracker","annotationsModel","annotationsController","CONST"],angular.module("reader").directive("annotations",i)},{}],154:[function(e,t,n){function i(e,t,n,i,s,r,o){return{restrict:"E",link:function(a,c){function l(){e(function(){a.loaded=!0})}var u=null,d=c.find("iframe");a.accountPage=function(){window.open(n.web+"/account","_blank")},a.onLogOut=function(){o.clear(),i.signOut(function(){n.parent?window.parent.postMessage({type:"sign_out",url:n.parent},"*"):location.reload()})},a.loaded=!1,d.on("load",l),$(s.readcube).on("app:new",l).on("app:linkout",function(){r.linkout("library")}),t.$on("appnav-open",function(){$(document.body).addClass("appnav-open"),u||(u=sprintf("%s/#!/navigation",n.app),d[0].contentWindow.location.replace(u))}),t.$on("appnav-close",function(){$(document.body).removeClass("appnav-open")})}}}i.$inject=["$timeout","$rootScope","endpoint","user","receiver","tracker","trackId"],angular.module("reader").directive("appnav",i)},{}],155:[function(e,t,n){function i(){return{restrict:"E",controller:"ArticleCtrl",templateUrl:"article.html"}}angular.module("reader").directive("article",i)},{}],156:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c,l,u,d,h,p,f,m,g){return{restrict:"A",link:function(v){function w(){o.fetch().then(function(){a.item.get().then(function(){a.annots.list().then(function(e){_.some(e.annotations,function(e){return 0==e.page_start})||y()},y)},y)},y)}function b(e){var t="annotation-intro-tip";return s.hasTransparentText(e)&&(t+=" transparent"),t}function y(){var t=g.create("annotations");if(!t)return!1;t.compile("intro_tips/annotations.html");var n=1/8,i=32,r=c.getPageObj(1);return r.onLoaded(function(){var o=r.getElem(),a=o.text().split(" "),c=Math.floor(a.length*n),l=Math.floor(a.length*n)+i;if(c>=0&&l<a.length){var u=f.deserialize({text:a.slice(c,l).join(" "),prefix:""},{container:o}),d=s.getElems(u),h=r.getScale(),p=r.getZoom(),g=r.getNormRect(),v=s.getBoundingRect(d),w=new m(v.left,v.top,v.width,v.height);w.translate(-g.left,-g.top),w.scale(p/h,p/h);var _=$(e.get("intro_tips/pulse.html"));_.css({top:w.top,left:w.left+w.width/2,"transform-origin":"0 0",transform:"scale("+p/h+")"}).appendTo(r.getEventable()),_.one("mouseenter",function(){_.addClass("stop"),d.addClass(b(d)),t.show(_,"up")}),$(t).on("close",function(){d.removeClass(b(d)),_.remove()})}}),!0}function k(e){var t=-1,n=e.commonAncestorContainer;return c.eachPage(function(e,i){if($.contains(i.getElem()[0],n))return t=e,!1}),t}function x(e){return k(e)!=-1}n.scibite&&d.init()||(p.init(),r.onInit(function(){r.get().sync_item_sponsored||"ieee"!=r.get().publisher&&c.onInit(function(){var e=l(c.getElem(),x);$(new u(e)).on("highlight",function(t,n){var i=e.getRangeAndClear();p.addHighlight(i,k(i),n)}).on("add-note",function(){var t=e.getRangeAndClear();p.addNote(t,k(t),"")}),"article"==r.getType()&&w()})}),$(h).on("merge-shared-prompt",function(e,n){t.show(t.alert({clickOutsideToClose:!0,templateUrl:"dialogs/import_annotations.html",controller:["$scope",function(e){e.close=function(e){t.hide(),e&&n()}}]}))}),$(h).on("not-synced",function(e,t){"item_not_synced"==t.status&&i.notifyAnnotsNotSynced()}))}}}i.$inject=["$templateCache","$mdDialog","$stateParams","toast","util","article","user","sync","viewer","Selection","SelectionToolbar","termiteModel","annotationsModel","annotationsController","rangeSerializer","Rect","introTip"],angular.module("reader").directive("articleAnnotations",i)},{}],157:[function(e,t,n){function i(e,t){var n=t.left+t.right>>1,i=t.top+t.bottom>>1,s=t.right-t.left>>1,r=t.bottom-t.top>>1,o=Math.max(Math.abs(e.x-n)-s,0),a=Math.max(Math.abs(e.y-i)-r,0);return o*o+a*a}function s(e,t,n,s,r,o,a,c,l,u,d,h,p){return{restrict:"A",link:function(f){function m(e){return angular.merge(s.$new(!0),e)}function g(e){var i=e.getData();switch(e.getType()){case"author":
return i.affiliations&&(i.affiliations=_.uniq(i.affiliations)),t(n.get("citations/author.html"))(m(i));case"figure":return i.figures.length?t('\n              <div>\n                <div ng-repeat="figure in figures">\n                  <div figure="figure" index="ids[$index]-1"></div>\n                </div>\n              </div>\n            ')(m(i)):null;default:return t('<div references="references" tracking-source="inline_reference"></div>')(m(i))}}function v(e){return e.css({"max-height":.5*o.getElem().height()+"px"})}function w(e){var t=p.create("inline-citations");if(!t)return!1;t.compile("intro_tips/inline_citations.html");var i=e.getElems(),s=e.getPage(),o=s.getScale(),a=s.getZoom(),c=r.getBoundingRect(i),l=s.getNormRect(),d=new h(c.left,c.top,c.width,c.height);d.translate(-l.left,-l.top),d.scale(a/o,a/o);var f=$(n.get("intro_tips/pulse.html"));return f.css({top:d.top,left:d.left+d.width/2,"transform-origin":"0 0",transform:"scale("+a/o+")"}).appendTo(s.getEventable()),f.one("mouseenter",function(){f.addClass("stop"),u.showAll(s),t.show(f,"up")}),$(t).on("close",function(){u.hideAll(s),b(e),f.remove()}),!0}function b(t){function n(){return Math.min(i(x,r.getBoundingRect(f)),i(x,r.getBoundingRect(_)))}function s(){return{placement:"up",content:v(_),anchor:m}}function o(){e(function(){d.open(s()),c.inline(t.getType())})}if(y||"author"==t.getType()||(y=!0,!w(t))){var a=null,l=null,u=500,h=1e3,p=400,f=t.getElems(),m=f.first(),_=g(t);_&&$(t).on("click",function(){clearTimeout(l),o()}).on("mouseenter",function(){k||(a=setTimeout(function(){d.isOpen(m)||(clearTimeout(l),o(),l=setTimeout(function e(){d.isOpen(m)&&(n()>p?d.close(m):(clearTimeout(l),l=setTimeout(e,h)))},h),_.one("click",function(){clearTimeout(l)}))},u))}).on("mouseleave",function(){clearTimeout(a)})}}var y=!1;a.onData(function(e){l.init(e),l.forEach(b),$(l).on("add",function(e,t){b(t)}),o.onInit(function(){$(window).on("keydown.citation-drawer",function(e){e.metaKey||e.ctrlKey||82==e.keyCode&&u.animateAll()}),p.enabled("inline-citations")||$(document).one("mousemove.citation-drawer",function(){$(document).on("mousemove.citation-drawer",function(){u.animateAll()&&$(document).off("mousemove.citation-drawer")})})})});var k=!1,x={x:0,y:0};$(document).on("mousedown",function(){k=!0,$(document).one("mouseup",function(){k=!1})}),$(document).on("mousemove",function(e){x={x:e.pageX,y:e.pageY}})}}}s.$inject=["$timeout","$compile","$templateCache","$rootScope","util","viewer","article","tracker","citationsModel","citationDrawer","popover","Rect","introTip"],angular.module("reader").directive("articleCitations",s)},{}],158:[function(e,t,n){function i(e,t,n,i){return{restrict:"E",replace:!0,controller:"ArticleToolsCtrl",templateUrl:"article_tools.html",link:function(s,r,o){function a(){var e=i.create("article-tools");if(!e)return!1;r.addClass("intro-tip-active"),e.compile("intro_tips/article_tools.html");var n=$(t.get("intro_tips/pulse.html"));return n.css({bottom:34,left:0}),n.appendTo(r),r.one("mouseenter.intro-tips",function(){setTimeout(function(){n.addClass("stop"),n.css({left:15}),e.show(n,"left")},400)}),$(e).on("close",function(){r.removeClass("intro-tip-active"),r.off("mouseenter.intro-tips"),n.remove()}),!0}s.isOpen=!1,s.tooltipVisible=!1;var c=null;s.setOpen=function(t,n){e.cancel(c),c=e(function(){s.isOpen=t},n||0)};var l=null,u=s.$watch("isOpen",function(t){e.cancel(l),t?l=e(function(){s.tooltipVisible=s.isOpen},400):s.tooltipVisible&&(s.tooltipVisible=!1,u())});s.$on("$destroy",function(){e.cancel(l)}),n.onData(a)}}}i.$inject=["$timeout","$templateCache","article","introTip"],angular.module("reader").directive("articleTools",i)},{}],159:[function(e,t,n){function i(){return{restrict:"A",link:function(e,t,n){if(n.bgImage){var i=new Image;i.onload=function(){return t.css("background-image","url("+n.bgImage+")")},i.onerror=function(){return t.addClass("load-failed")},i.src=n.bgImage}}}}angular.module("reader").directive("bgImage",i)},{}],160:[function(e,t,n){function i(){return{restrict:"A",link:function(e,t,n){n&&n.cancelEvent&&t.on(n.cancelEvent,!1)}}}angular.module("reader").directive("cancelEvent",i)},{}],161:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c,l,u,d){function h(){var e=i.merge({doi:r.get().doi,embed:1,html5:1,hide_formats:1,parent_url:location.href,tracking_origin:"web_reader",tracking_publisher:r.get().publisher},i.pickDefined(t,["tracking_action","purchase_referrer","purchase_site_license","customer_ids"]));return i.referrerHost()&&(e.checkout_referrer=i.referrerHost()),n.sharing&&(e.show_tiers="3"),i.addParams(s.web+"/checkout/new",e)}return{restrict:"E",link:function(t,s){function p(){e(function(){t.loaded=!0})}function f(){return $(document.body).hasClass("checkout-open")}function m(){f()||(w||(w=h(),_[0].contentWindow.location.replace(w)),l.checkout(),$(document.body).addClass("checkout-open"),n.$emit("checkout-opened"))}function g(){f()&&($(document.body).removeClass("checkout-open"),n.$emit("checkout-closed"))}function v(){f()?g():m()}var w=null,_=s.find("iframe");s.on(d.transition_end,function(){f()&&c.shrinkToWidth(),u.update()}),t.loaded=!1,_.on("load",p),$(a.readcube).on("checkout:new",p).on("checkout:success",function(e,t){l.purchase(t),o.checkAccess()}),$(a.readcube).on("checkout:redirect",function(e,t){i.redirectOrPost(t.url)}),r.onData(function(){o.onExternalCheck(function(){r.hasAccess()||m()})}),$(r).on("access-check",function(){r.hasAccess()&&(n.sharing&&"wiley"==r.get().publisher||g())}),n.$on("toggle-checkout",v),n.$on("open-checkout",m),n.$on("close-checkout",g),n.$on("annotations-opened",g)}}}i.$inject=["$timeout","$stateParams","$rootScope","util","endpoint","article","access","receiver","viewer","tracker","popover","CONST"],angular.module("reader").directive("checkout",i)},{}],162:[function(e,t,n){function i(e,t,n){return{restrict:"E",link:function(i){function s(){n.getMetrics().then(function(t){e(function(){i.metrics=t,t.results&&t.results.length?i.scrollMetrics():i.metrics.finished=!0})},_.noop)}i.metrics=void 0,i.scrollMetrics=function(){if(i.metrics)return!i.metrics.finished&&void(i.metrics.busy||(i.metrics.busy=!0,n.getMetrics({scroll_id:i.metrics.scroll_id}).then(function(t){e(function(){t.results&&t.results.length?(i.metrics.results=i.metrics.results.concat(t.results),i.metrics.scroll_id=t.scroll_id):i.metrics.finished=!0})}).catch(function(){e(function(){i.metrics.finished=!0})}).finally(function(){e(function(){i.metrics.busy=!1})})))},t.$on("cited-by-open",_.once(s))}}}i.$inject=["$timeout","$rootScope","article"],angular.module("reader").directive("citedBy",i)},{}],163:[function(e,t,n){function i(){return{restrict:"A",link:function(e,t,n){new Clipboard(t[0])}}}angular.module("reader").directive("clipboard",i)},{}],164:[function(e,t,n){function i(e,t){return{restrict:"A",replace:!0,scope:{figure:"=",index:"="},templateUrl:"citations/figure.html",link:function(n,i,s){s.inlist||(i=i.find(".view-figure")),i.click(function(){t?window.open(n.figure.url,"_blank"):e(n.index)})}}}i.$inject=["figureViewer","MOBILE"],angular.module("reader").directive("figure",i)},{}],165:[function(e,t,n){function i(e,t){return{restrict:"A",link:function(n,i,s){if(t){var r=i.attr("md-component-id"),o=s.hammerSidenav,a=new Hammer.Manager(i[0],{recognizers:[[Hammer.Swipe,{direction:Hammer.DIRECTION_HORIZONTAL}]]});a.on("swipe"+o,function(){e(r).close()})}}}}i.$inject=["$mdSidenav","MOBILE"],angular.module("reader").directive("hammerSidenav",i)},{}],166:[function(e,t,n){function i(){return{restrict:"A",scope:{loadMore:"&",tresholdPercent:"="},link:function(e,t,n){function i(){var n=(t[0].scrollTop+t[0].offsetHeight)/t[0].scrollHeight*100;(n>s||n>=100)&&!1===e.loadMore()&&(t.off("scroll.infinite"),clearInterval(r))}var s=parseInt(n.tresholdPercent,10)||0;t.on("scroll.infinite",i);var r=setInterval(i,1e3);e.$on("$destroy",function(){clearInterval(r)})}}}angular.module("reader").directive("infiniteScroll",i)},{}],167:[function(e,t,n){function i(e,t){return{restrict:"E",link:function(n,i){function s(){e(function(){n.loaded=!0})}var r=i.find("iframe");n.loaded=!1,$(r).on("load",s),$(t.readcube).on("auth:new",s)}}}i.$inject=["$timeout","receiver"],angular.module("reader").directive("login",i)},{}],168:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c,l){return{restrict:"E",replace:!0,controller:"MenuBarCtrl",templateUrl:"menu_bar.html",link:function(r,o){function l(){var s=c.create("my-library");if(!s)return!1;o.addClass("intro-tip-active"),s.compile("intro_tips/my_library.html",{signedIn:n.signedIn()});var r=$(e.get("intro_tips/pulse.html"));return r.css({bottom:-18,left:60}).appendTo(o),r.one("mouseenter",function(){r.addClass("stop"),r.css({bottom:-4}),s.show(r,"down")}),$(s).on("action",function(e,n){"sign_up"==n?i.showRegister({params:{tracking_action:"intro_tip_signup",tracking_origin:a.trackingOrigin(),promocode:"WRSUMTIP162"},registerAd:"ads/my_library_register.html",successAd:"ads/my_library_success.html"}):"view_library"==n&&window.open(t.app,"_blank")}),$(s).on("close",function(){o.removeClass("intro-tip-active"),r.remove()}),!0}n.fetch().finally(function(){s.onInit(l)})}}}i.$inject=["$templateCache","endpoint","user","userModal","article","access","sync","tracker","introTip","toast"],angular.module("reader").directive("menuBar",i)},{}],169:[function(e,t,n){function i(e,t,n,i,s,r,o){return{restrict:"A",link:function(o,a){function c(e){return angular.merge(i.$new(!0),e,{render_doi:e.doi&&!$('meta[name="citation_doi"]').length,canonical:e.doi&&sprintf("%s/%s",s.reader,e.doi),image:e.yield_thumb&&e.yield_thumb(0)})}r.onData(function(i){"article"==r.getType()&&i.meta&&n(function(){a.append(e(t.get("metadata.html"))(c(i)))})}),r.onInit(function(e){if("supplement"==r.getType()){var t=e.caption?["Supp:",e.caption].join(" "):["Supplement",parseInt(e.index)+1].join(" ");a.append(sprintf("<title>%s</title>",t))}})}}}i.$inject=["$compile","$templateCache","$timeout","$rootScope","endpoint","article","supplement"],angular.module("reader").directive("metadata",i)},{}],170:[function(e,t,n){function i(e){return{restrict:"A",replace:!0,scope:{metrics:"="},templateUrl:"citations/metrics.html",link:function(t,n,i){t.trackLinkout=function(t){e.linkout("cited_by"),t.doi&&i.trackingSource&&e.referral(t.doi,i.trackingSource)}}}}i.$inject=["tracker"],angular.module("reader").directive("metrics",i)},{}],171:[function(e,t,n){function i(e,t,n,i,s,r,o){function a(e){return _.max(e,function(e){return e[1]})[1]}function c(e){var t=e.page_start+1,n=i.getPageObj(t);if(n){var s=n.getHeight(),r=(s-a(e.rects))/s;return t+r}return 0}function l(e){return new Date(e.created)}function u(e){return new Date(e.modified||e.created)}return{restrict:"E",link:function(t,n){i.onInit(function(){t.annots=o.listArr(),t.predicates={position:function(e){return-c(e)},modified:u,created:l},t.directions={descending:!0,ascending:!1},t.sortPredicate="position",t.sortDirection="descending",t.annotationCreated=l,t.annotationModified=u,t.scrollTo=function(e){i.curIndex=e.page_start+1,t.closeSidenav("annotations"),t.closeSidenav("mobile_menu")},$(o).on("changed",function(){e(function(){t.annots=o.listArr()})})})}}}i.$inject=["$timeout","$filter","article","mobileViewer","exporter","tracker","annotationsModel"],angular.module("reader").directive("mobileAnnotations",i)},{}],172:[function(e,t,n){function i(e,t){return{restrict:"E",link:function(n,i){t.init(i),e.onInit(function(e){t.setPreviewData(e)}),e.onAccessCheck(function(n){e.hasAccess()&&t.setFullData(n)})}}}i.$inject=["article","mobileViewer"],angular.module("reader").directive("mobileArticle",i)},{}],173:[function(e,t,n){function i(e,t,n,i){return{restrict:"A",link:function(s){i.init(),$(n).on("merge-shared-prompt",function(t,n){e.show(e.alert({clickOutsideToClose:!0,templateUrl:"dialogs/import_annotations.html",controller:["$scope",function(t){t.close=function(t){e.hide(),t&&n()}}]}))}),$(n).on("not-synced",function(e,n){"item_not_synced"==n.status&&t.notifyAnnotsNotSynced()})}}}i.$inject=["$mdDialog","toast","annotationsModel","annotationsController"],angular.module("reader").directive("mobileArticleAnnotations",i)},{}],174:[function(e,t,n){function i(e,t){return{restrict:"E",replace:!0,templateUrl:"toolbars/mobile_slider.html",link:function(e,n,i){function s(e){var t=g[0].getBoundingClientRect();return Math.max(0,Math.min(1,(e-t.left)/t.width))}function r(e){return u+e*(d-u)}function o(e){return(e-u)/(d-u)}function a(){p||(p=!0,requestAnimationFrame(function(){var e=100*o(h)+"%";v[0].style.left=e,w[0].style.width=e,p=!1}))}function c(e){f&&(t.slideIndex=r(s(e.srcEvent.pageX)),h=t.slideIndex,a())}function l(){f||(h=t.curIndex,a())}var u,d,h,p,f,m,g=n.find(".slider-track"),v=n.find(".slider-thumb"),w=n.find(".slider-fill");n.contextmenu(!1),t.onInit(function(){u=h=1,d=viewer.numPages});var _=new Hammer.Manager(n[0],{recognizers:[[Hammer.Pan,{pointers:1,threshold:0}]]});_.on("pan",c),$(t).on("page-changed",l),_.on("hammer.input",function(e){e.isFirst&&(f=!0,clearTimeout(m),c(e),n.addClass("active"),$("body").addClass("sliding")),e.isFinal&&(t.curIndex=Math.round(t.slideIndex),m=setTimeout(function(){return $("body").removeClass("sliding")},3e3),n.removeClass("active"),f=!1)})}}}i.$inject=["$timeout","mobileViewer"],angular.module("reader").directive("mobileSlider",i)},{}],175:[function(e,t,n){function i(){return{restrict:"E",replace:!0,controller:"MobileToolbarCtrl",templateUrl:"toolbars/mobile_toolbar.html"}}angular.module("reader").directive("mobileToolbar",i)},{}],176:[function(e,t,n){function i(e){return{restrict:"A",link:function(t,n,i){var s=e(i.onLoad);n.on("load",function(e){t.$apply(function(){s(t,{$event:e})})})}}}i.$inject=["$parse"],angular.module("reader").directive("onLoad",i)},{}],177:[function(e,t,n){function i(e,t){return{restrict:"E",replace:!0,templateUrl:"toolbars/page_info.html",link:function(n,i){function s(){o.val(e.getPage()||1)}function r(){var t=e.numPages()||"?";o.attr("data-num",t.toString().length),a.html(t)}var o=i.find(".idx"),a=i.find(".num");o.on("click",function(){o[0].select()}),o.on("blur",function(){var t=parseInt(o.val().replace(/[^0-9]/g,""));t=Math.min(Math.max(t||1,1),e.numPages()||1),e.gotoPage(t),o.val(t)}),o.on("keydown",function(e){13==e.keyCode&&o.blur(),[46,8,9,27,13].indexOf(e.keyCode)!=-1||(e.ctrlKey||e.metaKey)&&[65,67,88].indexOf(e.keyCode)!=-1||[35,36,37,38,39,40,45].indexOf(e.keyCode)!=-1||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()});var c=null,l=i.closest(".article-container");l.on("mousemove",function(e){var t=2*e.pageX<l.width(),n=l.height()-e.pageY<150,s=!$.contains(i[0],e.target);t&&n&&(clearTimeout(c),c=null,i.addClass("show")),c||!s||o.is(":focus")||(c=setTimeout(function(){i.removeClass("show")},2e3))}),s(),r(),i.addClass("loading"),e.onInit(function(){s(),r(),setTimeout(function(){setInterval(function(){var t=!0;e.eachVisiblePage(function(e,n){if(!n.fullyLoaded())return t=!1}),i.toggleClass("loading",!t)},1e3)},2e3),n.$on("$destroy",function(){clearInterval(loadingCheck)}),$(t).on("auth-begin",function(){i.addClass("authorizing")}),$(t).on("auth-end",function(){i.removeClass("authorizing")}),$(e).on("page-changed",s),$(e).on("scroll",_.throttle(function(){i.addClass("scrolling")},200)),$(e).on("scroll",_.debounce(function(){i.removeClass("scrolling")},1e3))})}}}i.$inject=["viewer","access"],angular.module("reader").directive("pageInfo",i)},{}],178:[function(e,t,n){function i(e,t,n,i){return{restrict:"A",link:function(s){function r(t){e.info("POST MESSAGE:",t),window.parent.postMessage(t,"*")}function o(e){var n=-1,i=e.commonAncestorContainer;return t.eachPage(function(e,t){if($.contains(t.getElem()[0],i))return n=e,!1}),n}function a(e){return o(e)!=-1}t.onInit(function(){var e=n(t.getElem(),a);$(new i(e)).on("marked",function(e,t){r({type:"marked",data:t})})})}}}i.$inject=["$log","viewer","Selection","ResolveToolbar"],angular.module("reader").directive("postSelection",i)},{}],179:[function(e,t,n){function i(e,t,n){return{restrict:"A",link:function(i,s,r){function o(){function e(e){return!!d.length&&(d.is(e.target)||$.contains(d[0],e.target))}function o(e){var t=!1;return h.add(s.find(".info-bar")).each(function(){if(t=t||$(this).is(e.target)||$.contains(this,e.target))return!1}),t}function a(e){if(!p.length)return!1;var t=p.width()-e.pageX<180,n=p.height()-e.pageY<240;return t&&n}function c(e){return e.pageY<60}function l(){$("body").on("mousemove",function(e){(c(e)||a(e))&&s.removeClass(r.readMode)}).on("mousemove",_.debounce(function(t){o(t)||e(t)||s.addClass(r.readMode)},2e3))}function u(){function e(){return setTimeout(function(){return s.addClass(r.readMode)},3e3)}var n=$(".mobile-toolbar .main-bar"),i=e();n.click(function(t){clearTimeout(i),s.removeClass(r.readMode),i=e()}),t.hammer.on("singletap",function(){clearTimeout(i),s.toggleClass(r.readMode),i=e()})}var d=(s.find(".viewer"),s.find(".article-tools")),h=s.find(".article-menu"),p=s.find(".article-container");i.$on("start-read-mode",function(){n?t.onInit(u):l()})}r.readMode&&e(o)}}}i.$inject=["$timeout","mobileViewer","MOBILE"],angular.module("reader").directive("readMode",i)},{}],180:[function(e,t,n){function i(e,t,n){return{restrict:"A",replace:!0,scope:{references:"="},templateUrl:"citations/references.html",link:function(i,s,r){i.hideBadges=void 0,i.trackLinkout=function(e){n.linkout("related"),e.doi&&r.trackingSource&&n.referral(e.doi,r.trackingSource)},t.onData(function(t){e(function(){i.hideBadges=t.meta.hide_reference_labels})})}}}i.$inject=["$timeout","article","tracker"],angular.module("reader").directive("references",i)},{}],181:[function(e,t,n){function i(e,t){var n=t("linkify"),i=t("refPublishInfo");return{restrict:"E",scope:{refs:"=",trackingSource:"@"},link:function(t,s){$((t.refs||[]).map(function(e,t){var s="article";e.badge&&(s+=" reference"),e.hideBadges&&(s+=" hide-badges");var r=['<div class="'+s+'">'];return e.badge&&r.push('<div title="'+e.badge+'" class="number">'+e.badge+"</div>"),e.title&&r.push('<h4 class="title">'+n(e.title)+"</h4>"),e.authors&&e.authors.length&&r.push('<div class="authors">'+e.authors.slice(0,10).join(", ")+"</div>"),r.push('<div class="links">'),e.find_article_url&&r.push('\n            <a\n              target="_blank"\n              ref-idx="'+t+'"\n              href="'+e.find_article_url+'">\n              Find Article\n            </a>\n          '),e.find_article_url&&e.article_url&&r.push("<span> | </span>"),e.article_url&&r.push('\n            <a\n              target="_blank"\n              ref-idx="'+t+'"\n              href="'+e.article_url+'">\n              Article\n            </a>\n          '),r.push("</div>"),r.push('<div class="published">'+i(e)+"</div>"),r.push("</div>"),r.join("")}).join("")).appendTo(s).on("click","a[ref-idx]",function(n){e.linkout("related");var i=$(n.target).attr("ref-idx"),s=t.refs[parseInt(i)];s&&s.doi&&t.trackingSource&&e.referral(s.doi,t.trackingSource)})}}}i.$inject=["tracker","$filter"],angular.module("reader").directive("referenceList",i)},{}],182:[function(e,t,n){function i(e){return{restrict:"A",link:function(t,n){function i(){e(function(){t.contracted=r()})}function s(){return parseInt(t.responsive)||960}function r(){return n.width()<s()}t.contracted=r(),$(window).on("resize",_.debounce(i,50)),t.$watch("responsive",i)}}}i.$inject=["$timeout"],angular.module("reader").directive("responsive",i)},{}],183:[function(e,t,n){function i(e,t,n,i,s,r){function o(){return $(document.body).hasClass("info-open")}function a(){o()||($(document.body).addClass("info-open"),e.$emit("info-opened"))}function c(){o()&&($(document.body).removeClass("info-open"),e.$emit("info-closed"))}function l(){o()?c():a()}return e.$on("toggle-info",l),e.$on("open-info",a),e.$on("close-info",c),e.$on("annotations-opened",c),{restrict:"E",link:function(e,a){e.supplement=void 0,n.onInit(function(){return t(function(){return e.supplement=n.get()})}),i.onInit(function(){a.on(r.transition_end,function(){o()&&i.shrinkToWidth(),s.update()})})}}}i.$inject=["$rootScope","$timeout","article","viewer","popover","CONST"],angular.module("reader").directive("supplementInfo",i)},{}],184:[function(e,t,n){function i(e){return{restrict:"A",link:function(t,n,i){var s=e(i.targetClick);"function"==typeof s&&n.click(function(e){n.is(e.target)&&t.$apply(function(){s(t,{$event:e})})})}}}i.$inject=["$parse"],angular.module("reader").directive("targetClick",i)},{}],185:[function(e,t,n){function i(e,t,n){return{restrict:"E",link:function(i,s,r){function o(){return e.isShared()&&!e.hasFullAccess()}function a(){$(document).on("contextmenu",".viewer",function(e){o()&&e.preventDefault()})}function c(){$(document).on("keydown",".viewer",function(e){o()&&(e.metaKey||e.ctrlKey)&&67==e.keyCode&&e.preventDefault()})}t.init(s),n.init(s.find("#journal-banner")),a(),c()}}}i.$inject=["article","viewer","banner"],angular.module("reader").directive("viewer",i)},{}],186:[function(e,t,n){function i(){return{restrict:"E",replace:!0,templateUrl:"toolbars/viewer_toolbar.html",controller:"ViewerToolbarCtrl",link:function(e,t){var n=t.closest(".article-container"),i=null;t.addClass("show"),n.on("mousemove",function(e){var s=2*e.pageX>n.width(),r=n.height()-e.pageY<150,o=!$.contains(t[0],e.target);s&&r&&(clearTimeout(i),i=null,t.addClass("show")),!i&&o&&(i=setTimeout(function(){t.removeClass("show")},2e3))})}}}angular.module("reader").directive("viewerToolbar",i)},{}],187:[function(e,t,n){function i(e,t,n,i){var s;e.properties={width:400,height:300,fps:48,color:"#FFFFFF",manifest:[]},(e.panelred=function(){this.initialize(),this.shape=new n.Shape,this.shape.graphics.f("#FF3E3C").s().p("AgJFMQgdgEgSgSIlollQgSgTADgVQADgWAXgNIFtjJQAYgNAaAFQAdAEASASIFoFlQASATgDAVQgEAXgWAMIlsDJQgSAJgUAAIgNgBg"),this.shape.setTransform(43.3,33.4),this.addChild(this.shape)}).prototype=s=new n.Container,s.nominalBounds=new n.Rectangle(0,0,86.6,66.8),(e.panelpurple=function(){this.initialize(),this.shape=new n.Shape,this.shape.graphics.f("#9823C6").s().p("AlWFXQgHgIANgXIDJlpQAMgXAZgaQAZgYAXgOIFrjIQAXgMAHAGQAHAHgMAXIjJFrQgMAXgaAaQgXAYgYAOIlsDIQgOAHgIAAQgFAAgDgCg"),this.shape.setTransform(34.6,34.6),this.addChild(this.shape)}).prototype=s=new n.Container,s.nominalBounds=new n.Rectangle(0,.1,69.2,69.1),(e.panelorange=function(){this.initialize(),this.shape=new n.Shape,this.shape.graphics.f("#FFC34E").s().p("AAwGhIllloQgSgSgEgdQgFgaANgYIDJltQAMgWAXgEQAVgDATASIFlFoQASASAEAdQAFAbgNAYIjJFsQgMAWgXAEIgGAAQgSAAgQgPg"),this.shape.setTransform(33.4,43.3),this.addChild(this.shape)}).prototype=s=new n.Container,s.nominalBounds=new n.Rectangle(0,0,66.8,86.6),(e.panelmagenta=function(){this.initialize(),this.shape=new n.Shape,this.shape.graphics.f("#FE0FA6").s().p("AlWFWQgGgHAMgXIDIlrQANgXAYgZQAagZAXgNIFrjIQAXgMAHAHQAHAHgMAXIjKFrQgNAXgYAYQgaAagWAMIlrDJQgOAIgIAAQgFAAgDgDg"),this.shape.setTransform(34.6,34.6),this.addChild(this.shape)}).prototype=s=new n.Container,s.nominalBounds=new n.Rectangle(0,.1,69.2,69.2),(e.panelgreen=function(){this.initialize(),this.shape=new n.Shape,this.shape.graphics.f("#98D843").s().p("AAwGhIllloQgSgSgEgdQgFgaANgYIDJltQANgXAWgDQAVgDATASIFlFoQASASAEAdQAFAcgNAXIjJFsQgMAXgXADIgGAAQgRAAgRgPg"),this.shape.setTransform(33.4,43.3),this.addChild(this.shape)}).prototype=s=new n.Container,s.nominalBounds=new n.Rectangle(0,0,66.8,86.6),(e.panelblue=function(){this.initialize(),this.shape=new n.Shape,this.shape.graphics.f("#26C4FF").s().p("AgIFNQgdgFgTgSIlnlmQgSgRACgXQADgWAXgNIFtjIQAXgNAcAFQAdAEARASIFoFlQATATgEAVQgDAXgXAMIlsDJQgSAJgWAAIgKAAg"),this.shape.setTransform(43.3,33.4),this.addChild(this.shape)}).prototype=s=new n.Container,s.nominalBounds=new n.Rectangle(0,.1,86.6,66.8),(e.CollapsedLogoErrorAnimation=function(t,i,s){null==s&&(s=!1),this.initialize(t,i,s,{}),this.frame_0=function(){if(window.devicePixelRatio>1){var e=canvas.width,t=canvas.height;canvas.width=e*window.devicePixelRatio,canvas.height=t*window.devicePixelRatio,canvas.style.width=e+"px",canvas.style.height=t+"px",stage.scaleX=stage.scaleY=window.devicePixelRatio}},this.frame_69=function(){try{stop()}catch(e){}},this.timeline.addTween(n.Tween.get(this).call(this.frame_0).wait(69).call(this.frame_69).wait(17)),this.FlashAICB_colour__Path__5=new e.panelpurple,this.FlashAICB_colour__Path__5.setTransform(142.6,86.4,1.5,1.5,0,0,0,34.6,34.6),this.FlashAICB_colour__Path__5.alpha=.898,this.FlashAICB_colour__Path__5.shadow=new n.Shadow("rgba(0,0,0,1)",0,0,0),this.timeline.addTween(n.Tween.get(this.FlashAICB_colour__Path__5).wait(18).to({scaleX:1.48,scaleY:1.48,skewX:2,skewY:1.3,x:142.3,y:91.6},0).wait(1).to({scaleX:1.45,scaleY:1.45,skewX:4,skewY:2.6,x:142.1,y:96.7},0).wait(1).to({scaleX:1.43,scaleY:1.43,skewX:5.9,skewY:3.8,x:141.9,y:101.5},0).wait(1).to({scaleX:1.41,scaleY:1.41,skewX:7.7,skewY:4.9,x:141.6,y:106.2},0).wait(1).to({scaleX:1.38,scaleY:1.38,skewX:9.4,skewY:6.1,x:141.5,y:110.8},0).wait(1).to({scaleX:1.36,scaleY:1.36,skewX:11.1,skewY:7.1,x:141.2,y:115.1},0).wait(1).to({scaleX:1.34,scaleY:1.34,skewX:12.7,skewY:8.2,x:141.1,y:119.3},0).wait(1).to({scaleX:1.32,scaleY:1.32,skewX:14.3,skewY:9.2,x:140.9,y:123.3},0).wait(1).to({scaleX:1.3,scaleY:1.3,skewX:15.8,skewY:10.2,x:140.7,y:127.2},0).wait(1).to({scaleX:1.29,scaleY:1.29,skewX:17.2,skewY:11.1,x:140.5,y:131},0).wait(1).to({scaleX:1.27,scaleY:1.27,skewX:18.6,skewY:12,x:140.3,y:134.6},0).wait(1).to({scaleX:1.25,scaleY:1.25,skewX:19.9,skewY:12.9,x:140.2,y:138.1},0).wait(1).to({scaleX:1.24,scaleY:1.24,skewX:21.2,skewY:13.7,x:140,y:141.4},0).wait(1).to({scaleX:1.22,scaleY:1.22,skewX:22.5,skewY:14.5,x:139.9,y:144.6},0).wait(1).to({scaleX:1.21,scaleY:1.21,skewX:23.7,skewY:15.3,x:139.7,y:147.8},0).wait(1).to({scaleX:1.19,scaleY:1.19,skewX:24.8,skewY:16,x:139.6,y:150.8},0).wait(1).to({scaleX:1.18,scaleY:1.18,skewX:26,skewY:16.7,x:139.4,y:153.7},0).wait(1).to({scaleX:1.16,scaleY:1.16,skewX:27,skewY:17.4,x:139.3,y:156.5},0).wait(1).to({scaleX:1.15,scaleY:1.15,skewX:28.1,skewY:18.1,x:139.2,y:159.3},0).wait(1).to({scaleX:1.14,scaleY:1.14,skewX:29.1,skewY:18.8,x:139.1,y:161.8},0).wait(1).to({scaleX:1.13,scaleY:1.13,skewX:30.1,skewY:19.4,x:138.9,y:164.4},0).wait(1).to({scaleX:1.11,scaleY:1.11,skewX:31,skewY:20,y:166.9},0).wait(1).to({scaleX:1.1,scaleY:1.1,skewX:32,skewY:20.6,x:138.7,y:169.3},0).wait(1).to({scaleX:1.09,scaleY:1.09,skewX:32.9,skewY:21.2,x:138.6,y:171.6},0).wait(1).to({scaleX:1.08,scaleY:1.08,skewX:33.7,skewY:21.7,x:138.5,y:173.9},0).wait(1).to({scaleX:1.07,scaleY:1.07,skewX:34.6,skewY:22.3,x:138.4,y:176.1},0).wait(1).to({scaleX:1.06,scaleY:1.06,skewX:35.4,skewY:22.8,x:138.3,y:178.3},0).wait(1).to({scaleX:1.05,scaleY:1.05,skewX:36.2,skewY:23.4,x:138.2,y:180.4},0).wait(1).to({scaleX:1.04,scaleY:1.04,skewX:37,skewY:23.9,x:138.1,y:182.5},0).wait(1).to({scaleX:1.03,scaleY:1.03,skewX:37.8,skewY:24.4,x:138,y:184.5},0).wait(1).to({scaleX:1.02,scaleY:1.02,skewX:38.6,skewY:24.9,x:137.9,y:186.5},0).wait(1).to({scaleX:1.01,scaleY:1.01,skewX:39.4,skewY:25.4,x:137.8,y:188.5},0).wait(1).to({scaleX:1,scaleY:1,skewX:40.2,skewY:25.9,x:137.7,y:190.5},0).wait(1).to({scaleX:.99,scaleY:.99,skewX:40.9,skewY:26.4,x:137.6,y:192.5},0).wait(1).to({scaleX:.98,scaleY:.98,skewX:41.7,skewY:26.9,x:137.5,y:194.5},0).wait(1).to({scaleX:.97,scaleY:.97,skewX:42.4,skewY:27.3,x:137.4,y:196.4},0).wait(1).to({scaleX:.96,scaleY:.96,skewX:43.2,skewY:27.8,x:137.3,y:198.4},0).wait(1).to({scaleX:.95,scaleY:.95,skewX:43.9,skewY:28.3,x:137.2,y:200.3},0).wait(1).to({scaleX:.94,scaleY:.94,skewX:44.7,skewY:28.8,y:202.3},0).wait(1).to({scaleX:.94,scaleY:.94,skewX:45.5,skewY:29.3,x:137.1,y:204.3},0).wait(1).to({scaleX:.93,scaleY:.93,skewX:46.2,skewY:29.8,x:137,y:206.3},0).wait(1).to({scaleX:.92,scaleY:.92,skewX:47,skewY:30.3,x:136.9,y:208.4},0).wait(1).to({scaleX:.91,scaleY:.91,skewX:47.8,skewY:30.8,x:136.8,y:210.5},0).wait(1).to({scaleX:.9,scaleY:.9,skewX:48.6,skewY:31.4,x:136.7,y:212.5},0).wait(1).to({scaleX:.89,scaleY:.89,skewX:49.5,skewY:31.9,x:136.6,y:214.7},0).wait(1).to({scaleX:.87,scaleY:.87,skewX:50.3,skewY:32.4,x:136.5,y:216.9},0).wait(1).to({scaleX:.86,scaleY:.86,skewX:51.2,skewY:33,x:136.3,y:219.2},0).wait(1).to({scaleX:.85,scaleY:.85,skewX:52.1,skewY:33.6,y:221.5},0).wait(1).to({scaleX:.84,scaleY:.84,skewX:53,skewY:34.2,x:136.2,y:223.9},0).wait(1).to({scaleX:.83,scaleY:.83,skewX:54,skewY:34.8,x:136,y:226.3},0).wait(1).to({scaleX:.82,scaleY:.82,skewX:54.9,skewY:35.4,x:135.9,y:228.9},0).wait(1).to({regX:35,regY:34.9,scaleX:.81,scaleY:.81,skewX:55.9,skewY:36.1,x:135.8,y:231.6},0).to({regY:35,scaleY:.8,skewY:33,x:135.7,y:229.7},3).to({regY:34.9,scaleY:.81,skewY:36.1,x:135.8,y:231.6},6).wait(8)),this.FlashAICB_colour__Path_=new e.panelgreen,this.FlashAICB_colour__Path_.setTransform(163.3,162.2,1.5,1.5,0,0,0,33.4,43.2),this.FlashAICB_colour__Path_.alpha=.898,this.FlashAICB_colour__Path_.shadow=new n.Shadow("rgba(0,0,0,1)",0,0,0),this.timeline.addTween(n.Tween.get(this.FlashAICB_colour__Path_).wait(24).to({regY:43.3,scaleX:1.51,scaleY:1.51,skewX:5,skewY:.7,x:161.8,y:168.1},0).wait(1).to({scaleX:1.52,scaleY:1.53,skewX:9.6,skewY:1.3,x:160.4,y:173.4},0).wait(1).to({scaleX:1.54,scaleY:1.54,skewX:13.8,skewY:1.9,x:159.1,y:178.4},0).wait(1).to({scaleX:1.55,scaleY:1.55,skewX:17.7,skewY:2.4,x:157.9,y:183},0).wait(1).to({scaleX:1.55,scaleY:1.56,skewX:21.4,skewY:2.9,x:156.9,y:187.3},0).wait(1).to({scaleX:1.56,scaleY:1.57,skewX:24.8,skewY:3.4,x:155.8,y:191.2},0).wait(1).to({scaleX:1.57,scaleY:1.57,skewX:27.9,skewY:3.8,x:154.9,y:194.8},0).wait(1).to({scaleX:1.58,scaleY:1.58,skewX:30.8,skewY:4.2,x:154,y:198.3},0).wait(1).to({scaleX:1.59,scaleY:1.59,skewX:33.6,skewY:4.6,x:153.2,y:201.5},0).wait(1).to({scaleX:1.59,scaleY:1.6,skewX:36.2,skewY:4.9,x:152.4,y:204.5},0).wait(1).to({scaleX:1.6,scaleY:1.6,skewX:38.6,skewY:5.2,x:151.7,y:207.4},0).wait(1).to({scaleX:1.6,scaleY:1.61,skewX:40.9,skewY:5.5,x:150.9,y:210},0).wait(1).to({scaleX:1.61,scaleY:1.61,skewX:43,skewY:5.8,x:150.4,y:212.5},0).wait(1).to({scaleX:1.62,scaleY:1.62,skewX:45.1,skewY:6.1,x:149.7,y:214.9},0).wait(1).to({scaleX:1.62,scaleY:1.62,skewX:47,skewY:6.4,x:149.1,y:217.1},0).wait(1).to({scaleX:1.62,scaleY:1.63,skewX:48.8,skewY:6.6,x:148.6,y:219.3},0).wait(1).to({scaleX:1.63,scaleY:1.63,skewX:50.6,skewY:6.9,x:148,y:221.3},0).wait(1).to({scaleX:1.63,scaleY:1.64,skewX:52.3,skewY:7.1,x:147.6,y:223.3},0).wait(1).to({scaleX:1.64,scaleY:1.64,skewX:54,skewY:7.3,x:147,y:225.3},0).wait(1).to({scaleX:1.64,scaleY:1.65,skewX:55.6,skewY:7.5,x:146.5,y:227.1},0).wait(1).to({scaleX:1.65,scaleY:1.65,skewX:57.1,skewY:7.8,x:146.1,y:228.9},0).wait(1).to({scaleX:1.65,scaleY:1.65,skewX:58.7,skewY:8,x:145.6,y:230.8},0).wait(1).to({scaleX:1.65,scaleY:1.66,skewX:60.2,skewY:8.2,x:145.2,y:232.5},0).wait(1).to({scaleX:1.66,scaleY:1.66,skewX:61.7,skewY:8.4,x:144.7,y:234.3},0).wait(1).to({scaleX:1.66,scaleY:1.67,skewX:63.3,skewY:8.6,x:144.2,y:236.1},0).wait(1).to({scaleX:1.67,scaleY:1.67,skewX:64.8,skewY:8.8,x:143.8,y:237.9},0).wait(1).to({scaleX:1.67,scaleY:1.68,skewX:66.4,skewY:9,x:143.3,y:239.7},0).wait(1).to({scaleX:1.67,scaleY:1.68,skewX:68,skewY:9.2,x:142.8,y:241.6},0).wait(1).to({scaleX:1.68,scaleY:1.68,skewX:69.6,skewY:9.5,x:142.3,y:243.5},0).wait(1).to({scaleX:1.68,scaleY:1.69,skewX:71.3,skewY:9.7,x:141.8,y:245.5},0).wait(1).to({scaleX:1.69,scaleY:1.69,skewX:73.1,skewY:9.9,x:141.3,y:247.6},0).wait(1).to({scaleX:1.69,scaleY:1.7,skewX:74.9,skewY:10.2,x:140.7,y:249.7},0).wait(1).to({scaleX:1.7,scaleY:1.7,skewX:76.8,skewY:10.4,x:140.2,y:251.9},0).wait(1).to({scaleX:1.7,scaleY:1.71,skewX:78.9,skewY:10.7,x:139.5,y:254.3},0).wait(1).to({regX:33.3,regY:43.1,scaleX:1.71,scaleY:1.71,skewX:81,skewY:11,x:138.9,y:256.8},0).to({regX:33.2,scaleX:1.71,skewX:83,x:138.7,y:254.3},7).to({regX:33.3,scaleX:1.71,skewX:81,x:138.9,y:256.8},9).wait(12)),this.FlashAICB_colour__Path__1=new e.panelmagenta,this.FlashAICB_colour__Path__1.setTransform(255.2,199.1,1.5,1.5,0,0,0,34.6,34.6),this.FlashAICB_colour__Path__1.alpha=.898,this.FlashAICB_colour__Path__1.shadow=new n.Shadow("rgba(0,0,0,1)",0,0,0),this.timeline.addTween(n.Tween.get(this.FlashAICB_colour__Path__1).wait(18).to({scaleX:1.5,
scaleY:1.5,skewX:2.6,skewY:1.5,x:257.2,y:202.3},0).wait(1).to({scaleX:1.5,skewX:5,skewY:2.9,x:259.1,y:205.3},0).wait(1).to({scaleX:1.5,scaleY:1.5,skewX:7.2,skewY:4.3,x:260.9,y:208.1},0).wait(1).to({scaleX:1.5,scaleY:1.5,skewX:9.3,skewY:5.5,x:262.6,y:210.9},0).wait(1).to({skewX:11.3,skewY:6.7,x:264.2,y:213.4},0).wait(1).to({scaleX:1.51,scaleY:1.5,skewX:13.2,skewY:7.8,x:265.7,y:215.7},0).wait(1).to({scaleX:1.51,skewX:15,skewY:8.9,x:267.2,y:218},0).wait(1).to({scaleX:1.51,skewX:16.7,skewY:9.9,x:268.5,y:220.1},0).wait(1).to({scaleY:1.5,skewX:18.3,skewY:10.8,x:269.8,y:222.1},0).wait(1).to({scaleX:1.51,skewX:19.8,skewY:11.7,x:271,y:224.1},0).wait(1).to({scaleX:1.51,scaleY:1.49,skewX:21.3,skewY:12.6,x:272.1,y:225.9},0).wait(1).to({skewX:22.7,skewY:13.4,x:273.2,y:227.7},0).wait(1).to({scaleX:1.51,skewX:24,skewY:14.2,x:274.3,y:229.3},0).wait(1).to({scaleY:1.49,skewX:25.3,skewY:14.9,x:275.3,y:230.9},0).wait(1).to({scaleX:1.51,skewX:26.5,skewY:15.6,x:276.3,y:232.5},0).wait(1).to({skewX:27.7,skewY:16.3,x:277.2,y:233.9},0).wait(1).to({scaleX:1.51,skewX:28.8,skewY:17,x:278.1,y:235.4},0).wait(1).to({scaleY:1.49,skewX:29.9,skewY:17.6,x:278.9,y:236.7},0).wait(1).to({skewX:30.9,skewY:18.3,x:279.8,y:238.1},0).wait(1).to({scaleX:1.51,skewX:32,skewY:18.9,x:280.7,y:239.3},0).wait(1).to({scaleY:1.49,skewX:32.9,skewY:19.4,x:281.4,y:240.5},0).wait(1).to({scaleX:1.51,skewX:33.9,skewY:20,x:282.1,y:241.7},0).wait(1).to({skewX:34.8,skewY:20.6,x:282.9,y:243},0).wait(1).to({skewX:35.8,skewY:21.1,x:283.6,y:244.1},0).wait(1).to({scaleX:1.52,skewX:36.7,skewY:21.6,x:284.3,y:245.2},0).wait(1).to({scaleY:1.49,skewX:37.5,skewY:22.1,x:285.1,y:246.3},0).wait(1).to({skewX:38.4,skewY:22.7,x:285.7,y:247.4},0).wait(1).to({scaleX:1.52,skewX:39.3,skewY:23.2,x:286.4,y:248.5},0).wait(1).to({skewX:40.1,skewY:23.7,x:287.1,y:249.5},0).wait(1).to({scaleX:1.52,scaleY:1.49,skewX:41,skewY:24.2,x:287.8,y:250.6},0).wait(1).to({skewX:41.8,skewY:24.7,x:288.4,y:251.7},0).wait(1).to({skewX:42.6,skewY:25.2,x:289.1,y:252.7},0).wait(1).to({scaleX:1.52,skewX:43.5,skewY:25.7,x:289.8,y:253.8},0).wait(1).to({skewX:44.3,skewY:26.2,x:290.5,y:254.9},0).wait(1).to({scaleY:1.49,skewX:45.2,skewY:26.7,x:291.1,y:256},0).wait(1).to({scaleX:1.52,skewX:46.1,skewY:27.2,x:291.8,y:257.1},0).wait(1).to({skewX:46.9,skewY:27.7,x:292.6,y:258.1},0).wait(1).to({skewX:47.8,skewY:28.2,x:293.2,y:259.3},0).wait(1).to({scaleX:1.52,scaleY:1.49,skewX:48.8,skewY:28.8,x:294,y:260.5},0).wait(1).to({skewX:49.7,skewY:29.3,x:294.7,y:261.6},0).wait(1).to({skewX:50.7,skewY:29.9,x:295.5,y:262.8},0).wait(1).to({scaleX:1.52,skewX:51.6,skewY:30.5,x:296.3,y:264.1},0).wait(1).to({scaleY:1.49,skewX:52.7,skewY:31.1,x:297.1,y:265.4},0).wait(1).to({scaleX:1.52,skewX:53.7,skewY:31.7,x:297.9,y:266.7},0).wait(1).to({skewX:54.8,skewY:32.3,x:298.8,y:268.1},0).wait(1).to({regY:34.9,scaleX:1.52,skewX:55.9,skewY:33,x:299.7,y:269.6},0).to({scaleY:1.48,skewY:34,x:299.6,y:267.7},3).to({scaleY:1.49,skewY:33,x:299.7,y:269.6},7).wait(13)),this.FlashAICB_colour__Path__2=new e.panelblue,this.FlashAICB_colour__Path__2.setTransform(241,84.5,1.5,1.5,0,0,0,43.2,33.5),this.FlashAICB_colour__Path__2.alpha=.898,this.FlashAICB_colour__Path__2.shadow=new n.Shadow("rgba(0,0,0,1)",0,0,0),this.timeline.addTween(n.Tween.get(this.FlashAICB_colour__Path__2).wait(21).to({regX:43.3,regY:33.4,scaleX:1.51,scaleY:1.51,skewX:3.2,skewY:.3,x:241.4,y:91},0).wait(1).to({scaleX:1.52,scaleY:1.52,skewX:6.3,skewY:.6,x:241.6,y:97.3},0).wait(1).to({scaleX:1.53,scaleY:1.53,skewX:9.2,skewY:.8,x:241.9,y:103.4},0).wait(1).to({scaleX:1.54,scaleY:1.54,skewX:12,skewY:1.1,x:242,y:109.1},0).wait(1).to({scaleX:1.55,scaleY:1.55,skewX:14.6,skewY:1.3,x:242.2,y:114.6},0).wait(1).to({scaleX:1.55,scaleY:1.55,skewX:17.2,skewY:1.5,x:242.4,y:119.8},0).wait(1).to({scaleX:1.56,scaleY:1.56,skewX:19.6,skewY:1.7,x:242.6,y:124.8},0).wait(1).to({scaleX:1.57,scaleY:1.57,skewX:21.9,skewY:1.9,x:242.8,y:129.6},0).wait(1).to({scaleX:1.58,scaleY:1.58,skewX:24.1,skewY:2.1,x:243,y:134.1},0).wait(1).to({scaleX:1.58,scaleY:1.58,skewX:26.2,skewY:2.3,x:243.1,y:138.5},0).wait(1).to({scaleX:1.59,scaleY:1.59,skewX:28.2,skewY:2.5,x:243.2,y:142.7},0).wait(1).to({scaleX:1.6,scaleY:1.59,skewX:30.2,skewY:2.7,x:243.4,y:146.7},0).wait(1).to({scaleX:1.6,scaleY:1.6,skewX:32,skewY:2.8,x:243.5,y:150.5},0).wait(1).to({scaleX:1.61,scaleY:1.61,skewX:33.8,skewY:3,x:243.7,y:154.2},0).wait(1).to({scaleX:1.61,scaleY:1.61,skewX:35.5,skewY:3.1,x:243.8,y:157.7},0).wait(1).to({scaleX:1.62,scaleY:1.62,skewX:37.2,skewY:3.3,x:244,y:161.1},0).wait(1).to({scaleX:1.62,scaleY:1.62,skewX:38.8,skewY:3.4,x:244.1,y:164.4},0).wait(1).to({scaleX:1.63,scaleY:1.63,skewX:40.3,skewY:3.6,x:244.2,y:167.6},0).wait(1).to({scaleX:1.63,scaleY:1.63,skewX:41.8,skewY:3.7,x:244.3,y:170.6},0).wait(1).to({scaleX:1.64,scaleY:1.64,skewX:43.2,skewY:3.8,x:244.4,y:173.6},0).wait(1).to({scaleX:1.64,scaleY:1.64,skewX:44.6,skewY:4,x:244.5,y:176.4},0).wait(1).to({scaleX:1.64,scaleY:1.64,skewX:45.9,skewY:4.1,x:244.6,y:179.2},0).wait(1).to({scaleX:1.65,scaleY:1.65,skewX:47.2,skewY:4.2,x:244.7,y:181.9},0).wait(1).to({scaleX:1.65,scaleY:1.65,skewX:48.5,skewY:4.3,x:244.8,y:184.5},0).wait(1).to({scaleX:1.66,scaleY:1.66,skewX:49.7,skewY:4.4,x:244.9,y:187.1},0).wait(1).to({scaleX:1.66,scaleY:1.66,skewX:51,skewY:4.5,x:245,y:189.6},0).wait(1).to({scaleX:1.66,scaleY:1.66,skewX:52.2,skewY:4.6,x:245.1,y:192.1},0).wait(1).to({scaleX:1.67,scaleY:1.67,skewX:53.3,skewY:4.7,y:194.5},0).wait(1).to({scaleX:1.67,scaleY:1.67,skewX:54.5,skewY:4.8,x:245.2,y:196.9},0).wait(1).to({scaleX:1.68,scaleY:1.67,skewX:55.6,skewY:4.9,x:245.3,y:199.2},0).wait(1).to({scaleX:1.68,scaleY:1.68,skewX:56.8,skewY:5,x:245.4,y:201.5},0).wait(1).to({scaleX:1.68,scaleY:1.68,skewX:57.9,skewY:5.1,x:245.5,y:203.9},0).wait(1).to({scaleX:1.69,scaleY:1.68,skewX:59,skewY:5.2,x:245.6,y:206.2},0).wait(1).to({scaleX:1.69,scaleY:1.69,skewX:60.1,skewY:5.3,x:245.7,y:208.5},0).wait(1).to({scaleX:1.69,scaleY:1.69,skewX:61.2,skewY:5.4,y:210.9},0).wait(1).to({scaleX:1.7,scaleY:1.69,skewX:62.4,skewY:5.5,x:245.8,y:213.1},0).wait(1).to({scaleX:1.7,scaleY:1.7,skewX:63.5,skewY:5.6,x:245.9,y:215.5},0).wait(1).to({scaleX:1.7,scaleY:1.7,skewX:64.6,skewY:5.7,x:246,y:217.9},0).wait(1).to({scaleX:1.71,scaleY:1.71,skewX:65.8,skewY:5.8,x:246.1,y:220.3},0).wait(1).to({scaleX:1.71,scaleY:1.71,skewX:67,skewY:5.9,y:222.7},0).wait(1).to({scaleX:1.71,scaleY:1.71,skewX:68.2,skewY:6,x:246.2,y:225.2},0).wait(1).to({scaleX:1.72,scaleY:1.72,skewX:69.4,skewY:6.1,x:246.4,y:227.7},0).wait(1).to({scaleX:1.72,scaleY:1.72,skewX:70.7,skewY:6.3,y:230.4},0).wait(1).to({scaleX:1.73,scaleY:1.72,skewX:71.9,skewY:6.4,x:246.6,y:233},0).wait(1).to({scaleX:1.73,scaleY:1.73,skewX:73.3,skewY:6.5,y:235.7},0).wait(1).to({scaleX:1.74,scaleY:1.73,skewX:74.6,skewY:6.6,x:246.7,y:238.6},0).wait(1).to({scaleX:1.74,scaleY:1.74,skewX:76,skewY:6.7,x:246.9,y:241.5},0).wait(1).to({scaleX:1.74,scaleY:1.74,skewX:77.5,skewY:6.9,y:244.5},0).wait(1).to({regX:43.4,scaleX:1.75,scaleY:1.75,skewX:79,skewY:7,x:246.8,y:247.7},0).to({scaleY:1.75,skewX:79.2,skewY:9,y:245.8},3).to({scaleY:1.75,skewX:79,skewY:7,y:247.7},4).wait(10)),this.FlashAICB_colour__Path__3=new e.panelred,this.FlashAICB_colour__Path__3.setTransform(156.8,201.2,1.5,1.5,0,0,0,43.4,33.4),this.FlashAICB_colour__Path__3.alpha=.898,this.FlashAICB_colour__Path__3.shadow=new n.Shadow("rgba(0,0,0,1)",0,0,0),this.timeline.addTween(n.Tween.get(this.FlashAICB_colour__Path__3).wait(18).to({regX:43.3,scaleX:1.49,scaleY:1.49,skewX:-3.9,skewY:-1,x:152.3,y:204.7},0).wait(1).to({scaleX:1.48,scaleY:1.48,skewX:-7.5,skewY:-2,x:148.2,y:208.2},0).wait(1).to({scaleX:1.47,scaleY:1.47,skewX:-10.9,skewY:-3,x:144.3,y:211.4},0).wait(1).to({scaleX:1.46,scaleY:1.46,skewX:-14.2,skewY:-3.8,x:140.6,y:214.4},0).wait(1).to({scaleX:1.45,scaleY:1.45,skewX:-17.2,skewY:-4.7,x:137.3,y:217.3},0).wait(1).to({scaleX:1.44,scaleY:1.44,skewX:-20.1,skewY:-5.4,x:134,y:220},0).wait(1).to({scaleX:1.44,scaleY:1.44,skewX:-22.8,skewY:-6.2,x:130.9,y:222.5},0).wait(1).to({scaleX:1.43,scaleY:1.43,skewX:-25.3,skewY:-6.9,x:128.1,y:224.9},0).wait(1).to({scaleX:1.42,scaleY:1.42,skewX:-27.7,skewY:-7.5,x:125.3,y:227.1},0).wait(1).to({scaleX:1.42,scaleY:1.42,skewX:-30,skewY:-8.1,x:122.8,y:229.3},0).wait(1).to({scaleX:1.41,scaleY:1.41,skewX:-32.1,skewY:-8.7,x:120.4,y:231.2},0).wait(1).to({scaleX:1.4,scaleY:1.4,skewX:-34.1,skewY:-9.3,x:118.1,y:233.1},0).wait(1).to({scaleX:1.4,scaleY:1.4,skewX:-36,skewY:-9.8,x:115.9,y:234.9},0).wait(1).to({scaleX:1.39,scaleY:1.39,skewX:-37.8,skewY:-10.3,x:113.9,y:236.6},0).wait(1).to({scaleX:1.39,scaleY:1.39,skewX:-39.6,skewY:-10.7,x:112,y:238.2},0).wait(1).to({scaleX:1.38,scaleY:1.38,skewX:-41.2,skewY:-11.2,x:110.1,y:239.8},0).wait(1).to({scaleX:1.38,scaleY:1.38,skewX:-42.8,skewY:-11.6,x:108.4,y:241.2},0).wait(1).to({scaleX:1.38,scaleY:1.38,skewX:-44.3,skewY:-12,x:106.6,y:242.6},0).wait(1).to({scaleX:1.37,scaleY:1.37,skewX:-45.7,skewY:-12.4,x:105,y:244},0).wait(1).to({scaleX:1.37,scaleY:1.37,skewX:-47.1,skewY:-12.8,x:103.4,y:245.3},0).wait(1).to({scaleX:1.36,scaleY:1.36,skewX:-48.5,skewY:-13.2,x:101.9,y:246.6},0).wait(1).to({scaleX:1.36,scaleY:1.36,skewX:-49.8,skewY:-13.5,x:100.4,y:247.8},0).wait(1).to({scaleX:1.36,scaleY:1.36,skewX:-51.1,skewY:-13.9,x:99,y:249},0).wait(1).to({scaleX:1.35,scaleY:1.35,skewX:-52.4,skewY:-14.2,x:97.5,y:250.2},0).wait(1).to({scaleX:1.35,scaleY:1.35,skewX:-53.7,skewY:-14.6,x:96,y:251.4},0).wait(1).to({scaleX:1.34,scaleY:1.34,skewX:-55,skewY:-14.9,x:94.6,y:252.7},0).wait(1).to({scaleX:1.34,scaleY:1.34,skewX:-56.3,skewY:-15.3,x:93.1,y:253.9},0).wait(1).to({scaleX:1.34,scaleY:1.34,skewX:-57.6,skewY:-15.6,x:91.6,y:255.1},0).wait(1).to({scaleX:1.33,scaleY:1.33,skewX:-59,skewY:-16,x:90.1,y:256.4},0).wait(1).to({scaleX:1.33,scaleY:1.33,skewX:-60.4,skewY:-16.4,x:88.5,y:257.7},0).wait(1).to({scaleX:1.33,scaleY:1.33,skewX:-61.8,skewY:-16.8,x:86.9,y:259.1},0).wait(1).to({scaleX:1.32,scaleY:1.32,skewX:-63.3,skewY:-17.2,x:85.2,y:260.4},0).wait(1).to({scaleX:1.32,scaleY:1.32,skewX:-64.9,skewY:-17.6,x:83.5,y:261.9},0).wait(1).to({scaleX:1.31,scaleY:1.31,skewX:-66.5,skewY:-18,x:81.6,y:263.5},0).wait(1).to({scaleX:1.31,scaleY:1.31,skewX:-68.2,skewY:-18.5,x:79.7,y:265.1},0).wait(1).to({regX:42.9,regY:33.5,scaleX:1.3,scaleY:1.3,skewX:-70,skewY:-19,x:77.7,y:266.7},0).to({scaleX:1.3,scaleY:1.3,skewY:-14,y:260.5},3).to({scaleX:1.3,scaleY:1.3,skewY:-19,y:266.7},11).wait(19)),this.FlashAICB_colour__Path__4=new e.panelorange,this.FlashAICB_colour__Path__4.setTransform(234.5,123.2,1.5,1.5,0,0,0,33.4,43.3),this.FlashAICB_colour__Path__4.alpha=.898,this.FlashAICB_colour__Path__4.shadow=new n.Shadow("rgba(0,0,0,1)",0,0,0),this.timeline.addTween(n.Tween.get(this.FlashAICB_colour__Path__4).wait(23).to({scaleX:1.52,scaleY:1.52,skewX:5,skewY:.3,x:234.7,y:131.6},0).wait(1).to({scaleX:1.54,scaleY:1.54,skewX:9.6,skewY:.7,x:235,y:139.4},0).wait(1).to({scaleX:1.56,scaleY:1.56,skewX:13.9,skewY:1,x:235.2,y:146.8},0).wait(1).to({scaleX:1.58,scaleY:1.58,skewX:17.9,skewY:1.3,x:235.4,y:153.6},0).wait(1).to({scaleX:1.59,scaleY:1.59,skewX:21.7,skewY:1.5,x:235.6,y:160},0).wait(1).to({scaleX:1.61,scaleY:1.61,skewX:25.2,skewY:1.8,x:235.8,y:165.9},0).wait(1).to({scaleX:1.62,scaleY:1.62,skewX:28.5,skewY:2,x:235.9,y:171.6},0).wait(1).to({scaleX:1.63,scaleY:1.63,skewX:31.6,skewY:2.2,x:236,y:176.7},0).wait(1).to({scaleX:1.65,scaleY:1.65,skewX:34.5,skewY:2.4,x:236.2,y:181.7},0).wait(1).to({scaleX:1.66,scaleY:1.66,skewX:37.2,skewY:2.6,x:236.3,y:186.3},0).wait(1).to({scaleX:1.67,scaleY:1.67,skewX:39.8,skewY:2.8,x:236.5,y:190.7},0).wait(1).to({scaleX:1.68,scaleY:1.68,skewX:42.2,skewY:3,x:236.6,y:194.8},0).wait(1).to({scaleX:1.69,scaleY:1.69,skewX:44.5,skewY:3.1,x:236.7,y:198.7},0).wait(1).to({scaleX:1.7,scaleY:1.7,skewX:46.7,skewY:3.3,x:236.8,y:202.4},0).wait(1).to({scaleX:1.71,scaleY:1.71,skewX:48.7,skewY:3.4,x:236.9,y:205.9},0).wait(1).to({scaleX:1.72,scaleY:1.72,skewX:50.7,skewY:3.6,x:237,y:209.3},0).wait(1).to({scaleX:1.72,scaleY:1.72,skewX:52.6,skewY:3.7,x:237.1,y:212.6},0).wait(1).to({scaleX:1.73,scaleY:1.73,skewX:54.5,skewY:3.8,x:237.2,y:215.6},0).wait(1).to({scaleX:1.74,scaleY:1.74,skewX:56.2,skewY:4,x:237.3,y:218.7},0).wait(1).to({scaleX:1.75,scaleY:1.75,skewX:58,skewY:4.1,x:237.4,y:221.6},0).wait(1).to({scaleX:1.75,scaleY:1.75,skewX:59.6,skewY:4.2,x:237.5,y:224.4},0).wait(1).to({scaleX:1.76,scaleY:1.76,skewX:61.3,skewY:4.3,y:227.3},0).wait(1).to({scaleX:1.77,scaleY:1.77,skewX:62.9,skewY:4.4,x:237.6,y:230},0).wait(1).to({scaleX:1.77,scaleY:1.77,skewX:64.6,skewY:4.6,x:237.7,y:232.8},0).wait(1).to({scaleX:1.78,scaleY:1.78,skewX:66.2,skewY:4.7,x:237.8,y:235.6},0).wait(1).to({scaleX:1.79,scaleY:1.79,skewX:67.8,skewY:4.8,x:237.9,y:238.4},0).wait(1).to({scaleX:1.79,scaleY:1.79,skewX:69.5,skewY:4.9,y:241.3},0).wait(1).to({scaleX:1.8,scaleY:1.8,skewX:71.2,skewY:5,x:238.1,y:244.1},0).wait(1).to({scaleX:1.81,scaleY:1.81,skewX:73,skewY:5.2,x:238.2,y:247.1},0).wait(1).to({scaleX:1.82,scaleY:1.82,skewX:74.8,skewY:5.3,y:250.2},0).wait(1).to({scaleX:1.83,scaleY:1.83,skewX:76.6,skewY:5.4,x:238.3,y:253.3},0).wait(1).to({scaleX:1.83,scaleY:1.83,skewX:78.6,skewY:5.5,x:238.4,y:256.6},0).wait(1).to({scaleX:1.84,scaleY:1.84,skewX:80.6,skewY:5.7,x:238.5,y:260.1},0).wait(1).to({scaleX:1.85,scaleY:1.85,skewX:82.8,skewY:5.8,x:238.6,y:263.7},0).wait(1).to({regX:32.9,regY:42.6,scaleX:1.86,scaleY:1.86,skewX:85,skewY:6,x:238.8,y:267.5},0).to({scaleX:1.86,skewX:81,skewY:5.8,x:238.9,y:265.7},4).to({scaleX:1.86,skewX:85,skewY:6,x:238.8,y:267.5},6).wait(19))}).prototype=s=new n.MovieClip,s.nominalBounds=new n.Rectangle(289.7,183.3,222.6,223)}function s(e){i(e=e||{},{},createjs,{}),canvas=document.getElementById("canvas"),exportRoot=new e.CollapsedLogoErrorAnimation,stage=new createjs.Stage(canvas),stage.addChild(exportRoot),stage.update(),createjs.Ticker.setFPS(e.properties.fps),createjs.Ticker.addEventListener("tick",stage)}t.exports={start:s}},{}],188:[function(e,t,n){function i(){return function(e){return e.journal.toLowerCase().split(" ").concat(e.doi).join(", ")}}angular.module("reader").filter("articleKeywords",i)},{}],189:[function(e,t,n){function i(){return function(e){return _.map(e,function(e){return e.short_name||e.name})}}angular.module("reader").filter("authorShortName",i)},{}],190:[function(e,t,n){function i(){return function(e){return(e||"").replace(/(?:\r?\n|\r)+/g," ")}}angular.module("reader").filter("breaksToSpaces",i)},{}],191:[function(e,t,n){function i(e){var t={chrome:1024,msedge:512,msie:512}[e.name];return function(e){return e?t?e.substr(0,t-3)+"...":e:""}}i.$inject=["browser"],angular.module("reader").filter("clipTitle",i)},{}],192:[function(e,t,n){function i(e){return e=e.replace(/^([\s\:\.])+/g,""),e=e.replace(/([\s\:])+$/g,"")}function s(e){return function(t){var n=t.indexOf(":");return n==-1?e.trustAsHtml(t):e.trustAsHtml(sprintf("<b>%s | </b>%s",i(t.substr(0,n)),i(t.substr(n+1))))}}function r(e){return function(t){var n=t.indexOf(":");return n==-1?e.trustAsHtml(t):e.trustAsHtml(i(t.substr(0,n)))}}function o(e){return function(t){var n=t.indexOf(":"),s=t.search(/(?:\S)\.(?=\s)/i);return n==-1?"":(s==-1&&(s=t.length),e.trustAsHtml(i(t.substring(n+1,s+2))))}}function a(e){return function(t){var n=t.indexOf(":"),s=t.search(/(?:\S)\.(?=\s)/i);return n==-1||s==-1?"":e.trustAsHtml(i(t.substr(s+2)))}}s.$inject=["$sce"],r.$inject=["$sce"],o.$inject=["$sce"],a.$inject=["$sce"],angular.module("reader").filter("figureCaption",s),angular.module("reader").filter("figureCaptionLabel",r),angular.module("reader").filter("figureCaptionTitle",o),angular.module("reader").filter("figureCaptionText",a)},{}],193:[function(e,t,n){function i(){return function(e,t){return moment(e).format(t)}}function s(){return function(e){return moment(e).calendar()}}angular.module("reader").filter("formatDate",i),angular.module("reader").filter("calendarDate",s)},{}],194:[function(e,t,n){function i(){return function(e,t){return(e||[]).join(t||"")}}angular.module("reader").filter("join",i)},{}],195:[function(e,t,n){function i(){return function(e){if(!isNaN(e=parseInt(e,10)))return e<1e3?e:(e/1e3|0)+"k"}}angular.module("reader").filter("kilo",i)},{}],196:[function(e,t,n){function i(e){return function(t){return t=t.replace(/<(http[^>]+)>/g,function(e,t){return t}),t=t.replace(/(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/g,function(e){return'<a href="'+e+'" target="_blank"> '+e+" </a>"}),e.trustAsHtml(t)}}i.$inject=["$sce"],angular.module("reader").filter("linkify",i)},{}],197:[function(e,t,n){function i(){return function(e){return e.journal&&e.year?e.journal+", "+e.year:e.journal||e.year||""}}angular.module("reader").filter("refPublishInfo",i)},{}],198:[function(e,t,n){function i(e,t){if(e=(0|e).toString(),e.length<t)for(var n=e.length;n<t;n++)e="0"+e;return e}function s(){return function(e){var t=moment.duration(e);return sprintf("%s:%s:%s",i(t.asHours(),2),i(t.minutes(),2),i(t.seconds(),2))}}angular.module("reader").filter("rentalDuration",s)},{}],199:[function(e,t,n){function i(e){return function(t){return e.trustAsResourceUrl(t)}}i.$inject=["$sce"],angular.module("reader").filter("trustUrl",i)},{}],200:[function(e,t,n){function i(){return new Promise(function(e){$(e)})}function s(){return new Promise(function(t){!endpoint.parent||parseUri(location.href).queryKey.autoboot?t():($(e("./core/receiver").all).on("new_session",t),window.parent.postMessage({type:"loaded"},"*"))})}function r(){A&&$("html").addClass("opaque"),E&&$("html").addClass("mobile"),i().then(function(){c()||a()||($("head").attr("metadata",""),angular.bootstrap(document,["reader"],{strictDi:!0}))});var t=e("./core/user");t.fetch().finally(function(){t.signedIn()&&(e("./core/user_storage").setPrefix(t.get().id),trackJs&&trackJs.configure({userId:t.get().id}))}),o()}function o(){var t=e("./core/utils/util"),n=e("./core/update"),i=e("./core/command");$(i).on("reload",t.reload),$(i).on("force_update",function(){n.available().then(t.reload)})}function a(){var t=e("./core/compatible");return!t().result&&(h(d()),!0)}function c(){var t=e("./core/compatible");return!(!X.get()||"mobile_browser"!=t().message)&&(X.getProxiedArticle(p()).then(function(e){return h(e.url)}).catch(function(){return h(u(p()))}),!0)}function l(){var e=parseUri(location.href);return!(e.queryKey.lightbox||e.queryKey.parent_url)}function u(t){return sprintf("%s/%s",e("./core/endpoint").dx_doi,t)}function d(){var t=e("./core/endpoint"),n=X.get()?t.authors_springernature:t.web;return sprintf("%s/unsupported/%s",n,p())}function h(t){e("./core/utils/util").redirectOrPost(t)}function p(){var e=decodeURIComponent(location.href.split("?")[0]),t=e.match(j);if(t)return t[0];var n=parseUri(location.href),i=n.queryKey.doi;return i?i.replace(/~2F/g,"/"):"unknown"}function f(){var t=e("./core/utils/util"),n=t.readcube("article",{}).discover;return n?j.source:"^$"}function m(t,n,i){function s(e){return t(function(t){n.loadScript(e,t)})}return s(i.scripts.easeljs).then(function(){return t.all([s(i.scripts.tweenjs),s(i.scripts.movieclip)])}).then(function(){return e("./error/animation.js")})}function g(){return e("./core/includes/init_mixpanel")(),mixpanel.track("Loaded",{Client:"Web Reader"}),mixpanel}function v(){return e("./core/includes/init_ga")(),ga("require","displayfeatures"),ga("send","pageview"),ga}function w(e,t,n,i,s,r,o){var a=n.defer();return s.fetch().then(function(){a.resolve(s)}).catch(function(n){a.reject(n),401==n.status?h(sprintf("%s/session/new?redirect=%s",r.web,encodeURIComponent(location.href))):(o(n,t),e.go("error.500",null,{location:!1}))}),a.promise}function _(e,t,n){return t.init({doi:e.doi,preview:"1"}).catch(function(t){t.error&&trackError(t,e),"content_missing"==t.error&&h(u(e.doi))}).finally(function(){window.parent.postMessage({type:"initialized"},"*")}),n.init(),t}function b(e,t,n,i,s,r,o,a){return s.init({doi:t.doi},n.pickDefined(n.merge({please:t.pdfjs},t),N)).catch(function(n){return n.error&&a(n,t),i.parent&&"processing"!=n.error?void window.parent.postMessage({type:"html_unavailable"},"*"):"doi_invalid"==n.error?void e.go("error.404",null,{location:!1}):"unsupported_mobile_content"==n.error?void h(d()):/(?:content_not_allowed|content_missing)/.test(n.error)?void h(u(t.doi)):"processing"==n.error?void e.go("processing",null,{location:!1}):void e.go("error.500",null,{location:!1})}).finally(function(){window.parent.postMessage({type:"initialized"},"*")}),r.init(),o.init(),s}function y(e,t,n,i,s,r,o){return i.init({resource_id:t.resource_id},n.pickDefined(t,["sponsored"])).catch(function(n){return n.error&&o(n,t),/(?:resource_not_found|no_access)/.test(n.error)?void e.go("error.404",null,{location:!1}):"processing"==n.error?void e.go("processing",null,{location:!1}):void e.go("error.500",null,{location:!1})}).finally(function(){window.parent.postMessage({type:"initialized"},"*")}),s.init(),i}function k(e,t,n,i,s,r){return i.initSupplement(n.pickDefined(t,R)).catch(function(n){return n.error&&r(n,t),"no_access"==n.error?void h(s.app):"resource_not_found"==n.error?void e.go("error.404",null,{location:!1}):void e.go("error.500",null,{location:!1})}),i}function x(e,t){return function(n,i){t(n),e(n,i)}}function C(e,t){e.endpoint=t,e.$on("$stateChangeError",function(e,t,n,i,s,r){throw r})}function T(t,n,i,s){var r=E?"MobileReaderCtrl":"ReaderCtrl",o=E?"mobile_reader.html":"reader.html",a=E?"mobile_reader.html":"library.html";t.decorator("$exceptionHandler",x),s.html5Mode(!0).hashPrefix("!"),i.otherwise(function(){h(e("./core/endpoint").web)}),n.state("error",{abstract:!0,url:"^/error",controller:"ErrorCtrl",templateUrl:"error/error.html",resolve:{errorAnimation:m}}).state("error.404",{url:"/404",templateUrl:"error/404.html"}).state("error.500",{url:"/500",templateUrl:"error/500.html"}).state("processing",{url:"^/processing",controller:"ProcessingCtrl",templateUrl:"error/processing.html"}).state("supplement",{url:sprintf("^/supplement?%s",R.join("&")),controller:"SupplementCtrl",templateUrl:"supplement.html",resolve:{supplement:k}}).state("resolve",{url:"^/resolve/:resource_id?types",controller:"ResolveCtrl",templateUrl:"resolve.html",resolve:{article:y,user:w},params:{types:"DOI,PMID,ISBN,Journal,Year,Title,Author"}}).state("sponsored",{url:sprintf("^/s/{resource_id:%s}",S.source),controller:r,templateUrl:a,resolve:{article:y,mixpanel:g,ga:v},params:{sponsored:"1"}}).state("discover",{url:sprintf("^/{doi:%s}",f()),controller:"DiscoverCtrl",templateUrl:"discover.html",resolve:{article:_}}).state("reader",{url:sprintf("^/{doi:%s}?%s",j.source,O.join("&")),controller:r,templateUrl:o,resolve:{article:b,ga:v}}).state("library",{url:sprintf("^/{resource_id:%s}?%s",S.source,I.join("&")),controller:r,templateUrl:a,resolve:{user:w,article:y,mixpanel:g,ga:v}})}READER_VERSION={version:"1.0.12",assets:"1.0.6",build:"2017-07-19T07:31:16.308Z"},m.$inject=["$q","util","endpoint"],w.$inject=["$state","$stateParams","$q","util","user","endpoint","trackError"],_.$inject=["$stateParams","article","renderingFixes"],b.$inject=["$state","$stateParams","util","endpoint","article","access","renderingFixes","trackError"],y.$inject=["$state","$stateParams","util","article","access","endpoint","trackError"],k.$inject=["$state","$stateParams","util","article","endpoint","trackError"],x.$inject=["$delegate","trackError"],C.$inject=["$rootScope","endpoint"],T.$inject=["$provide","$stateProvider","$urlRouterProvider","$locationProvider"],e("./core/includes/trackjs"),e("./core/tracking/session"),angular.module("reader",["ui.router","ngMaterial"]),e("../../tmp/scripts/templates"),{controllers:{ArticleCtrl:e("./controllers/ArticleCtrl.js"),ArticleToolsCtrl:e("./controllers/ArticleToolsCtrl.js"),DiscoverCtrl:e("./controllers/DiscoverCtrl.js"),ErrorCtrl:e("./controllers/ErrorCtrl.js"),FigureViewerCtrl:e("./controllers/FigureViewerCtrl.js"),MenuBarCtrl:e("./controllers/MenuBarCtrl.js"),MobileReaderCtrl:e("./controllers/MobileReaderCtrl.js"),MobileToolbarCtrl:e("./controllers/MobileToolbarCtrl.js"),ProcessingCtrl:e("./controllers/ProcessingCtrl.js"),ReaderCtrl:e("./controllers/ReaderCtrl.js"),ResolveCtrl:e("./controllers/ResolveCtrl.js"),SupplementCtrl:e("./controllers/SupplementCtrl.js"),ViewerToolbarCtrl:e("./controllers/ViewerToolbarCtrl.js"),dialogs:{ComplimentaryCtrl:e("./controllers/dialogs/ComplimentaryCtrl.js"),ExportCtrl:e("./controllers/dialogs/ExportCtrl.js"),MyLibrarySuccessCtrl:e("./controllers/dialogs/MyLibrarySuccessCtrl.js"),PrintCtrl:e("./controllers/dialogs/PrintCtrl.js"),ShareCtrl:e("./controllers/dialogs/ShareCtrl.js"),ShareWileyCtrl:e("./controllers/dialogs/ShareWileyCtrl.js"),UnavailableCtrl:e("./controllers/dialogs/UnavailableCtrl.js")},sidenav:{LeaveFeedbackCtrl:e("./controllers/sidenav/LeaveFeedbackCtrl.js"),SupplementsCtrl:e("./controllers/sidenav/SupplementsCtrl.js")},toast:{AccessForbiddenCtrl:e("./controllers/toast/AccessForbiddenCtrl.js"),AnnotsNotSyncedCtrl:e("./controllers/toast/AnnotsNotSyncedCtrl.js"),AuthFailedCtrl:e("./controllers/toast/AuthFailedCtrl.js"),PromptRegisterCtrl:e("./controllers/toast/PromptRegisterCtrl.js"),ReadPersonalCtrl:e("./controllers/toast/ReadPersonalCtrl.js"),RentalExpiryCtrl:e("./controllers/toast/RentalExpiryCtrl.js"),SharedAccessCtrl:e("./controllers/toast/SharedAccessCtrl.js"),SharedAccessWileyCtrl:e("./controllers/toast/SharedAccessWileyCtrl.js"),SyncedAdCtrl:e("./controllers/toast/SyncedAdCtrl.js"),UpdateAvailableCtrl:e("./controllers/toast/UpdateAvailableCtrl.js")}}},{directives:{advertLeaderboard:e("./directives/advertLeaderboard.js"),annotations:e("./directives/annotations.js"),appnav:e("./directives/appnav.js"),article:e("./directives/article.js"),articleAnnotations:e("./directives/articleAnnotations.js"),articleCitations:e("./directives/articleCitations.js"),articleTools:e("./directives/articleTools.js"),bgImage:e("./directives/bgImage.js"),cancelEvent:e("./directives/cancelEvent.js"),checkout:e("./directives/checkout.js"),citedBy:e("./directives/citedBy.js"),clipboard:e("./directives/clipboard.js"),figure:e("./directives/figure.js"),hammerSidenav:e("./directives/hammerSidenav.js"),infiniteScroll:e("./directives/infiniteScroll.js"),login:e("./directives/login.js"),menuBar:e("./directives/menuBar.js"),metadata:e("./directives/metadata.js"),metrics:e("./directives/metrics.js"),mobileAnnotations:e("./directives/mobileAnnotations.js"),mobileArticle:e("./directives/mobileArticle.js"),mobileArticleAnnotations:e("./directives/mobileArticleAnnotations.js"),mobileSlider:e("./directives/mobileSlider.js"),mobileToolbar:e("./directives/mobileToolbar.js"),onLoad:e("./directives/onLoad.js"),pageInfo:e("./directives/pageInfo.js"),postSelection:e("./directives/postSelection.js"),readMode:e("./directives/readMode.js"),references:e("./directives/references.js"),referrenceList:e("./directives/referrenceList.js"),responsive:e("./directives/responsive.js"),supplementInfo:e("./directives/supplementInfo.js"),targetClick:e("./directives/targetClick.js"),viewer:e("./directives/viewer.js"),viewerToolbar:e("./directives/viewerToolbar.js")}},{services:{altmetricInit:e("./services/altmetricInit.js"),articleExport:e("./services/articleExport.js"),articlePrint:e("./services/articlePrint.js"),core:e("./services/core.js"),figureViewer:e("./services/figureViewer.js"),infoBar:e("./services/infoBar.js"),introTip:e("./services/introTip.js"),share:e("./services/share.js"),toast:e("./services/toast.js"),userModal:e("./services/userModal.js"),userSidenav:e("./services/userSidenav.js"),videoPlayer:e("./services/videoPlayer.js")}},{filters:{articleKeywords:e("./filters/articleKeywords.js"),authorShortName:e("./filters/authorShortName.js"),breaksToSpaces:e("./filters/breaksToSpaces.js"),clipTitle:e("./filters/clipTitle.js"),figureCaption:e("./filters/figureCaption.js"),formatDate:e("./filters/formatDate.js"),join:e("./filters/join.js"),kilo:e("./filters/kilo.js"),linkify:e("./filters/linkify.js"),refPublishInfo:e("./filters/refPublishInfo.js"),rentalDuration:e("./filters/rentalDuration.js"),trustUrl:e("./filters/trustUrl.js")}};var A=l(),E=e("./core/utils/mobile_detect").any,j=/10\.\d{3,9}.+/,S=/.+:[0-9a-fA-F]{8}(?:-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}/,X=e("./core/access_token"),Y=(X.SHARING_TOKENS,X.ACCESS_TOKENS),I=["preview","please","use_s3","pdfjs","intro","scibite"],P=["purchase_referrer","purchase_site_license","tracking_referrer","tracking_action"],R=["resource_id","doi","index","lang","sponsored","ssl","st"].concat(I),N=["parent_url","lang","cochrane","publisher","shared_annotations"].concat(Y).concat(I),O=["ssl","lightbox","show_close","standalone_access"].concat(N).concat(P);angular.module("reader").constant("MOBILE",E).constant("SUPPL_PARAMS",R).constant("CONST",e("./core/includes/const")).constant("API_KEYS",e("./core/includes/api_keys")).config(T).run(C),s().finally(r)},{"../../tmp/scripts/templates":213,"./controllers/ArticleCtrl.js":44,"./controllers/ArticleToolsCtrl.js":45,"./controllers/DiscoverCtrl.js":46,"./controllers/ErrorCtrl.js":47,"./controllers/FigureViewerCtrl.js":48,"./controllers/MenuBarCtrl.js":49,"./controllers/MobileReaderCtrl.js":50,"./controllers/MobileToolbarCtrl.js":51,"./controllers/ProcessingCtrl.js":52,"./controllers/ReaderCtrl.js":53,"./controllers/ResolveCtrl.js":54,"./controllers/SupplementCtrl.js":55,"./controllers/ViewerToolbarCtrl.js":56,"./controllers/dialogs/ComplimentaryCtrl.js":57,"./controllers/dialogs/ExportCtrl.js":58,"./controllers/dialogs/MyLibrarySuccessCtrl.js":59,"./controllers/dialogs/PrintCtrl.js":60,"./controllers/dialogs/ShareCtrl.js":61,"./controllers/dialogs/ShareWileyCtrl.js":62,"./controllers/dialogs/UnavailableCtrl.js":63,"./controllers/sidenav/LeaveFeedbackCtrl.js":64,"./controllers/sidenav/SupplementsCtrl.js":65,"./controllers/toast/AccessForbiddenCtrl.js":66,"./controllers/toast/AnnotsNotSyncedCtrl.js":67,"./controllers/toast/AuthFailedCtrl.js":68,"./controllers/toast/PromptRegisterCtrl.js":69,"./controllers/toast/ReadPersonalCtrl.js":70,"./controllers/toast/RentalExpiryCtrl.js":71,"./controllers/toast/SharedAccessCtrl.js":72,"./controllers/toast/SharedAccessWileyCtrl.js":73,"./controllers/toast/SyncedAdCtrl.js":74,"./controllers/toast/UpdateAvailableCtrl.js":75,"./core/access_token":77,"./core/command":92,"./core/compatible":93,"./core/endpoint":95,"./core/includes/api_keys":101,"./core/includes/const":102,"./core/includes/init_ga":105,"./core/includes/init_mixpanel":106,"./core/includes/trackjs":109,"./core/receiver":113,"./core/tracking/session":123,"./core/update":127,"./core/user":128,"./core/user_storage":129,"./core/utils/mobile_detect":135,"./core/utils/util":143,"./directives/advertLeaderboard.js":152,"./directives/annotations.js":153,"./directives/appnav.js":154,"./directives/article.js":155,"./directives/articleAnnotations.js":156,"./directives/articleCitations.js":157,"./directives/articleTools.js":158,"./directives/bgImage.js":159,"./directives/cancelEvent.js":160,"./directives/checkout.js":161,"./directives/citedBy.js":162,"./directives/clipboard.js":163,"./directives/figure.js":164,"./directives/hammerSidenav.js":165,"./directives/infiniteScroll.js":166,"./directives/login.js":167,"./directives/menuBar.js":168,"./directives/metadata.js":169,"./directives/metrics.js":170,"./directives/mobileAnnotations.js":171,"./directives/mobileArticle.js":172,"./directives/mobileArticleAnnotations.js":173,"./directives/mobileSlider.js":174,"./directives/mobileToolbar.js":175,"./directives/onLoad.js":176,"./directives/pageInfo.js":177,"./directives/postSelection.js":178,"./directives/readMode.js":179,"./directives/references.js":180,"./directives/referrenceList.js":181,"./directives/responsive.js":182,"./directives/supplementInfo.js":183,"./directives/targetClick.js":184,"./directives/viewer.js":185,"./directives/viewerToolbar.js":186,"./error/animation.js":187,"./filters/articleKeywords.js":188,"./filters/authorShortName.js":189,"./filters/breaksToSpaces.js":190,"./filters/clipTitle.js":191,"./filters/figureCaption.js":192,"./filters/formatDate.js":193,"./filters/join.js":194,"./filters/kilo.js":195,"./filters/linkify.js":196,"./filters/refPublishInfo.js":197,
"./filters/rentalDuration.js":198,"./filters/trustUrl.js":199,"./services/altmetricInit.js":201,"./services/articleExport.js":202,"./services/articlePrint.js":203,"./services/core.js":204,"./services/figureViewer.js":205,"./services/infoBar.js":206,"./services/introTip.js":207,"./services/share.js":208,"./services/toast.js":209,"./services/userModal.js":210,"./services/userSidenav.js":211,"./services/videoPlayer.js":212}],201:[function(e,t,n){function i(e,t,n,i){function s(e,t){return/nature|wiley|ats/.test(t)?("ats"==t&&(t="atsjournals"),sprintf("%s//%s.altmetric.com/details/%s",location.protocol,t,e.altmetric_id)):e.details_url}var r=null;return new Promise(function(o,a){return r?void o(r):void n.onInit(function(){return n.get().doi?void e.get(sprintf("%s/v1/doi/%s",t.altmetric,n.get().doi),{params:{key:i.altmetric}}).then(function(e){o(r={images:e.data.images,score:Math.ceil(e.data.score),detailsUrl:s(e.data,n.get().publisher)})},a):void a()})})}i.$inject=["$http","endpoint","article","API_KEYS"],angular.module("reader").factory("altmetricInit",i)},{}],202:[function(e,t,n){function i(e,t,n,i,s,r,o){function a(t,n){var s={targetEvent:t,clickOutsideToClose:!0,locals:{action:n}};i.isShared()?e.show(e.alert(angular.merge(s,{templateUrl:"dialogs/complimentary_access.html",controller:"ComplimentaryCtrl"}))):e.show(e.alert(angular.merge(s,{templateUrl:"dialogs/action_unavailable.html",controller:"UnavailableCtrl"})))}function c(t){e.show(e.alert({targetEvent:t,clickOutsideToClose:!0,templateUrl:"dialogs/print_options.html",controller:"PrintCtrl"}))}function l(e){return i.isPersonal()||!s.externalCheckAvailable()||i.get()[e+"_url"]}function u(e,t){i.onceAccessChecked(function(){l(e)?t():s.onExternalCheck(t)})}function d(e){return t.post(n.services+"/reader/pdf",e,{headers:{contentType:"application/json; charset=UTF-8"}})}function h(){var e=i.get().location,t=i.get().cover,n=i.get().pdf_url,s=o.listArr();return t||s.length||/^china$/i.test(e.country||"")?d({url:n,annotations:s,cover:t}).then(function(e){location.href=e.data.redirect},function(){location.href=n}):(location.href=n,Promise.resolve())}function p(e){return new Promise(function(t,n){u("pdf",function(){i.get().pdf_url?(r.download(!0),h().then(t,n)):i.hasAccess()?(r.download(!1),a(e,"download"),n("rental")):(r.download(!1),n("preview"))})})}function f(e){return new Promise(function(t,n){u("print",function(){i.get().print_url?(c(e),t()):i.hasAccess()?(a(e,"print"),n("rental")):n("preview")})})}var m={};return m.download=p,m.print=f,m}i.$inject=["$mdDialog","$http","endpoint","article","access","tracker","annotationsModel"],angular.module("reader").factory("articleExport",i)},{}],203:[function(e,t,n){function i(e,t,n,i,s,r,o,a,c,l,u){function d(){return s.local.get("readcube-print-annotations")}function h(t){return e.post(i.services+"/reader/pdf",t)}function p(){var e={print:!0,url:r.get().pdf_url,cover:r.get().cover},t=l.listArr();return t.length&&d()&&(e.annotations=t),e}function f(){return new Promise(function(e){b?e():$.getScript(i.scripts.cpgadget,function(){b=new cloudprint.Gadget,e()})})}function m(){return c.saveCloud(),a.item.add().catch(_.noop)}function g(){c.print("hd");var e=r.get().location,t=r.get().cover,n=r.get().print_url;return t||d()||/^china$/i.test(e.country||"")?h(p()).then(function(e){window.open(e.data.redirect,"_blank")},function(){window.open(n,"_blank")}):(window.open(n,"_blank"),Promise.resolve())}function v(){return c.print("cloud"),f().then(function(){b.setPrintDocument("url","",r.get().print_url),b.openPrintDialog()})}function w(){return c.print("mobile"),o.signedIn()?m():new Promise(function(e){u.showRegister({params:{tracking_action:"print_send_to_mobile",tracking_origin:c.trackingOrigin()},onAuth:function(){m().then(e)}})})}var b=null;return{pdf:g,cloud:v,mobile:w}}i.$inject=["$http","util","browser","endpoint","storage","article","user","sync","tracker","annotationsModel","userModal"],angular.module("reader").factory("articlePrint",i)},{}],204:[function(e,t,n){angular.module("reader").factory("access",function(){return e("../core/access")}).factory("accessToken",function(){return e("../core/access_token")}).factory("annotationsController",function(){return e("../core/annotations/annotations_controller")}).factory("annotationsModel",function(){return e("../core/annotations/annotations_model")}).factory("article",function(){return e("../core/article")}).factory("banner",function(){return e("../core/banner")}).factory("browser",function(){return e("../core/utils/browser")}).factory("citationsModel",function(){return e("../core/citations/citations_model")}).factory("citationDrawer",function(){return e("../core/citations/citation_drawer")}).factory("command",function(){return e("../core/command")}).factory("endpoint",function(){return e("../core/endpoint")}).factory("environment",function(){return e("../core/environment")}).factory("exporter",function(){return e("../core/export/exporter")}).factory("initMixpanel",function(){return e("../core/includes/init_mixpanel")}).factory("popover",function(){return e("../core/elements/popover")}).factory("receiver",function(){return e("../core/receiver")}).factory("Selection",function(){return e("../core/annotations/selection")}).factory("SelectionToolbar",function(){return e("../core/annotations/selection_toolbar")}).factory("storage",function(){return e("../core/utils/storage")}).factory("sync",function(){return e("../core/sync/sync")}).factory("supplement",function(){return e("../core/supplement")}).factory("update",function(){return e("../core/update")}).factory("user",function(){return e("../core/user")}).factory("userStorage",function(){return e("../core/user_storage")}).factory("util",function(){return e("../core/utils/util")}).factory("rangeSerializer",function(){return e("../core/utils/range_serializer")}).factory("renderingFixes",function(){return e("../core/rendering_fixes")}).factory("Rect",function(){return e("../core/utils/rect")}).factory("ResolveToolbar",function(){return e("../core/annotations/resolve_toolbar")}).factory("termiteModel",function(){return e("../core/termite/termite_model")}).factory("trackId",function(){return e("../core/tracking/track_id")}).factory("tracker",function(){return e("../core/tracking/tracker")}).factory("trackError",function(){return e("../core/tracking/track_error")}).factory("visibility",function(){return e("../core/utils/visibility")}).factory("viewer",function(){return e("../core/viewer/viewer")}).factory("mobileViewer",function(){return e("../core/viewer/mobile_viewer")})},{"../core/access":76,"../core/access_token":77,"../core/annotations/annotations_controller":81,"../core/annotations/annotations_model":82,"../core/annotations/resolve_toolbar":84,"../core/annotations/selection":85,"../core/annotations/selection_toolbar":86,"../core/article":87,"../core/banner":88,"../core/citations/citation_drawer":90,"../core/citations/citations_model":91,"../core/command":92,"../core/elements/popover":94,"../core/endpoint":95,"../core/environment":96,"../core/export/exporter":98,"../core/includes/init_mixpanel":106,"../core/receiver":113,"../core/rendering_fixes":114,"../core/supplement":116,"../core/sync/sync":119,"../core/termite/termite_model":121,"../core/tracking/track_error":124,"../core/tracking/track_id":125,"../core/tracking/tracker":126,"../core/update":127,"../core/user":128,"../core/user_storage":129,"../core/utils/browser":131,"../core/utils/range_serializer":137,"../core/utils/rect":138,"../core/utils/storage":139,"../core/utils/util":143,"../core/utils/visibility":144,"../core/viewer/mobile_viewer":148,"../core/viewer/viewer":151}],205:[function(e,t,n){function i(e,t,n){function i(i){function s(){r&&r.$destroy(),o&&o.remove(),$(".reader").removeClass("distraction-free")}var r=angular.merge(n.$new(!0),{index:i,close:s}),o=e(t.get("figure_viewer.html"))(r);o.on("mousedown mouseup click",function(e){e.stopPropagation()}),$(".reader").addClass("distraction-free").append(o)}return i}i.$inject=["$compile","$templateCache","$rootScope"],angular.module("reader").factory("figureViewer",i)},{}],206:[function(e,t,n){function i(e){function t(t){return $(".reader").append(e.get(t.templateUrl)).addClass("info-bar-visible"),++s}function n(e){e&&e!=s||$(".reader").removeClass("info-bar-visible").find(".info-bar").remove()}var i={},s=0;return i.hide=n,i.notifySharedAccessWiley=function(){return t({templateUrl:"info_bar/shared_access_wiley.html"})},i.notifySharedPaywallWiley=function(){return t({templateUrl:"info_bar/shared_paywall_wiley.html"})},i}i.$inject=["$templateCache"],angular.module("reader").factory("infoBar",i)},{}],207:[function(e,t,n){function i(e,t,n,i,s,r,o){function a(e){return"intro-tip:"+e}function c(e){return!1}function l(i){function o(i,s){p=t(n.get(i))(angular.merge(e.$new(!0),{close:function(e){r.close(h),"disable_tips"==e?$(u).trigger("disable-tips"):$(d).trigger("action",[e])}},s))}function l(e,t){s.local.set(a(i),"shown"),h=e,h.on("close.popover",function(){$(d).trigger("close")}),r.open({placement:t,content:p,anchor:h})}if(!c(i))return null;var d={},h=null,p=null;return $(u).on("disable-tips",function(){s.local.set(a(i),"shown"),$(d).trigger("close")}),d.compile=o,d.show=l,d}var u={};return{create:l,enabled:c}}i.$inject=["$rootScope","$compile","$templateCache","$stateParams","storage","popover","article"],angular.module("reader").factory("introTip",i)},{}],208:[function(e,t,n){function i(e,t,n,i,s){function r(e){return e?s.writeShared().then(function(e){return n.generateSharedAccess({shared_annotations:e,url:c}).then(function(e){return i.shareToken(e.token),e})}):new Promise(function(e,t){a?e(a):n.generateSharedAccess({url:c}).then(function(t){i.shareToken(t.token),e(a=t)},t)})}var o={},a=null,c=[location.protocol,"//",location.host,location.pathname].join("");return"wiley"==n.get().publisher&&(e.production()?c="http://onlinelibrary.wiley.com/doi/"+n.get().doi+"/epdf":t.parent&&(c="http://"+parseUri(t.parent).host+"/doi/"+n.get().doi+"/epdf"),c=encodeURI(c)),o.generate=r,o}i.$inject=["environment","endpoint","article","tracker","annotationsModel"],angular.module("reader").factory("share",i)},{}],209:[function(e,t,n){function i(e,t,n,i){function s(e){return i?e.replace("toast/","toast/mobile/"):e}function r(n){if(!e.includes("error"))return t.show(angular.merge({locals:{toastId:++c},position:i?"bottom":"top right",hideDelay:!1},n)),c}function o(e){e&&e!=c||t.hide()}var a={},c=0;return a.hide=o,a.notifyMessage=function(e){return r({templateUrl:s("toast/info_message.html"),controller:["$scope",function(n){n.message=e,n.close=function(){t.hide()}}]})},a.notifyUpdateAvailable=function(){return r({templateUrl:s("toast/update_available.html"),controller:"UpdateAvailableCtrl"})},a.notifyRentalExpiry=function(){return r({templateUrl:s("toast/rental_expiry.html"),controller:"RentalExpiryCtrl"})},a.notifyReadPersonal=function(){return r({templateUrl:s("toast/read_personal.html"),controller:"ReadPersonalCtrl"})},a.notifyAuthFailed=function(){return r({templateUrl:s("toast/auth_failed.html"),controller:"AuthFailCtrl"})},a.notifyAccessForbidden=function(){return r({templateUrl:s("toast/access_forbidden.html"),controller:"AccessFrobiddenCtrl"})},a.notifySharedAccess=function(){return r({templateUrl:s("toast/shared_access.html"),controller:"SharedAccessCtrl"})},a.notifySharedAccessWiley=function(){return r({locals:{type:"access"},templateUrl:s("toast/shared_access_wiley.html"),controller:"SharedAccessWileyCtrl"})},a.notifySharedPaywallWiley=function(){return r({locals:{type:"paywall"},templateUrl:s("toast/shared_access_wiley.html"),controller:"SharedAccessWileyCtrl"})},a.notifyAnnotsNotSynced=function(){if(!a.notifyAnnotsNotSynced.shown)return a.notifyAnnotsNotSynced.shown=!0,r({templateUrl:s("toast/annots_not_synced.html"),controller:"AnnotsNotSyncedCtrl"})},a.showSyncedAd=function(){if(!n.get("synced-ad-shown"))return n.set("synced-ad-shown",!0),r({templateUrl:s("toast/synced_ad.html"),controller:"SyncedAdCtrl"})},a.promptRegister=function(e){return r({templateUrl:s("toast/prompt_register.html"),controller:"PromptRegisterCtrl",locals:{onAuth:e}})},window.toast=a,a}i.$inject=["$state","$mdToast","userStorage","MOBILE"],angular.module("reader").factory("toast",i)},{}],210:[function(e,t,n){function i(e,t,n,i){function s(n,i){var s="register"==n?"/user/new":"/session/new";return e.addParams(t.web+s,e.merge(d,i))}function r(e,t){t=t||{},i.show(i.alert({templateUrl:"dialogs/user.html",clickOutsideToClose:!0,targetEvent:t.targetEvent,controller:["$scope","endpoint",function(n,i){n.endpoint=i,n.showLogin=a,n.showRegister=c,n.src=s(e,t.params),t.registerAd&&(n.registerAd=t.registerAd,n.closeRegisterAd=function(){n.registerAd=null}),o(function(e,i){t.onAuth&&t.onAuth(i),t.successAd?n.successAd=t.successAd:l()})}]}))}function o(e){$(n).off("auth.single"),$(n).one("auth.single",e)}function a(e){r("login",e)}function c(e){r("register",e)}function l(){return i.hide()}var u={},d={parent_url:location.toString(),embed:1,html5:1};return u.showLogin=a,u.showRegister=c,u.hide=l,u}i.$inject=["util","endpoint","user","$mdDialog"],angular.module("reader").factory("userModal",i)},{}],211:[function(e,t,n){function i(e,t,n,i,s,r,o,a){function c(e,t){var n=i.$new(!0);return n.title=t.title||"Login / Register",n.endpoint=o,n.src=l(e,t.params),n.close=f,t.registerAd&&(n.registerAd=t.registerAd,n.closeRegisterAd=function(){n.registerAd=null}),n}function l(e,t){var n="register"==e?"/user/new":"/session/new";return r.addParams(o.web+n,r.merge(v,t))}function u(e,i){$("#user-sidenav").remove();var r=n.get("sidenav/mobile_user.html");t(r)(c(e,i)).appendTo(document.body),s("user").open()}function d(e){$(a).off("auth.single"),$(a).one("auth.single",function(t,n){e&&e(n)})}function h(e){d(e.onAuth),u("login",e)}function p(e){d(e.onAuth),u("register",e)}function f(){$("#user-sidenav").length&&s("user").close().then(function(){$("#user-sidenav").remove()})}function m(){$(a).on("auth",f)}var g={},v={parent_url:location.toString(),mobile:1,embed:1,html5:1};return m(),g.showLogin=h,g.showRegister=p,g.hide=f,g}i.$inject=["$sce","$compile","$templateCache","$rootScope","$mdSidenav","util","endpoint","user"],angular.module("reader").factory("userSidenav",i)},{}],212:[function(e,t,n){function i(e,t,n,i,s,r,o){function a(e){return new Promise(function(e){window.videojs?e():(s.loadCss(r.stylesheets.videojs),$.getScript(r.scripts.videojs,e))})}function c(s){a().then(function(){function r(){a&&a.dispose(),l&&l.$destroy(),u&&u.remove(),$(".reader").removeClass("distraction-free")}var a=null,c="video-"+s.index,l=angular.merge(e.$new(!0),{mobile:o,videoId:c,video:s,close:r}),u=t(n.get("video_player.html"))(l);u.on("mousedown mouseup click",function(e){e.stopPropagation()}),$(".reader").addClass("distraction-free").append(u),i(function(){a=videojs(c,{width:Math.min(640,.9*screen.width),height:Math.min(480,.9*screen.height-100),autoplay:!0})})})}return c}i.$inject=["$rootScope","$compile","$templateCache","$timeout","util","endpoint","MOBILE"],angular.module("reader").factory("videoPlayer",i)},{}],213:[function(e,t,n){t.exports=angular.module("reader").run(["$templateCache",function(e){e.put("article.html",'<viewer class="viewer hw-accel"\n  article-citations\n  article-annotations>\n  <div id="advert-leaderboard" advert-leaderboard></div>\n  <div id="journal-banner"></div>\n</viewer>\n\n<page-info></page-info>\n<viewer-toolbar></viewer-toolbar>\n\n<ng-include src="\'popover/annotations.html\'"></ng-include>\n'),e.put("article_tools.html",'<div class="article-tools" ng-hide="!toolsEnabled()">\n  <md-fab-speed-dial\n    class="md-scale"\n    md-open="isOpen"\n    md-direction="up"\n    ng-mouseenter="setOpen(true)"\n    ng-mouseleave="setOpen(false, 800)">\n    <md-fab-trigger cancel-event="mousedown mouseup click" role="button">\n      <md-button\n        ng-click="defaultAction && defaultAction.handler()"\n        class="md-fab hw-accel" ng-class="{\'default-action\': defaultAction}">\n        <md-tooltip\n          ng-if="defaultAction.tooltip"\n          md-visible="tooltipVisible"\n          md-direction="left"\n          md-delay="50" md-autohide="false">\n          {{defaultAction.tooltip}}\n        </md-tooltip>\n        <i class="material-icons more">more_vert</i>\n        <i class="material-icons action">{{defaultAction.icon}}</i>\n      </md-button>\n    </md-fab-trigger>\n    <md-fab-actions>\n      <md-button\n        ng-if="::article.get().doi && metadata"\n        ng-click="export($event)"\n        class="md-fab md-raised md-mini export">\n        <md-tooltip md-direction="left" md-visible="tooltipVisible" md-delay="50" md-autohide="false">\n          Export Citation\n        </md-tooltip>\n        <i class="material-icons">file_upload</i>\n      </md-button>\n      <md-button\n        ng-if="::altmetric.score"\n        ng-click="openAltmetric()"\n        class="md-fab md-raised md-mini altmetric">\n        <md-tooltip md-direction="left" md-visible="tooltipVisible" md-delay="50" md-autohide="false">\n          Altmetric ({{::altmetric.score}})\n        </md-tooltip>\n        <div class="altmetric-embed">\n          <img ng-src="{{::altmetric.images.medium}}" width="100px" height="100px">\n        </div>\n      </md-button>\n      <md-button\n        ng-if="::article.get().doi && article.get().meta.url"\n        ng-click="gotoPublisher()"\n        class="md-fab md-raised md-mini goto-publisher">\n        <md-tooltip md-direction="left" md-visible="tooltipVisible" md-delay="50" md-autohide="false">\n          {{::publisherPageLabel || \'Go to article page\'}}\n        </md-tooltip>\n        <i class="material-icons">web</i>\n      </md-button>\n      <md-button\n        ng-if="::article.get().doi && defaultAction.handler != openRelated"\n        ng-click="openRelated()"\n        class="md-fab md-raised md-mini related">\n        <md-tooltip md-direction="left" md-visible="tooltipVisible" md-delay="50" md-autohide="false">\n          Related articles\n        </md-tooltip>\n        <i class="material-icons">layers</i>\n      </md-button>\n      <md-button\n        ng-if="::figures.length"\n        ng-click="openFigures()"\n        class="md-fab md-raised md-mini figures">\n        <md-tooltip md-direction="left" md-visible="tooltipVisible" md-delay="50" md-autohide="false">\n          Figures ({{::figures.length}})\n        </md-tooltip>\n        <i class="material-icons">photo_library</i>\n      </md-button>\n      <md-button\n        ng-if="notesEnabled()"\n        ng-click="toggleAnnots()"\n        class="md-fab md-raised md-mini annotations">\n        <md-tooltip md-direction="left" md-visible="tooltipVisible" md-delay="50" md-autohide="false">\n          Notes <span ng-if="notes.length">({{notes.length}})</span>\n        </md-tooltip>\n        <i class="material-icons">chat</i>\n      </md-button>\n      <md-button\n        ng-if="::article.get().access_share_enabled"\n        ng-click="share($event)"\n        class="md-fab md-raised md-mini share">\n        <md-tooltip md-direction="left" md-visible="tooltipVisible" md-delay="50" md-autohide="false">\n          Share\n        </md-tooltip>\n        <i class="material-icons">share</i>\n      </md-button>\n    </md-fab-actions>\n  </md-fab-speed-dial>\n</div>\n'),e.put("discover.html",'<div class="reader discover-reader article-container">\n  <viewer class="viewer hw-accel"></viewer>\n\n  <div class="bottom unselectable">\n    <a class="publisher-site-link" ng-href="{{::articleUrl}}">\n      View the entire article on\n      <div class="logo"></div>\n      <div class="arrow"></div>\n    </a>\n  </div>\n</div>'),e.put("figure_viewer.html",'<div class="modal-backdrop"></div>\n<div\n  ng-controller="FigureViewerCtrl"\n  ng-class="{\'details-open\': detailsOpen}"\n  class="figure-overlay">\n  <div\n    class="md-whiteframe-z2 figure-details">\n    <h3>{{figure().caption | figureCaptionLabel}}</h3>\n    <md-button class="md-icon-button close grey" ng-click="toggleDetails()">\n      <i class="material-icons">close</i>\n    </md-button>\n    <div class="blue-divider"></div>\n    <h4>{{figure().caption | figureCaptionTitle}}</h4>\n    <span>{{figure().caption | figureCaptionText}}</span>\n  </div>\n  <div class="figure-content">\n    <div class="header md-whiteframe-1dp">\n      <div class="left">\n        <i\n          class="material-icons header-btn icon-btn"\n          ng-click="close()"\n          md-ink-ripple="#FFF">\n          arrow_back\n        </i>\n      </div>\n      <div class="center">\n        <a\n          class="header-btn download"\n          ng-href="{{figure().download_url}}"\n          md-ink-ripple="#FFF">\n          <i class="material-icons">file_download</i>\n          <span>Download</span>\n        </a>\n      </div>\n      <div class="right">\n        <i\n          class="material-icons show-details header-btn icon-btn"\n          ng-click="toggleDetails()"\n          md-ink-ripple="#FFF">\n          chrome_reader_mode\n        </i>\n      </div>\n    </div>\n    <div class="wrap">\n      <div class="full" ng-class="{busy: busy}" target-click="close()">\n        <div class="nav-arrow prev" ng-if="showNav" ng-click="prev()" md-ink-ripple="#FFF">\n          <div class="icon-container">\n            <i class="material-icons">navigate_before</i>\n          </div>\n        </div>\n        <img ng-src="{{figure().url}}" on-load="busy = false"/>\n        <spinner></spinner>\n        <div class="nav-arrow next" ng-if="showNav" ng-click="next()" md-ink-ripple="#FFF">\n          <div class="icon-container">\n            <i class="material-icons">navigate_next</i>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'),e.put("library.html",'<div class="reader personal" read-mode="distraction-free">\n\n  <div class="content article-container">\n    <article></article>\n    <article-tools></article-tools>\n    <div\n      class="prev-article"\n      ng-if="::goPrev"\n      ng-click="goPrev()">\n      <i class="material-icons">arrow_back</i>\n    </div>\n    <div\n      class="next-article"\n      ng-if="::goNext"\n      ng-click="goNext()">\n      <i class="material-icons">arrow_forward</i>\n    </div>\n  </div>\n\n  <ng-include src="\'sidenav/rcr.html\'"></ng-include>\n  <ng-include src="\'sidenav/supplements.html\'"></ng-include>\n  <ng-include src="\'sidenav/references.html\'"></ng-include>\n  <ng-include src="\'sidenav/annotations.html\'"></ng-include>\n  <ng-include src="\'sidenav/cited_by.html\'"></ng-include>\n  <ng-include src="\'sidenav/figures.html\'"></ng-include>\n  <ng-include src="\'sidenav/related.html\'"></ng-include>\n  <ng-include src="\'sidenav/appnav.html\'"></ng-include>\n\n  <menu-bar><menu-bar>\n</div>\n\n<ng-include class="print-notice" src="\'print_notice.html\'"></ng-include>\n'),e.put("menu_bar.html",'<div\n  class="menu-bar article-menu md-whiteframe-1dp"\n  ng-class="{\'signed-in\': user.signedIn(), \'sharing-token\': $root.sharingToken, \'sharing\': $root.sharing, \'contracted\': contracted}"\n  responsive>\n  <div\n    class="close"\n    ng-if="::showClose"\n    md-ink-ripple="#FFF"\n    ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n  <div class="left">\n    <div\n      class="rc-menu"\n      ng-click="onAppMenuClick($event)"\n      md-ink-ripple="#FFF">\n      <i class="material-icons app-menu">menu</i>\n      <div class="rc-logo"></div>\n      <span class="rc-text">My Library</span>\n    </div>\n  </div>\n  <div class="center">\n    <div\n      class="menu-btn download sticky"\n      ng-class="{busy: downloading}"\n      ng-click="downloadPdf($event)">\n      <div class="inner" md-ink-ripple="#FFF">\n        <div class="icon-container">\n          <div class="spinner-container">\n            <spinner></spinner>\n          </div>\n          <i class="material-icons">file_download</i>\n        </div>\n        <span>Download PDF</span>\n      </div>\n      <md-tooltip ng-if="contracted" md-direction="bottom" md-autohide="true">\n        <span>Download PDF</span>\n      </md-tooltip>\n    </div>\n    <div\n      class="menu-btn download get-access sticky"\n      ng-click="getAccess()">\n      <div class="inner" md-ink-ripple="#FFF">\n        <div class="icon-container">\n          <i class="material-icons">lock_open</i>\n        </div>\n        <span>Get Access</span>\n      </div>\n      <md-tooltip ng-if="contracted" md-direction="bottom" md-autohide="true">\n        <span>Get Access</span>\n      </md-tooltip>\n    </div>\n    <div\n      ng-if="::article.get().sync_enabled"\n      class="menu-btn add-to-library sticky"\n      ng-class="{busy: syncing, added: inLibrary}"\n      ng-click="toggleInLibrary($event)"\n      md-ink-ripple="#FFF">\n      <div class="icon-container">\n        <div class="spinner-container">\n          <spinner></spinner>\n        </div>\n        <i class="material-icons upload">cloud_upload</i>\n        <i class="material-icons in-cloud">cloud</i>\n        <i class="material-icons remove">cloud_off</i>\n      </div>\n      <span class="upload">Add To Library</span>\n      <span class="in-cloud">In Library</span>\n      <span class="remove">Remove</span>\n      <md-tooltip ng-if="contracted" md-direction="bottom" md-autohide="true">\n        {{inLibrary ? \'Remove From Library\' : \'Add To Library\'}}\n      </md-tooltip>\n    </div>\n    <div\n      ng-if="::supplements.length"\n      class="menu-btn md-badge"\n      md-ink-ripple="#FFF"\n      data-badge="{{::supplements.length}}"\n      ng-click="openSupplements()">\n      Supplements\n    </div>\n    <div\n      ng-if="::references.length"\n      class="menu-btn md-badge"\n      md-ink-ripple="#FFF"\n      data-badge="{{::references.length}}"\n      ng-click="openReferences()">\n      References\n    </div>\n    <div\n      ng-if="::article.get().doi && metadata.citations_count"\n      class="menu-btn md-badge metrics"\n      md-ink-ripple="#FFF"\n      ng-attr-data-badge="{{::metadata.citations_count | kilo}}"\n      ng-click="openMetrics()">\n      Cited By\n    </div>\n    <div\n      ng-if="::article.get().doi && metadata.rcr"\n      class="menu-btn md-badge rcr"\n      md-ink-ripple="#FFF"\n      ng-click="openRCR()">\n      RCR: <span>{{::(+metadata.rcr).toFixed(2)}}</span>\n    </div>\n    <md-menu\n      class="menu-btn more sticky"\n      ng-if="::supplements.length || references.length || article.get().doi"\n      md-position-mode="target-right target">\n      <i\n        class="material-icons"\n        ng-click="openMoreMenu($mdOpenMenu, $event)"\n        md-ink-ripple="#FFF">\n        more_vert\n      </i>\n      <md-menu-content width="2" class="more-menu">\n        <md-menu-item ng-if="::supplements.length">\n          <md-button ng-click="openSupplements()">\n            <div class="md-badge" data-badge="{{::supplements.length}}">Supplements</div>\n          </md-button>\n        </md-menu-item>\n        <md-menu-item ng-if="::references.length">\n          <md-button ng-click="openReferences()">\n            <div class="md-badge" data-badge="{{::references.length}}">References</div>\n          </md-button>\n        </md-menu-item>\n        <md-menu-item ng-if="::article.get().doi && metadata.citations_count">\n          <md-button ng-click="openMetrics()">\n            <div class="md-badge" ng-attr-data-badge="{{::metadata.citations_count | kilo}}">Cited By</div>\n          </md-button>\n        </md-menu-item>\n        <md-menu-item ng-if="::article.get().doi && metadata.rcr">\n          <md-button ng-click="openRCR()">\n            <div class="rcr">RCR: <span>{{::(+metadata.rcr).toFixed(2)}}</span></div>\n          </md-button>\n        </md-menu-item>\n      </md-menu-content>\n    </md-menu>\n  </div>\n  <div\n    class="right publisher-logo"\n    ng-if="::!showClose"\n    ng-class="{link: !!publisherLinkout}"\n    ng-click="publisherLinkout()">\n    <i class="material-icons">navigate_next</i>\n  </div>\n</div>\n'),e.put("metadata.html",'<title ng-bind="::meta.title"></title>\n\n<link rel="canonical" href="{{::canonical}}" ng-if="::canonical">\n\n<meta name="description" content="{{::meta.abstract}}" ng-if="::meta.abstract">\n<meta name="keywords" content="{{::meta | articleKeywords}}" ng-if="::meta.journal && meta.doi">\n\n<link rel="schema.DC" href="http://purl.org/dc/elements/1.1">\n\n<meta name="DC.title" content="{{::meta.title}}" ng-if="::meta.title">\n<meta name="DC.identifier" content="doi:{{::meta.doi}}" ng-if="::meta.doi">\n\n<meta name="citation_doi" content="{{::meta.doi}}" ng-if="::render_doi">\n<meta name="citation_title" content="{{::meta.title}}" ng-if="::meta.title">\n<meta name="citation_journal_title" content="{{::meta.journal}}" ng-if="::meta.journal">\n<meta name="citation_volume" content="{{::meta.volume}}" ng-if="::meta.volume">\n<meta name="citation_date" content="{{::meta.year}}" ng-if="::meta.year">\n\n<meta name="citation_author" content="{{::author.name}}" ng-repeat="author in meta.authors">\n<meta name="DC.creator" content="{{::author.name}}" ng-repeat="author in meta.authors">\n\n<meta property="og:type" content="article">\n<meta property="og:url" content="{{::canonical}}" ng-if="::canonical">\n<meta property="og:title" content="{{::meta.title}}" ng-if="::meta.title">\n<meta property="og:description" content="{{::meta.abstract}}" ng-if="::meta.abstract">\n<meta property="og:image" content="{{::image}}" ng-if="::image">\n'),e.put("mobile_reader.html",'<div class="reader" read-mode="distraction-free-mobile">\n  <div class="content article-container">\n    <mobile-article class="viewer mobile-viewer" mobile-article-annotations></mobile-article>\n    <ng-include src="\'popover/annotations.html\'"></ng-include>\n  </div>\n  <mobile-toolbar></mobile-toolbar>\n  <mobile-slider ng-if="numPages > 2"></mobile-slider>\n  <ng-include src="\'sidenav/mobile_menu.html\'"></ng-include>\n  <ng-include src="\'sidenav/rcr.html\'"></ng-include>\n  <ng-include src="\'sidenav/supplements.html\'"></ng-include>\n  <ng-include src="\'sidenav/references.html\'"></ng-include>\n  <ng-include src="\'sidenav/mobile_annotations.html\'"></ng-include>\n  <ng-include src="\'sidenav/cited_by.html\'"></ng-include>\n  <ng-include src="\'sidenav/figures.html\'"></ng-include>\n  <ng-include src="\'sidenav/related.html\'"></ng-include>\n  <ng-include src="\'sidenav/mobile_share.html\'"></ng-include>\n  <ng-include src="\'sidenav/mobile_share_wiley.html\'"></ng-include>\n  <ng-include src="\'sidenav/leave_feedback.html\'"></ng-include>\n</div>\n'),e.put("print_notice.html",'<div class="centered-logo"></div>\n<span>To print this article, please use the print button in the bottom toolbar of the web reader.</span>\n'),e.put("reader.html",'<div class="reader" read-mode="distraction-free">\n\n  <div class="content article-container">\n    <article></article>\n    <article-tools></article-tools>\n  </div>\n\n  <ng-include src="\'sidenav/rcr.html\'"></ng-include>\n  <ng-include src="\'sidenav/supplements.html\'"></ng-include>\n  <ng-include src="\'sidenav/references.html\'"></ng-include>\n  <ng-include src="\'sidenav/annotations.html\'"></ng-include>\n  <ng-include src="\'sidenav/cited_by.html\'"></ng-include>\n  <ng-include src="\'sidenav/figures.html\'"></ng-include>\n  <ng-include src="\'sidenav/related.html\'"></ng-include>\n  <ng-include src="\'sidenav/appnav.html\'"></ng-include>\n  <ng-include src="\'sidenav/checkout.html\'"></ng-include>\n\n  <menu-bar></menu-bar>\n</div>\n\n<ng-include class="print-notice" src="\'print_notice.html\'"></ng-include>\n'),e.put("resolve.html",'<div class="reader resolve-reader article-container">\n  <viewer class="viewer hw-accel" post-selection></viewer>\n\n  <page-info></page-info>\n  <viewer-toolbar></viewer-toolbar>\n\n  <ng-include src="\'popover/resolve_selection.html\'"></ng-include>\n</div>'),e.put("supplement.html",'<div\n  class="reader supplement-reader"\n  ng-class="::{\'links-ready\': toolbarLinks}"\n  read-mode="distraction-free">\n\n  <div class="content article-container">\n    <viewer class="viewer hw-accel" article-annotations></viewer>\n    <page-info></page-info>\n    <viewer-toolbar></viewer-toolbar>\n    <ng-include src="\'popover/annotations.html\'"></ng-include>\n  </div>\n\n  <div class="header article-menu md-whiteframe-1dp"\n    ng-class="{contracted: contracted}" responsive>\n    <div class="left">\n      <div class="title">\n        <span class="caption">\n          {{::caption}}\n        </span>\n        <span class="type" ng-if="::article.get().type">\n          ({{::type}})\n        </span>\n      </div>\n    </div>\n    <div class="center">\n      <a\n        class="header-btn download"\n        ng-attr-target="{{::toolbarLinks.save.target}}"\n        ng-href="{{::toolbarLinks.save.href}}"\n        md-ink-ripple="#FFF">\n        <i class="material-icons">file_download</i>\n        <span>Download</span>\n        <md-tooltip ng-if="contracted" md-direction="bottom" md-autohide="true">\n          Download\n        </md-tooltip>\n      </a>\n      <div\n        ng-if="::details"\n        class="header-btn details"\n        md-ink-ripple="#FFF"\n        ng-click="toggleInfo()">\n        <i class="material-icons">chrome_reader_mode</i>\n        <span>Details</span>\n        <md-tooltip ng-if="contracted" md-direction="bottom" md-autohide="true">\n          Details\n        </md-tooltip>\n      </div>\n      <div\n        class="header-btn md-badge notes"\n        md-ink-ripple="#FFF"\n        ng-attr-data-badge="{{notes.length || undefined}}"\n        ng-click="toggleAnnots()">\n        <i class="material-icons">chat</i>\n        <span>Notes</span>\n        <md-tooltip ng-if="contracted" md-direction="bottom" md-autohide="true">\n          Notes <span ng-if="notes.length">({{notes.length}})</span>\n        </md-tooltip>\n      </div>\n    </div>\n    <div class="right publisher-logo"></div>\n  </div>\n\n  <ng-include src="\'sidenav/annotations.html\'"></ng-include>\n  <ng-include src="\'sidenav/supplement_info.html\'"></ng-include>\n</div>\n\n'),
e.put("video_player.html",'<div class="modal-backdrop"></div>\n<div class="video-overlay">\n  <div class="video-content" target-click="close()">\n    <video id="{{::videoId}}" class="video-js vjs-default-skin" controls>\n      <source ng-src="{{::video.url | trustUrl}}" type="video/mp4">\n    </video>\n  </div>\n  <div ng-if="::!mobile" class="header md-whiteframe-1dp">\n    <div class="left">\n      <i\n        class="material-icons header-btn icon-btn"\n        ng-click="close()"\n        md-ink-ripple="#FFF">\n        arrow_back\n      </i>\n    </div>\n    <div class="center">\n      <a\n        class="header-btn download"\n        ng-href="{{::video.download_url}}"\n        md-ink-ripple="#FFF">\n        <i class="material-icons">file_download</i>\n        <span>Download</span>\n      </a>\n    </div>\n  </div>\n  <div ng-if="::mobile" class="header md-whiteframe-1dp">\n    <div class="left">\n      <a\n        class="header-btn download"\n        ng-href="{{::video.download_url}}"\n        md-ink-ripple="#FFF">\n        <i class="material-icons">file_download</i>\n      </a>\n    </div>\n    <div class="center">\n      <span class="header-btn">{{::video.caption}}</span>\n    </div>\n    <div class="right">\n      <i\n        class="material-icons header-btn icon-btn"\n        ng-click="close()"\n        md-ink-ripple="#FFF">\n        close\n      </i>\n    </div>\n  </div>\n</div>\n'),e.put("ads/add_to_library.html",'<div class="add-to-library-ad">\n  <h2 class="md-title">\n    Add this Article to your ReadCube Cloud Library\n  </h2>\n  <ul class="features">\n    <li class="flex-row">\n      <i class="material-icons">cloud</i>\n      <div>\n        Access this article instantly from ReadCubes free\n        <a target="_blank" ng-href="{{::endpoint.app}}">Web Library</a>,\n        <a target="_blank" ng-href="{{::endpoint.web + \'/download\'}}">Desktop</a> and\n        <a target="_blank" ng-href="{{::endpoint.web + \'/download\'}}">Mobile</a> apps.\n      </div>\n    </li>\n    <li class="flex-row">\n      <i class="material-icons">important_devices</i>\n      <div>\n        Save annotations and notes. Plus enjoy Enhanced PDF features offline, including clickable inline citations and automatic supplements.\n      </div>\n    </li>\n    <li class="flex-row">\n      <i class="material-icons">insert_chart</i>\n      <div>Unlock article citation metrics.</div>\n    </li>\n  </ul>\n  <div class="actions">\n    <md-button\n      class="md-primary md-raised"\n      ng-click="closeRegisterAd()">\n      Add to Library\n    </md-button>\n  </div>\n</div>'),e.put("ads/my_library_register.html",'<div class="my-library-register-ad">\n  <h2 class="md-title">\n    Managing References and PDFs Has Never Been Easier\n  </h2>\n  <p>\n    Get your free ReadCube Cloud Library account and enjoy time-saving features including:\n  </p>\n  <ul class="features">\n    <li class="flex-row">\n      <i class="material-icons">cloud</i>\n      <div>\n        Sync your articles to the cloud, and access your papers, supplements and annotations from anywhere.\n      </div>\n    </li>\n    <li class="flex-row">\n      <i class="material-icons">important_devices</i>\n      <div>\n        Read smarter, by transforming your articles into Enhanced PDFs with clickable references and authors, advanced metrics and annotation tools.\n      </div>\n    </li>\n    <li class="flex-row">\n      <i class="material-icons">extension</i>\n      <div>\n        Stay on top of the latest literature with personalized paper recommendations, reading lists and our handy <a target="_blank" ng-href="{{::endpoint.chrome_extension}}">Chrome Extension</a>.\n      </div>\n    </li>\n  </ul>\n  <div class="actions">\n    <md-button\n      class="md-primary md-raised"\n      ng-click="closeRegisterAd()">\n      Get Started\n    </md-button>\n  </div>\n  <p class="existing-user">\n    Already registered? Click <a href ng-click="showLogin()">here</a> to sign in.\n  </p>\n</div>\n'),e.put("ads/my_library_success.html",'<div class="my-library-success-ad" ng-controller="MyLibrarySuccessCtrl">\n  <h2 class="md-title">\n    Thanks for registering!\n  </h2>\n  <p>\n    Visit your ReadCube web library to get started.\n  </p>\n  <md-checkbox\n    class="md-primary"\n    ng-model="savePaper"\n    aria-label="Save This Paper">\n    Save This Paper\n  </md-checkbox>\n  <div class="actions">\n    <a\n      class="md-button md-primary md-raised"\n      target="_blank"\n      ng-href="{{::endpoint.app}}"\n      ng-click="openLibrary()">\n      Take Me There\n    </a>\n  </div>\n</div>\n'),e.put("ads/sent_to_mobile.html",'<div class="sent-to-mobile">\n  <div class="cloud-sync-image"></div>\n  <h2>Synced in the cloud!</h2>\n  <div class="instructions">This article is now synced to your ReadCube library. Open the ReadCube Mobile app (iPhone, iPad, Android) to read this article.</div>\n  <div class="buttons">\n    <a target="_blank" class="appstore-button" ng-href="{{::endpoint.mobile_apps.ios}}"></a>\n    <a target="_blank" class="googleplay-button" ng-href="{{::endpoint.mobile_apps.android}}"></a>\n  </div>\n</div>'),e.put("citations/author.html",'<div class="author">\n  <h4 class="name">{{::text}}</h4>\n\n  <div class="affiliations" ng-if="::affiliations">\n    <div ng-repeat="af in ::affiliations">{{::af}}</div>\n  </div>\n\n  <div class="contact" ng-if="::email">\n    <i class="material-icons person">person</i>\n    <a\n      ng-attr-target="{{::email.indexOf(\'mailto:\') == 0 ? undefined : \'_blank\'}}"\n      ng-href="{{::email}}">\n      Contact {{::text}}\n    </a>\n  </div>\n\n  <div class="orcid" ng-if="::orcid_url">\n    <i class="logo"></i>\n    <a\n      target="_blank"\n      ng-href="{{::orcid_url}}">\n      View author on ORCID\n    </a>\n  </div>\n\n  <div class="search">\n    Search for author in:\n    <div class="links">\n      <span\n        ng-repeat="lnk in ::search"\n        ng-hide="::lnk.disabled">\n        <a ng-href="{{::lnk.url}}" target="_blank">{{::lnk.provider}}</a>\n        <span ng-if="!$last">  </span>\n      </span>\n    </div>\n  </div>\n</div>'),e.put("citations/figure.html",'<div class="figure">\n  <div class="view-figure">\n    <img class="thumb" ng-src="{{::figure.thumb}}"/>\n    <div class="launch">\n      <i class="material-icons">launch</i>\n      <span>View</span>\n    </div>\n  </div>\n  <span\n    class="caption"\n    ng-bind-html="::figure.caption | figureCaption">\n  </span>\n</div>\n'),e.put("citations/metrics.html",'<div class="articles">\n  <div\n    class="article reference"\n    ng-repeat="ref in metrics">\n    <h4 class="title" ng-if="::ref.title" ng-bind-html="::ref.title | linkify"></h4>\n    <div class="authors">{{::ref.authors.slice(0, 10) | authorShortName | join:\', \'}}</div>\n    <div class="links">\n      <a\n        target="_blank"\n        ng-if="::ref.url"\n        ng-click="trackLinkout(ref)"\n        ng-href="{{::ref.url}}">\n        Article\n      </a>\n    </div>\n    <div class="published">{{::ref | refPublishInfo}}</div>\n  </div>\n</div>\n'),e.put("citations/references.html",'<div class="articles">\n  <div\n    class="article"\n    ng-class="::{\'reference\': ref.badge, \'hide-badges\': hideBadges}"\n    ng-repeat="ref in ::references">\n    <div\n      ng-if="::ref.badge"\n      title="{{::ref.badge}}"\n      class="number">\n      {{::ref.badge}}\n    </div>\n    <h4 class="title" ng-if="::ref.title" ng-bind-html="::ref.title | linkify"></h4>\n    <div class="authors">{{::ref.authors.slice(0, 10) | join:\', \'}}</div>\n    <div class="links">\n      <a\n        target="_blank"\n        ng-if="::ref.find_article_url"\n        ng-click="trackLinkout(ref)"\n        ng-href="{{::ref.find_article_url}}">\n        Find Article\n      </a>\n      <span ng-if="::ref.find_article_url && ref.article_url"> | </span>\n      <a\n        target="_blank"\n        ng-if="::ref.article_url"\n        ng-click="trackLinkout(ref)"\n        ng-href="{{::ref.article_url}}">\n        Article\n      </a>\n    </div>\n    <div class="published">{{::ref | refPublishInfo}}</div>\n  </div>\n</div>\n'),e.put("error/404.html",'<h1>404</h1>\n<h4>Yikes! The page you requested could not be found.</h4>\n<p>\n  If you think this is an error, contact <a ng-href="{{::supportHref}}">support@readcube.com</a> for assistance.\n</p>\n'),e.put("error/500.html",'<h1>500</h1>\n<h4>Yikes! Something went wrong.</h4>\n<p>\n  Please try again later. If the problem persists,<br>\n  contact <a ng-href="{{::supportHref}}">support@readcube.com</a> for assistance.\n</p>\n<p class="edge-msg">\n  You may also find this support <a ng-href="{{::edgeSupportHref}}">article</a> helpful.\n</p>\n'),e.put("error/error.html",'<div class="error">\n  <canvas id="canvas" width="400" height="300"></canvas>\n  <div\n    class="error-content"\n    ng-class="{\'show-code\': showCode, \'show-message\': showMessage}">\n    <ui-view></ui-view>\n  </div>\n</div>\n'),e.put("error/processing.html",'<div class="processing">\n  <div class="processing-content">\n    <div class="logo pulse"></div>\n    <h2>Article processing...</h2>\n    <p>\n      We\'re still processing this PDF for the Enhanced Web Reader - it shouldn\'t take long so please keep this window open.\n    </p>\n    <p>This page will automatically reload in <em>{{refresh}}</em> seconds...</p>\n  </div>\n</div>\n'),e.put("dialogs/action_unavailable.html",'<md-dialog class="action-unavailable" aria-label="Action Unavailable">\n  <md-dialog-content class="md-dialog-content action-unavailable">\n    <h2 class="md-title">{{::titleAction}} Unavailable</h2>\n    <p class="md-body-1">\n      {{::msgAction}} the PDF outside of ReadCube requires the full PDF purchase option. Rental and Cloud articles can be viewed online and offline in the ReadCube Web, Desktop and Mobile apps but cannot be printed or saved outside of ReadCube.\n    </p>\n    <p class="md-caption" ng-if="::purchaseDate">\n      This article was purchased as a <b>{{::purchaseType}}</b> on <b>{{::purchaseDate | formatDate:\'YYYY/MM/DD\'}}</b>.\n    </p>\n  </md-dialog-content>\n  <md-dialog-actions class="md-actions">\n    <md-button ng-click="close()" class="md-primary md-raised">\n      GOT IT!\n    </md-button>\n  </md-dialog-actions>\n</md-dialog>\n'),e.put("dialogs/complimentary_access.html",'<md-dialog class="action-unavailable" aria-label="Action Unavailable">\n  <md-dialog-content class="md-dialog-content">\n    <h2 class="md-title">{{::titleAction}} Unavailable</h2>\n    <p class="md-body-1">\n      You are viewing a complimentary shared article.\n    </p>\n    <p class="md-body-1">\n      Complimentary shares do not allow {{::msgAction}}. If you have another access method, please visit the regular publisher article page in order to {{::titleAction}}.\n    </p>\n  </md-dialog-content>\n  <md-dialog-actions class="md-actions">\n    <md-button ng-if="::gotoPublisher" ng-click="gotoPublisher()" class="md-primary goto-publisher">\n      Go To Publisher Page\n    </md-button>\n    <md-button ng-if="::!gotoPublisher" ng-click="close()" class="md-primary goto-publisher">\n      Got it!\n    </md-button>\n  </md-dialog-actions>\n</md-dialog>\n'),e.put("dialogs/export.html",'<md-dialog class="export-dialog" aria-label="Export Citation">\n  <md-dialog-content class="md-dialog-content">\n    <h2 class="md-title">Export Citation</h2>\n    <p class="md-body-1">\n      To save this citation to your reference manager software, please select one of the formats below.\n    </p>\n    <md-radio-group ng-model="format">\n      <md-radio-button value="ris" class="md-primary">RIS</md-radio-button>\n      <md-radio-button value="endnote" class="md-primary">Endnote</md-radio-button>\n      <md-radio-button value="mendeley" class="md-primary">Mendeley</md-radio-button>\n      <md-radio-button value="papers" class="md-primary">Papers</md-radio-button>\n      <md-radio-button value="bibtex" class="md-primary">BibTeX</md-radio-button>\n    </md-radio-group>\n  </md-dialog-content>\n  <md-dialog-actions class="md-actions">\n    <md-button ng-click="export(format)" class="md-primary">Export</md-button>\n  </md-dialog-actions>\n</md-dialog>\n'),e.put("dialogs/import_annotations.html",'<md-dialog class="import-annotations-dialog" aria-label="Import Annotations">\n  <md-dialog-content class="md-dialog-content">\n    <h3 class="md-title">Shared Annotations</h3>\n    <p>This article was shared with annotations. Would you like to import the shared annotations to your existing annotations?</p>\n  </md-dialog-content>\n  <md-dialog-actions class="md-actions">\n    <md-button ng-click="close()">View my annotations</md-button>\n    <md-button ng-click="close(true)" class="md-primary md-raised">Import</md-button>\n  </md-dialog-actions>\n</md-dialog>\n'),e.put("dialogs/print_options.html",'<md-dialog class="print-options" aria-label="Print Options">\n  <md-dialog-content class="md-dialog-content">\n    <div class="options" ng-show="!synced">\n      <h2 class="md-headline">article print options</h2>\n      <div\n        ng-click="printPdf()"\n        class="row print-pdf"\n        md-ink-ripple=\'#FFF\'>\n        <i class="material-icons option-icon">print</i>\n        <div class="text">Print High Resolution PDF</div>\n      </div>\n      <div\n        ng-click="sendToMobile()"\n        class="row send-to-tablet"\n        md-ink-ripple=\'#FFF\'>\n        <i class="material-icons option-icon">tablet_mac</i>\n        <div class="text">\n          <span>Send to ReadCube Mobile</span>\n          <div class="fineprint">Read the Enhanced PDF on a mobile device (iPhone, iPad, Android)</div>\n        </div>\n      </div>\n      <div\n        ng-click="cloudPrint()"\n        class="row google-cloud-print"\n        md-ink-ripple=\'#FFF\'>\n        <div class="g-logo option-icon"></div>\n        <div class="text">Google Cloud Print</div>\n      </div>\n    </div>\n    <ng-include src="\'ads/sent_to_mobile.html\'" ng-show="synced"></ng-include>\n  </md-dialog-content>\n</md-dialog>\n'),e.put("dialogs/share.html",'<md-dialog class="share-dialog" aria-label="Share">\n  <md-dialog-content class="md-dialog-content">\n    <i class="material-icons share">share</i>\n    <div class="md-subhead">SHAREABLE URL</div>\n    <h2 class="md-title">Anyone with this URL can read the full text of this article</h2>\n    <div class="link-container" ng-class="{busy: busy}">\n      <div class="link">\n        <i class="material-icons">link</i>\n      </div>\n      <input\n        type="text"\n        readonly="readonly"\n        ng-model="shareLink"\n        ng-mousedown="select($event)">\n    </div>\n    <div>\n      <md-switch class="md-block" ng-model="includeAnnotations">\n        Include Annotations\n      </md-switch>\n    </div>\n  </md-dialog-content>\n</md-dialog>\n'),e.put("dialogs/share_wiley.html",'<md-dialog class="share-dialog" aria-label="Share">\n  <md-dialog-content class="md-dialog-content">\n    <i class="material-icons share">share</i>\n    <h1>Share</h1>\n    <p>Please review our <a target="_blank" href="http://onlinelibrary.wiley.com/termsAndConditions">Terms and Conditions of Use</a> and check box below to share full-text version of article.</p>\n    <md-checkbox\n      class="md-primary"\n      ng-model="acceptTerms"\n      ng-click="generateLink()"\n      aria-label="Terms and Conditions of Use">\n      I have read and accept the Wiley Online Library Terms and Conditions of Use.\n    </md-checkbox>\n    <h4 class="link-title">Shareable Link</h4>\n    <p class="link-description">Use the link below to share a full-text version of this article with your friends and colleagues. <a target="_blank" href="http://www.wiley.com/WileyCDA/Section/id-829333.html">Learn more.</a></p>\n    <div class="link-container" ng-class="{busy: busy}">\n      <div class="link">\n        <i class="material-icons">link</i>\n      </div>\n      <input\n        id="share-link"\n        type="text"\n        readonly="readonly"\n        ng-model="shareLink"\n        ng-disabled="!acceptTerms"\n        ng-mousedown="select($event)">\n    </div>\n    <md-button\n      class="md-raised copy-shared-url"\n      data-clipboard-target="#share-link"\n      ng-disabled="!acceptTerms || !shareLink || busy"\n      clipboard>\n      Copy URL\n    </md-button>\n  </md-dialog-content>\n</md-dialog>\n'),e.put("dialogs/user.html",'<md-dialog\n  class="user-dialog"\n  ng-class="{\'register-ad\': registerAd, \'success-ad\': successAd}"\n  aria-label="Login or Register">\n  <md-dialog-content class="md-dialog-content">\n    <pre-login\n      ng-if="registerAd"\n      ng-include="registerAd">\n    </pre-login>\n    <login ng-class="{loaded: loaded}">\n      <iframe\n        class="modal login"\n        ng-src="{{::src | trustUrl}}"\n        onmousewheel=""\n        allowtransparency="true"\n        seamless="seamless">\n      </iframe>\n      <spinner></spinner>\n    </login>\n    <post-login\n      ng-if="successAd"\n      ng-include="successAd">\n    </post-login>\n  </md-dialog-content>\n</md-dialog>\n'),e.put("info_bar/shared_access_wiley.html",'<div class="info-bar md-whiteframe-1dp">\n  <span>Limited access to this article is provided by the Wiley Content Sharing initiative.</span>\n  <a class="md-button" target="_blank" href="http://www.wiley.com/WileyCDA/Section/id-829333.html">Learn more</a>\n</div>'),e.put("info_bar/shared_paywall_wiley.html",'<div class="info-bar dark md-whiteframe-1dp">\n  <span>The Wiley Content Sharing link that you used to access this page is no longer valid.</span>\n  <a class="md-button" target="_blank" href="http://www.wiley.com/WileyCDA/Section/id-829333.html">Learn more</a>\n</div>\n'),e.put("sidenav/annotations.html",'<annotations class="md-whiteframe-z2">\n  <h3>Notes</h3>\n  <div class="blue-divider"></div>\n\n  <div ng-if="!annots.length">\n    <h4>You have no notes.</h4>\n    <div class="tip">\n      Tip: To annotate, select any text in the article to get the annotation menu. You can add highlights and comments, which will be listed here in this panel.\n    </div>\n  </div>\n\n  <div ng-if="annots.length">\n    <div class="sort-options layout-row">\n      <md-input-container class="sort-order">\n        <label>Order by:</label>\n        <md-select ng-model="sortPredicate">\n          <md-option ng-value="key" ng-repeat="(key, val) in predicates">{{key}}</md-option>\n        </md-select>\n      </md-input-container>\n      <md-input-container class="sort-direction">\n        <label>Direction:</label>\n        <md-select ng-model="sortDirection">\n          <md-option ng-value="key" ng-repeat="(key, val) in directions">{{key}}</md-option>\n        </md-select>\n      </md-input-container>\n    </div>\n    <div\n      class="note-item"\n      ng-click="scrollTo(annot)"\n      ng-repeat="annot in annots | orderBy:predicates[sortPredicate]:directions[sortDirection]">\n      <div ng-if="sortPredicate == \'created\'" class="note-time-date">\n        <span>{{annotationCreated(annot) | calendarDate}}</span>\n      </div>\n      <div ng-if="sortPredicate != \'created\'" class="note-time-date">\n        <span>{{annotationModified(annot) | calendarDate}}</span>\n      </div>\n      <i class="material-icons delete" ng-click="delete($event, annot)">delete</i>\n      <div class="note-highlight" ng-class="\'color-\' + annot.color_id">{{annot.text | breaksToSpaces}}</div>\n      <div class="note-text" ng-if="annot.note">{{annot.note}}</div>\n    </div>\n  </div>\n\n  <md-button ng-if="annots.length" class="md-icon-button download grey" ng-click="downloadAnnots()">\n    <i class="material-icons">file_download</i>\n    <md-tooltip md-direction="bottom" md-autohide="true">\n      Download as CSV\n    </md-tooltip>\n  </md-button>\n  <md-button class="md-icon-button close grey" ng-click="toggleAnnots()">\n    <i class="material-icons">close</i>\n  </md-button>\n</annotations>\n'),e.put("sidenav/appnav.html",'<md-sidenav\n  class="md-sidenav-left"\n  md-component-id="appnav">\n  <appnav ng-class="{loaded: loaded}">\n    <div class="rc-menu">\n      <div class="rc-logo"></div>\n      <span class="rc-text">readcube</span>\n    </div>\n    <iframe\n      class="appnav-frame"\n      allowTransparency="true"\n      seamless="seamless">\n    </iframe>\n    <spinner></spinner>\n    <logout class="md-whiteframe-2dp">\n      <md-menu-item ng-if="user.signedIn()">\n        <md-button class="account-button" ng-click="accountPage()">\n          <md-icon class="material-icons">account_circle</md-icon>\n          <span>{{user.get().full_name}}</span>\n        </md-button>\n      </md-menu-item>\n      <md-menu-item ng-if="user.signedIn()">\n        <md-button ng-click="onLogOut()">\n          <md-icon class="material-icons">exit_to_app</md-icon>\n          <span>Sign Out</span>\n        </md-button>\n      </md-menu-item>\n    </logout>\n  </appnav>\n</md-sidenav>\n'),e.put("sidenav/checkout.html",'<checkout\n  class="md-whiteframe-z2"\n  ng-class="{loaded: loaded}">\n  <iframe\n    class="checkout-frame"\n    onmousewheel=""\n    allowTransparency="true"\n    seamless="seamless">\n  </iframe>\n  <spinner></spinner>\n</checkout>\n'),e.put("sidenav/cited_by.html",'<md-sidenav\n  hammer-sidenav="right"\n  class="md-sidenav-right md-whiteframe-z2 references metrics"\n  md-component-id="cited-by">\n  <div class="sidenav-title md-whiteframe-2dp">\n    <span>Cited By</span>\n    <md-button class="md-icon-button close white" ng-click="closeSidenav(\'cited-by\')">\n      <i class="material-icons">chevron_right</i>\n    </md-button>\n  </div>\n  <cited-by\n    class="sidenav-content"\n    ng-class="{busy: !metrics.results}"\n    infinite-scroll\n    load-more="scrollMetrics()"\n    treshold-percent="80">\n    <div ng-if="metrics.results.length" metrics="metrics.results", tracking-source="citing_article"></div>\n    <div ng-if="!metrics.finished && metrics.results.length" class="loading-more">\n      <div class="loader-inner ball-pulse">\n        <div></div>\n        <div></div>\n        <div></div>\n      </div>\n    </div>\n    <div ng-if="!metrics.results.length" class="no-results">\n      No citing articles found.\n    </div>\n    <spinner></spinner>\n  </cited-by>\n</md-sidenav>\n'),e.put("sidenav/figures.html",'<md-sidenav\n  hammer-sidenav="right"\n  class="md-sidenav-right md-whiteframe-z2 figures"\n  md-component-id="figures">\n  <div class="sidenav-title md-whiteframe-2dp">\n    <span>Figures</span>\n    <md-button class="md-icon-button close white" ng-click="closeSidenav(\'figures\')">\n      <i class="material-icons">chevron_right</i>\n    </md-button>\n  </div>\n  <div class="sidenav-content">\n    <div\n      ng-repeat="figure in ::figures"\n      figure="figure"\n      index="$index"\n      inlist="true">\n    </div>\n  </div>\n</md-sidenav>\n'),e.put("sidenav/leave_feedback.html",'<md-sidenav\n  hammer-sidenav="right"\n  class="md-sidenav-right md-whiteframe-z2 leave-feedback"\n  md-component-id="leave-feedback">\n  <div class="sidenav-title md-whiteframe-2dp">\n    <span>Leave feedback</span>\n    <md-button class="md-icon-button close white" ng-click="closeSidenav(\'leave-feedback\')">\n      <i class="material-icons">chevron_right</i>\n    </md-button>\n  </div>\n  <div class="sidenav-content" ng-controller="LeaveFeedbackCtrl">\n    <h4>How likely is it that you would recommend the mobile web reader to a friend or colleague?</h4>\n    <md-input-container>\n      <md-select ng-model="score" placeholder="Select a value of 0 to 10">\n        <md-option value="10">10&nbsp&nbsp(most likely)</md-option>\n        <md-option value="9">9</md-option>\n        <md-option value="8">8</md-option>\n        <md-option value="7">7</md-option>\n        <md-option value="6">6</md-option>\n        <md-option value="5">5</md-option>\n        <md-option value="4">4</md-option>\n        <md-option value="3">3</md-option>\n        <md-option value="2">2</md-option>\n        <md-option value="1">1</md-option>\n        <md-option value="0">0&nbsp&nbsp(least likely)</md-option>\n      </md-select>\n    </md-input-container>\n    <div class="actions">\n      <md-button class="md-raised" ng-disabled="disabled()" ng-click="submit()">Submit</md-button>\n    </div>\n  </div>\n</md-sidenav>\n'),e.put("sidenav/mobile_annotations.html",'<md-sidenav\n  hammer-sidenav="right"\n  class="md-sidenav-right md-whiteframe-z2 annotations"\n  md-component-id="annotations">\n  <div class="sidenav-title md-whiteframe-2dp">\n    <span>Notes</span>\n    <md-button class="md-icon-button close white" ng-click="closeSidenav(\'annotations\')">\n      <i class="material-icons">chevron_right</i>\n    </md-button>\n  </div>\n  <div class="sidenav-content">\n    <mobile-annotations>\n      <div class="sort-options layout-row">\n        <md-input-container class="sort-order">\n          <label>Order by:</label>\n          <md-select ng-model="sortPredicate">\n            <md-option ng-value="key" ng-repeat="(key, val) in predicates">{{key}}</md-option>\n          </md-select>\n        </md-input-container>\n        <md-input-container class="sort-direction">\n          <label>Direction:</label>\n          <md-select ng-model="sortDirection">\n            <md-option ng-value="key" ng-repeat="(key, val) in directions">{{key}}</md-option>\n          </md-select>\n        </md-input-container>\n      </div>\n      <div\n        class="note-item"\n        ng-click="scrollTo(annot)"\n        ng-repeat="annot in annots | orderBy:predicates[sortPredicate]:directions[sortDirection]">\n        <div ng-if="sortPredicate == \'created\'" class="note-time-date">\n          {{annotationCreated(annot) | calendarDate}}\n        </div>\n        <div ng-if="sortPredicate != \'created\'" class="note-time-date">\n          {{annotationModified(annot) | calendarDate}}\n        </div>\n        <div class="note-highlight" ng-class="\'color-\' + annot.color_id">{{annot.text | breaksToSpaces}}</div>\n        <div class="note-text" ng-if="annot.note">{{annot.note}}</div>\n      </div>\n    </div>\n  </mobile-annotations>\n</md-sidenav>\n'),e.put("sidenav/mobile_menu.html",'<md-sidenav\n  hammer-sidenav="right"\n  class="md-sidenav-right scroll-and-swipe"\n  md-component-id="mobile_menu">\n  <div class="publisher-logo"></div>\n  <md-menu-content width="4">\n    <md-menu-divider></md-menu-divider>\n    <md-menu-item>\n      <md-button ng-click="toggleInLibrary($event)">\n        <div ng-if="syncing" class="spinner-container"><spinner></spinner></div>\n        <md-icon ng-if="!syncing" class="material-icons">{{inLibrary ? \'cloud_off\' : \'cloud_upload\'}}</md-icon>\n        <span>{{inLibrary ? \'Remove from Library\' : \'Add to Library\'}}</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="::article.get().doi && article.get().meta.url">\n      <md-button ng-click="gotoPublisher()">\n        <md-icon class="material-icons">web</md-icon>\n        <span>{{publisherPageLabel || \'Go to article page\'}}</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="::sharingEnabled()">\n      <md-button ng-click="share()">\n        <md-icon class="material-icons">share</md-icon>\n        <span>Share</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="notesEnabled()">\n      <md-button ng-click="openAnnots()">\n        <md-icon class="material-icons">chat</md-icon>\n        <span class="md-badge" data-badge="{{notes.length}}">Notes</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="::references.length">\n      <md-button ng-click="openReferences()">\n        <md-icon class="material-icons">list</md-icon>\n        <span class="md-badge" data-badge="{{::references.length}}">References</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="::figures.length">\n      <md-button ng-click="openFigures()">\n        <md-icon class="material-icons">photo_library</md-icon>\n        <span class="md-badge" data-badge="{{::figures.length}}">Figures</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="::metadata">\n      <md-button ng-click="openRelated()">\n        <md-icon class="material-icons">layers</md-icon>\n        <span>Related articles</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="::article.get().doi && metadata.citations_count">\n      <md-button ng-click="openMetrics()">\n        <md-icon class="material-icons">link</md-icon>\n        <span class="md-badge" ng-attr-data-badge="{{::metadata.citations_count | kilo}}">Cited by</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="::supplements.length">\n      <md-button ng-click="openSupplements()">\n        <md-icon class="material-icons">library_add</md-icon>\n        <span class="md-badge" data-badge="{{::supplements.length}}">Supplements</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="::article.get().doi && metadata.rcr">\n      <md-button ng-click="openRCR()">\n        <md-icon class="material-icons">assessment</md-icon>\n        <span>RCR: {{::(+metadata.rcr).toFixed(2)}}</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="::altmetric.score">\n      <md-button ng-click="openAltmetric()">\n        <div class="altmetric-embed">\n          <img ng-src="{{::altmetric.images.medium}}" width="26px" height="26px">\n        </div>\n        <span>Altmetric</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="user.signedIn()">\n      <md-button class="account-button" ng-click="accountPage($event)">\n        <md-icon class="material-icons">account_circle</md-icon>\n        <span>{{user.get().full_name}}</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="user.signedIn()">\n      <md-button ng-click="signOut()">\n        <md-icon class="material-icons">exit_to_app</md-icon>\n        <span>Sign Out</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="!user.signedIn()">\n      <md-button ng-click="signIn($event)">\n        <div class="rc-logo"></div>\n        <span>Sign In</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item ng-if="!$root.mobileFeedback">\n      <md-button ng-click="leaveFeedback()">\n        <md-icon class="material-icons">star_half</md-icon>\n        <span>Leave feedback</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-item>\n      <md-button ng-click="contactSupport()">\n        <md-icon class="material-icons">help</md-icon>\n        <span>Contact support</span>\n      </md-button>\n    </md-menu-item>\n    <md-menu-divider></md-menu-divider>\n  </md-menu-content>\n</md-sidenav>\n'),e.put("sidenav/mobile_share.html",'<md-sidenav\n  hammer-sidenav="right"\n  class="md-sidenav-right md-whiteframe-z2 share"\n  md-component-id="share">\n  <div class="sidenav-title md-whiteframe-2dp">\n    <span>Share</span>\n    <md-button class="md-icon-button close white" ng-click="closeSidenav(\'share\')">\n      <i class="material-icons">chevron_right</i>\n    </md-button>\n  </div>\n  <div class="sidenav-content share-content" ng-controller="ShareCtrl">\n    <i class="material-icons share">share</i>\n    <div class="md-subhead">SHAREABLE URL</div>\n    <h2 class="md-title">Anyone with this URL can read the full text of this article</h2>\n    <div class="link-container" ng-class="{busy: busy}">\n      <div class="link">\n        <i class="material-icons">link</i>\n      </div>\n      <input\n        id="share-link"\n        type="text"\n        readonly="readonly"\n        ng-model="shareLink"\n        ng-mousedown="select($event)">\n    </div>\n    <md-button\n      class="md-raised copy-shared-url"\n      data-clipboard-target="#share-link"\n      ng-disabled="!shareLink || busy"\n      clipboard>\n      Copy URL\n    </md-button>\n    <div>\n      <md-switch class="md-block" ng-model="includeAnnotations">\n        Include Annotations\n      </md-switch>\n    </div>\n  </div>\n</md-sidenav>\n'),
e.put("sidenav/mobile_share_wiley.html",'<md-sidenav\n  hammer-sidenav="right"\n  class="md-sidenav-right md-whiteframe-z2 share share-wiley"\n  md-component-id="share-wiley">\n  <div class="sidenav-title md-whiteframe-2dp">\n    <span>Share</span>\n    <md-button class="md-icon-button close white" ng-click="closeSidenav(\'share-wiley\')">\n      <i class="material-icons">chevron_right</i>\n    </md-button>\n  </div>\n  <div class="sidenav-content share-content" ng-controller="ShareWileyCtrl">\n    <i class="material-icons share">share</i>\n    <h1>Share</h1>\n    <p>Please review our <a target="_blank" href="http://onlinelibrary.wiley.com/termsAndConditions">Terms and Conditions of Use</a> and check box below to share full-text version of article.</p>\n    <md-checkbox\n      class="md-primary"\n      ng-model="acceptTerms"\n      ng-click="generateLink()"\n      aria-label="Terms and Conditions of Use">\n      I have read and accept the Wiley Online Library Terms and Conditions of Use.\n    </md-checkbox>\n    <p>Use the link below to share a full-text version of this article with your friends and colleagues. <a target="_blank" href="http://www.wiley.com/WileyCDA/Section/id-829333.html">Learn more.</a></p>\n    <label class="link-label">Shareable Link</label>\n    <div class="link-container" ng-class="{busy: busy}">\n      <div class="link">\n        <i class="material-icons">link</i>\n      </div>\n      <input\n        id="share-link-wiley"\n        type="text"\n        readonly="readonly"\n        ng-model="shareLink"\n        ng-disabled="!acceptTerms"\n        ng-mousedown="select($event)">\n    </div>\n    <md-button\n      class="md-raised copy-shared-url"\n      data-clipboard-target="#share-link-wiley"\n      ng-disabled="!acceptTerms || !shareLink || busy"\n      clipboard>\n      Copy URL\n    </md-button>\n  </div>\n</md-sidenav>\n'),e.put("sidenav/mobile_user.html",'<md-sidenav\n  id="user-sidenav"\n  md-component-id="user"\n  class="md-sidenav-right user-sidenav"\n  ng-class="{\'register-ad\': registerAd}">\n  <div class="sidenav-title md-whiteframe-2dp">\n    <span>{{::title}}</span>\n    <md-button class="md-icon-button close white" ng-click="close()">\n      <i class="material-icons">chevron_right</i>\n    </md-button>\n  </div>\n  <div class="sidenav-content">\n    <pre-login\n      ng-if="registerAd"\n      ng-include="registerAd">\n    </pre-login>\n    <login ng-class="{loaded: loaded}">\n      <div class="frame-container">\n        <iframe\n          class="modal login"\n          ng-src="{{::src | trustUrl}}"\n          allowtransparency="true"\n          seamless="seamless">\n        </iframe>\n      </div>\n      <spinner></spinner>\n    </login>\n  </div>\n</md-sidenav>\n'),e.put("sidenav/rcr.html",'<md-sidenav\n  hammer-sidenav="right"\n  class="md-sidenav-right md-whiteframe-z2 rcr"\n  md-component-id="rcr">\n  <div class="sidenav-title md-whiteframe-2dp">\n    <span>Relative Citation Ratio</span>\n    <md-button class="md-icon-button close white" ng-click="closeSidenav(\'rcr\')">\n      <i class="material-icons">chevron_right</i>\n    </md-button>\n  </div>\n  <div class="sidenav-content">\n    <h1>RCR: <span>{{(+metadata.rcr).toFixed(2)}}</span></h1>\n    <p>The <a target="_blank" href="http://biorxiv.org/content/early/2015/10/22/029629">Relative Citation Ratio</a> (RCR) is a new citation-based measure of article influence, developed by the <a target="_blank" href="https://dpcpsi.nih.gov/opa/index">Office for Portfolio Analysis</a> (OPA) at the National Institutes of Health in the USA. It was designed to address some of the shortcomings of more standard citation number and Journal Impact Factor (JIF) measures. It does this by normalizing an articles citation number to both time since publication and the field in which it was published, as using citation number alone (see Times cited) does not account for them.</p>\n    <p>Some areas of research experience higher average levels of citation than others, leading to a citation count of 8 being regarded as high in some fields, but low in others. Along the same lines, a new paper may represent a significant scientific breakthrough, but it will have a low citation count if published recently. By taking into account time and field, the RCR attempts to produce an improved indication of impact and reception. For more information on these, and other RCR improvements, you are encouraged to click on the <a target="_blank" href="http://biorxiv.org/content/early/2015/10/22/029629">RCR</a> and <a target="_blank" href="https://dpcpsi.nih.gov/opa/index">OPA</a> links in this description.</p>\n    <p>NOTE: Not all publications have an RCR score, and this may be for several reasons. For example, if a paper is less than two years old, or older than 1980, it is unlikely to have an RCR score due to the lack of robust citation information in short periods and before 1980. Other criteria that the OPA have for inclusion or exclusion of papers are based on relative timing of citations for papers and qualifying journals contributing to the score.</p>\n  </div>\n</md-sidenav>\n'),e.put("sidenav/references.html",'<md-sidenav\n  hammer-sidenav="right"\n  class="md-sidenav-right md-whiteframe-z2 references"\n  md-component-id="references">\n  <div class="sidenav-title md-whiteframe-2dp">\n    <span>References</span>\n    <md-button class="md-icon-button close white" ng-click="closeSidenav(\'references\')">\n      <i class="material-icons">chevron_right</i>\n    </md-button>\n  </div>\n  <div class="sidenav-content">\n    <div ng-if="::references.length" class="articles">\n      <reference-list refs="::references" tracking-source="reference"></reference-list>\n    </div>\n  </div>\n</md-sidenav>\n'),e.put("sidenav/related.html",'<md-sidenav\n  hammer-sidenav="right"\n  class="md-sidenav-right md-whiteframe-z2 related"\n  md-component-id="related">\n  <div class="sidenav-title md-whiteframe-2dp">\n    <span>Related Articles</span>\n    <md-button class="md-icon-button close white" ng-click="closeSidenav(\'related\')">\n      <i class="material-icons">chevron_right</i>\n    </md-button>\n  </div>\n  <div class="sidenav-content" ng-class="{busy: !related}">\n    <div ng-if="related.length" references="related" tracking-source="related_article"></div>\n    <div ng-if="!related.length" class="no-results">\n      No related articles found.\n    </div>\n    <spinner></spinner>\n  </div>\n</md-sidenav>\n'),e.put("sidenav/supplement_info.html",'<supplement-info class="md-whiteframe-z2">\n  <div class="container" ng-if="::supplement">\n    <h3>Details</h3>\n    <md-button class="md-icon-button close grey" ng-click="toggleInfo()">\n      <i class="material-icons">close</i>\n    </md-button>\n    <div class="blue-divider"></div>\n    <h4>{{::supplement.caption}} ({{::supplement.type.toUpperCase()}})</h4>\n    <div class="description" ng-if="::supplement.description">\n      {{::supplement.description}}\n    </div class="description">\n  </div>\n</supplement-info>\n'),e.put("sidenav/supplements.html",'<md-sidenav\n  hammer-sidenav="right"\n  class="md-sidenav-right md-whiteframe-z2 supplements"\n  md-component-id="supplements">\n  <div ng-controller="SupplementsCtrl">\n    <div class="sidenav-title md-whiteframe-2dp">\n      <span>Supporting Information</span>\n      <md-button class="md-icon-button close white" ng-click="closeSidenav(\'supplements\')">\n        <i class="material-icons">chevron_right</i>\n      </md-button>\n    </div>\n    <div class="sidenav-content">\n      <a\n        ng-repeat="sup in ::supplements"\n        target="_blank"\n        ng-class="[\'supplement\', sup.type]"\n        ng-href="{{::sup.url}}"\n        ng-click="viewSupplement($event, sup)">\n        <div class="thumb" bg-image="{{::sup.thumb[0]}}">\n          <i ng-if="::sup.type == \'video\'" class="material-icons play-icon">play_circle_outline</i>\n        </div>\n        <span class="caption" title="{{::sup.description | clipTitle}}">\n          <b>{{::sup.caption}}<span> ({{::sup.type.toUpperCase()}})</span></b>\n          <span ng-if="::sup.description"><b> | </b>{{::sup.description}}</span>\n        </span>\n      </a>\n    </div>\n  </div>\n</md-sidenav>\n'),e.put("intro_tips/annotations.html",'<div class="intro-tip" aria-label="Intro Tooltip">\n  <h3 class="md-title">Annotations and Notes</h3>\n  <p>Select text to bring up the annotations options - you can highlight and write notes. Any annotations you make are organized and accessible in the side toolbar (bottom right button).</p>\n  <div class="md-actions">\n    <md-button ng-click="close(\'disable_tips\')" class="left">Disable Tips</md-button>\n    <md-button ng-click="close()" class="md-primary md-raised right">Got It!</md-button>\n  </div>\n</div>\n'),e.put("intro_tips/article_tools.html",'<div class="intro-tip" aria-label="Intro Tooltip">\n  <h3 class="md-title">Additional Article Tools</h3>\n  <p>Hover over this button to get additional tools, including related articles, your annotations list, citation file export and figures browser.</p>\n  <div class="md-actions">\n    <md-button ng-click="close(\'disable_tips\')" class="left">Disable Tips</md-button>\n    <md-button ng-click="close()" class="md-primary md-raised right">Got It!</md-button>\n  </div>\n</div>\n'),e.put("intro_tips/inline_citations.html",'<div class="intro-tip" aria-label="Intro Tooltip">\n  <h3 class="md-title">Clickable Citations and Authors</h3>\n  <p>Inline references and author names are interactive and can be hovered or clicked - quickly find cited articles and other publications by the authors.</p>\n  <div class="md-actions">\n    <md-button ng-click="close(\'disable_tips\')" class="left">Disable Tips</md-button>\n    <md-button ng-click="close()" class="md-primary md-raised right">Got It!</md-button>\n  </div>\n</div>\n'),e.put("intro_tips/my_library.html",'<div class="intro-tip" aria-label="Intro Tooltip">\n  <h3 class="md-title">Cloud Reference Library</h3>\n  <p ng-if="!signedIn">\n    With a <strong>free ReadCube account</strong>, store articles and manage your reference library from any web browser.\n  </p>\n  <p ng-if="signedIn">\n    With your existing ReadCube account, store articles and manage your reference library from any web browser.\n  </p>\n  <div class="md-actions">\n    <md-button ng-click="close(\'disable_tips\')" class="left">Disable Tips</md-button>\n    <md-button ng-if="!signedIn" ng-click="close(\'sign_up\')" class="md-primary md-raised right">Sign Up</md-button>\n    <md-button ng-if="signedIn" ng-click="close(\'view_library\')" class="md-primary md-raised right">View Library</md-button>\n  </div>\n</div>\n'),e.put("intro_tips/pulse.html",'<div class="loader-inner ball-scale-multiple">\n  <div></div>\n  <div></div>\n  <div></div>\n</div>\n'),e.put("popover/annotations.html",'<div style="display:none;">\n  <div id="annotations-base-toolbar" class="base-toolbar">\n    <div class="row annot-colors unselectable">\n      <div class="sample color-1" data-colorid="1"></div>\n      <div class="sample color-2" data-colorid="2"></div>\n      <div class="sample color-3" data-colorid="3"></div>\n      <div class="sample color-4" data-colorid="4"></div>\n    </div>\n    <div class="row add-note unselectable">\n      <i class="material-icons">comment</i>\n      <span>Add Note</span>\n    </div>\n    <div class="row edit-note">\n    <textarea placeholder="Type note text here."></textarea>\n    </div>\n    <div class="row delete unselectable">\n      <i class="material-icons">delete</i>\n      <span>Delete</span>\n    </div>\n  </div>\n</div>\n'),e.put("popover/resolve_selection.html",'<div style="display:none;">\n  <div id="resolve-toolbar" class="base-toolbar">\n    <div class="row unselectable" ng-repeat="t in ::types" ng-attr-type="{{::t}}">{{::t}}</div>\n  </div>\n</div>\n'),e.put("toast/access_forbidden.html",'<md-toast>\n  <div class="flex-row">\n    <i class="material-icons">update</i>\n    <span class="message">\n      Your session has expired, please reload the page to regain access to the article.\n    </span>\n    <md-button class="open" ng-click="reload()">\n      Reload\n    </md-button>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/annots_not_synced.html",'<md-toast class="annots-not-synced">\n  <div class="flex-row">\n    <i class="material-icons">cloud_off</i>\n    <span class="message">\n      Annotations not saved. To save annotations, please add this article to your Library.\n    </span>\n    <md-button class="add-to-library" ng-click="addToLibrary($event)">\n      Add to Library\n    </md-button>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/auth_failed.html",'<md-toast class="auth-failed">\n  <div class="flex-row">\n    <i class="material-icons">lock</i>\n    <span class="message">\n      We are unable to authorize full PDF access to this article at this time. Click <a target="_blank" ng-href="{{::articleUrl}}">here</a> to access it on the publishers site.\n    </span>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>\n'),e.put("toast/info_message.html",'<md-toast>\n  <div class="flex-row">\n    <i class="material-icons">info</i>\n    <span class="message">\n      {{message}}\n    </span>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/prompt_register.html",'<md-toast class="register-prompt">\n  <div class="flex-row">\n    <i class="material-icons">person</i>\n    <span class="message">\n      Please <a class="login" ng-click="login()">sign in</a> or create a free ReadCube account to view citation data.\n    </span>\n    <md-button class="register" ng-click="register()">\n      Register\n    </md-button>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>\n'),e.put("toast/read_personal.html",'<md-toast class="read-personal">\n  <div class="flex-row">\n    <i class="material-icons">cloud</i>\n    <span class="message">\n      You have this article in your ReadCube library. Open that version to get full-text access.\n    </span>\n    <md-button class="open" ng-click="openPersonal()">\n      Open\n    </md-button>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/rental_expiry.html",'<md-toast class="rental-expiry">\n  <div class="flex-row">\n    <i class="material-icons">timelapse</i>\n    <span class="message expires-in" ng-if="expiresIn">\n      Rental expires in<br>\n      <span class="duration">{{expiresIn | rentalDuration}}</span>\n    </span>\n    <span class="message expired-on" ng-if="::expiredOn">\n      Rental expired on <span class="time">{{::expiredOn | formatDate:\'dddd, MMMM Do YYYY, h:mm a\'}}</span>\n    </span>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>\n'),e.put("toast/shared_access.html",'<md-toast class="shared-access">\n  <div class="flex-row">\n    <i class="material-icons share">share</i>\n    <span class="message">\n      {{::message}}<br>\n      <a class="back-to-publisher" ng-if="::gotoPublisher" ng-click="gotoPublisher()">\n        Back to {{::publisherName}}\n      </a>\n      <a class="whats-this" target="_blank" ng-if="::whatsThisLink" ng-href="{{::whatsThisLink}}">\n        What\'s this?\n      </a>\n    </span>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/shared_access_wiley.html",'<md-toast class="shared-access shared-access-wiley">\n  <div class="flex-row">\n    <i class="material-icons share">share</i>\n    <span class="message">\n      {{::message}}<br>\n      <a target="_blank" class="learn-more" ng-href="{{::learnMoreLink}}">\n        Learn More\n      </a>\n      <a class="get-access" ng-if="::type == \'access\'" ng-click="getAccess()">\n        Get Access\n      </a>\n    </span>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/synced_ad.html",'<md-toast class="synced-ad">\n  <div class="title">This article has been added to your library.</div>\n  <p>Try ReadCube\'s free apps to access the Enhanced PDF anytime:</p>\n  <a target="_blank" class="md-button desktop-app" ng-href="{{::endpoint.web + \'/download\'}}">\n    <i class="material-icons">desktop_mac</i>\n    <span class="message">\n      ReadCube Desktop (Win/Mac)\n    </span>\n  </a>\n  <a target="_blank" class="md-button ios-app" ng-href="{{::endpoint.mobile_apps.ios}}">\n    <i class="material-icons">tablet_mac</i>\n    <span class="message">\n      ReadCube iOS (iPhone/iPad)\n    </span>\n  </a>\n  <a target="_blank" class="md-button android-app" ng-href="{{::endpoint.mobile_apps.android}}">\n    <i class="material-icons">android</i>\n    <span class="message">\n      ReadCube Android\n    </span>\n  </a>\n  <a target="_blank" class="md-button web-app" ng-href="{{::endpoint.app}}">\n    <i class="material-icons">web</i>\n    <span class="message">\n      ReadCube Web Library\n    </span>\n  </a>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/update_available.html",'<md-toast>\n  <div class="flex-row">\n    <i class="material-icons">update</i>\n    <span class="message">\n      A new version of this application is available.\n    </span>\n    <md-button class="open" ng-click="reload()">\n      Update\n    </md-button>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toolbars/mobile_slider.html",'  <div class="slider" aria-label="Slide between pages">\n    <div class="slider-wrap">\n      <div class="slider-track">\n        <div class="slider-fill"></div>\n        <div class="slider-thumb">\n          <div class="focus-ring"></div>\n          <div class="thumb-ring"></div>\n        </div>\n      </div>\n    </div>\n  </div>'),e.put("toolbars/mobile_toolbar.html",'<div\n  class="mobile-toolbar"\n  ng-class="{downloading: downloading, authorizing: authorizing, unauthorized: unauthorized }">\n  <div class="auth-bar">\n    <div class="access-prompt" ng-if="unauthorized" ng-click="getAccess()" md-ink-ripple="#FFF">\n      <i class="material-icons get-access">lock_open</i>\n      <span>Get Access</span>\n    </div>\n    <div class="access-progress" ng-if="!unauthorized">\n      <div class="loader-inner square-spin">\n        <div></div>\n      </div>\n      <span>Checking Access...</span>\n    </div>\n  </div>\n  <div class="checkout-bar"></div>\n  <div class="main-bar">\n    <i\n      class="material-icons menu"\n      ng-click="menu()"\n      md-ink-ripple="#FFF">\n      menu\n    </i>\n    <i\n      class="material-icons next-page"\n      ng-if="::viewer.initialized"\n      ng-class="{invisible: pageIndex <= 1}"\n      ng-click="prevPage()"\n      md-ink-ripple="#FFF">\n      navigate_before\n    </i>\n    <span ng-if="::viewer.initialized">\n      {{pageIndex}} / {{numPages}}\n    </span>\n    <i\n      class="material-icons prev-page"\n      ng-if="::viewer.initialized"\n      ng-class="{invisible: pageIndex >= numPages}"\n      ng-click="nextPage()"\n      md-ink-ripple="#FFF">\n      navigate_next\n    </i>\n    <i\n      class="material-icons download"\n      ng-click="download()"\n      md-ink-ripple="#FFF">\n      file_download\n    </i>\n    <div class="download-spinner">\n      <spinner></spinner>\n    </div>\n  </div>\n</div>'),e.put("toolbars/page_info.html",'<div class="page-info">\n  <div class="pagination">\n    <input class="idx" val=""></input>/\n    <div class="num"></div>\n  </div>\n  <div class="progress-container">\n    <spinner></spinner>\n    <i class="material-icons access-icon">lock</i>\n  </div>\n</div>\n'),e.put("toolbars/viewer_toolbar.html",'<div\n  class="viewer-toolbar"\n  ng-class="{downloading: downloading, printing: printing}">\n  <a\n    ng-repeat="(action, handler) in ::toolbar"\n    ng-hide="disabled[action]"\n    ng-attr-target="{{::toolbarLinks[action].target}}"\n    ng-href="{{::toolbarLinks[action].href}}"\n    ng-class="action"\n    ng-click="handler($event)"\n    md-ink-ripple=\'#FFF\'\n    class="toolbar-btn">\n    <i class="material-icons">{{::action}}</i>\n    <spinner></spinner>\n  </a>\n  <a\n    ng-if="article.get().publisher != \'ieee\'"\n    class="toolbar-btn" target="_blank" href="http://support.readcube.com/">\n    <i class="material-icons">help</i>\n  </a>\n</div>\n'),e.put("toast/mobile/annots_not_synced.html",'<md-toast class="annots-not-synced">\n  <span class="message">\n    Annotations not saved. To save annotations, please add this article to your Library.\n  </span>\n  <div class="actions">\n    <a class="add-to-library" ng-click="addToLibrary($event)">Add to Library</a>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/mobile/auth_failed.html",'<md-toast class="auth-failed">\n  <span class="message">\n    We are unable to authorize full PDF access to this article at this time.\n  </span>\n  <div class="actions">\n    <a target="_blank" ng-href="{{::articleUrl}}">Access on publisher site</a>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>\n'),e.put("toast/mobile/info_message.html",'<md-toast>\n  <div class="flex-row">\n    <i class="material-icons message-icon">info</i>\n    <span class="message">{{message}}</span>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/mobile/prompt_register.html",'<md-toast class="register-prompt">\n  <span class="message">\n    Please sign in or create a free ReadCube account to view citation data.\n  </span>\n  <div class="actions">\n    <a class="login" ng-click="login()">Sign In</a>\n    <a class="register right" ng-click="register()">Register</a>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>\n'),e.put("toast/mobile/read_personal.html",'<md-toast class="read-personal">\n  <span class="message">\n    You have this article in your ReadCube library. Open that version to get full-text access.\n  </span>\n  <div class="actions">\n    <a class="open" ng-click="openPersonal()">Open in library</a>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/mobile/rental_expiry.html",'<md-toast class="rental-expiry">\n  <div class="flex-row">\n    <i class="material-icons message-icon">timelapse</i>\n    <span class="message" ng-if="expiresIn">\n      Rental expires in<br>\n      <span class="duration">{{expiresIn | rentalDuration}}</span>\n    </span>\n    <span class="message expired-on" ng-if="::expiredOn">\n      Rental expired on <span class="time">{{::expiredOn | formatDate:\'dddd, MMMM Do YYYY, h:mm a\'}}</span>\n    </span>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>\n'),e.put("toast/mobile/shared_access.html",'<md-toast class="shared-access">\n  <span class="message">{{::message}}</span>\n  <div class="actions clear-float">\n    <a class="back-to-publisher" ng-if="::gotoPublisher" ng-click="gotoPublisher()">\n      Back to {{::publisherName}}\n    </a>\n    <a class="whats-this" target="_blank" ng-if="::whatsThisLink" ng-href="{{::whatsThisLink}}">\n      What\'s this?\n    </a>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/mobile/shared_access_wiley.html",'<md-toast class="shared-access shared-access-wiley">\n  <span class="message">{{::message}}</span>\n  <div class="actions">\n    <a target="_blank" class="learn-more" ng-href="{{::learnMoreLink}}">\n      Learn More\n    </a>\n    <a class="get-access right" ng-if="::type == \'access\'" ng-click="getAccess()">\n      Get Access\n    </a>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/mobile/synced_ad.html",'<md-toast class="synced-ad">\n  <span class="message">\n    This article has been added to your library.\n    Try ReadCube\'s free apps to access the Enhanced PDF anytime:\n  </span>\n  <div class="actions clear-float">\n    <a target="_blank" class="md-button ios-app" ng-href="{{::endpoint.mobile_apps.ios}}">\n      <i class="material-icons">tablet_mac</i>\n      <span>ReadCube iOS (iPhone/iPad)</span>\n    </a>\n    <a target="_blank" class="md-button android-app" ng-href="{{::endpoint.mobile_apps.android}}">\n      <i class="material-icons">android</i>\n      <span>ReadCube Android</span>\n    </a>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>'),e.put("toast/mobile/update_available.html",'<md-toast>\n  <span class="message">\n    A new version of this application is available.\n  </span>\n  <div class="actions">\n    <a class="open" ng-click="reload()">Update now</a>\n  </div>\n  <div class="close" ng-click="close()">\n    <i class="material-icons">close</i>\n  </div>\n</md-toast>')}])},{}]},{},[200]);
//# sourceMappingURL=../maps/main.js.463e317c.map
